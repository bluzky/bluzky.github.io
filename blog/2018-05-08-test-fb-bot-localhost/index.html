<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<title>Cấu hình kết nối HTTPS để test Facebook app trên localhost</title>
<meta name=author content="Dung Nguyen">
<meta name=description content="  Drinking orange juice is good for your health. Reading some orange code is good too :D  ">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5">
<link rel=icon href=https://bluzky.github.io/images/favicon.png type=image/x-icon>
<link rel=preconnect href=https://fonts.gstatic.com>
<link rel=stylesheet href=https://maxst.icons8.com/vue-static/landings/line-awesome/font-awesome-line-awesome/css/all.min.css>
<link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Mulish:wght@400;600;700&display=swap">
<link rel=stylesheet href=https://bluzky.github.io/css/vendor.min.b5a8663ee606da464148860d55262b4547d9177bda9de4111da390a9aff4cfdaec887ed0ffe0f19aaef079eb095309eab5f43d5199e3de45289b321b9e5dcbe7.css integrity="sha512-tahmPuYG2kZBSIYNVSYrRUfZF3vaneQRHaOQqa/0z9rsiH7Q/+Dxmq7weesJUwnqtfQ9UZnj3kUomzIbnl3L5w==" media=screen>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-40665301-3','auto'),ga('send','pageview'))</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-40665301-3','auto'),ga('send','pageview'))</script>
</head>
<body>
<div class=header-height-fix></div>
<header class=header-nav>
<div class=container>
<div class=row>
<div class=col-12>
<nav class="navbar navbar-expand-lg navbar-light p-0">
<a class="navbar-brand font-weight-bold mr-0" href=https://bluzky.github.io/>
<img loading=lazy src=https://bluzky.github.io/images/logo.png alt="The Organge+" height=35px>
</a>
<button class="search-toggle d-inline-block d-lg-none ml-auto mr-3" data-toggle=search aria-label="Search Toggle">
<i class="las la-search"></i>
</button>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navHeader aria-controls=navHeader aria-expanded=false aria-label="Toggle navigation">
<i class="d-inline lab la-buromobelexperte"></i>
<i class="d-none las la-times"></i>
</button>
<div class="collapse navbar-collapse" id=navHeader>
<ul class="navbar-nav mx-auto">
<li class=nav-item>
<a class=nav-link href=https://bluzky.github.io/>Blog</a>
</li>
<li class=nav-item>
<a class=nav-link href=https://bluzky.github.io/tags/>Tags</a>
</li>
<li class=nav-item>
<a class=nav-link href=https://bluzky.github.io/about>About me</a>
</li>
</ul>
<div class="navbar-right d-none d-lg-inline-block">
<ul class="social-links list-unstyled list-inline">
<li class="list-inline-item ml-4 d-none d-lg-inline-block">
<button class=search-toggle data-toggle=search aria-label="Search Toggle">
<i class="las la-search"></i>
</button>
</li>
</ul>
</div>
</div>
</nav>
</div>
</div>
</div>
</header>
<div class=search-block>
<div data-toggle=search-close>
<i class="las la-times text-primary"></i>
</div>
<form action=/search>
<input id=search-query name=s type=search placeholder="Type words & hit enter" class=text-center aria-label=search-query>
</form>
</div>
<section class=section-sm>
<div class=container>
<div class="row justify-content-center">
<div class=col-lg-10>
<div class=pr-lg-4>
<div class=single-post>
<div class="text-center mb-5">
<h1 class="mb-4 post-title">Cấu hình kết nối HTTPS để test Facebook app trên localhost</h1>
<ul class="card-meta list-inline">
<li class=list-inline-item>
<a href=#! class=card-meta-author>
<a href=https://bluzky.github.io/author/dung-nguyen/ class=card-meta-author>
<img loading=lazy src=https://bluzky.github.io/images/author/dung-nguyen.jpg alt="Dung Nguyen">
<span>Dung Nguyen</span>
</a>
</a>
</li>
<li class=list-inline-item>|</li>
<li class=list-inline-item>
<span>08 May 2018</span>
</li>
</ul>
</div>
<div class=content><p>Trong quá trình tìm hiểu về lập trình chat bot sử dụng các API của Facebook Messenger thì việt test chat bot trên localhost là một trở ngại.</p>
<p>Khi tạo một subscription cho app chat bot, Facebook sẽ gửi một request đến server mà chat bot đang chạy để xác nhận có đúng là chat bot của bạn không. Cũng như sau đó, tất cả những tin nhắn của nguời dùng sẽ đuợc gửi tới chat bot thông qua <code>callback url</code>. Và vấn đề là khi dev và test trên localhost thì làm sao để server local của bạn có thể nhận và phản hồi request của Facebook.</p>
<p>Một giải pháp đơn giản là sử dụng dịch vụ của <a href=https://ngrok.com/>https://ngrok.com</a> để chuyển các request về máy localhost. <code>ngrok.com</code> cung cấp gói miễn phí test vô tư, hơn nữa <code>ngrok</code> hỗ trợ cả <code>https</code>.
Điều này rất quan trọng, bởi vì từ 2018 thì tất cả các <code>callback url</code> khi đăng ký ứng dụng trên Facebook Developer đều phải sử dụng kết nối <code>TLS</code>.</p>
<h2 id=buớc-1-đăng-ký-tài-khoản>Buớc 1: Đăng ký tài khoản</h2>
<ul>
<li>Đăng ký tại <a href=https://ngrok.com/pricing>https://ngrok.com/pricing</a>
Vì là tài khoản miễn phí nên sẽ có một số giới hạn:</li>
<li>40 kết nối / phút</li>
<li>Mỗi lần chỉ chạy được 1 <code>ngrok</code> process</li>
</ul>
<h2 id=bước-2-download-ngrok-và-cấu-hình-api-key>Bước 2: Download ngrok và cấu hình API key</h2>
<ul>
<li>Download tại <a href=https://ngrok.com/download>https://ngrok.com/download</a></li>
<li>Giải nén file vừa Download bạn sẽ có file <code>ngrok</code></li>
<li>Thêm token vào ngrok config bằng lệnh</li>
</ul>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ ./ngrok authtoken &lt;YOUR_AUTH_TOKEN&gt;
</code></pre></td></tr></table>
</div>
</div><p>Bạn có thể copy command trên từ <a href=https://dashboard.ngrok.com/get-started>Dashboard</a> trong phần <code>Connect your account</code></p>
<h2 id=bước-3-khởi-chạy-ngrok-process>Bước 3: Khởi chạy ngrok process</h2>
<p><strong>Chạy lệnh</strong></p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>./ngrok http &lt;PORT&gt;
</code></pre></td></tr></table>
</div>
</div><p>trong đó <code>PORT</code> là port number của server localhost mà bạn muốn test.</p>
<p><strong>Ouput mẫu của <code>ngrok</code></strong></p>
<p><img src=/img/ngrok.png alt=ngrok></p>
<p><code>ngrok</code> cung cấp cho bạn 2 public URL để kết nối vào server localhost. 1 URL với giao thức <code>http</code> và 1 URL với <code>https</code>.
Ngon không nào!</p>
<p>Bây giờ bạn đã có thể cấu hình Facebook để test trên localhost rồi.</p>
<p><strong>Lưu ý:</strong><br>
Khi sử dụng tài khoản Free, mỗi lần chạy <code>ngrok</code> thì forwarding URL sẽ khác nhau nên sẽ phải sửa lại sửa lại cấu hình app trên Facebook Developer. Đồ chùa thường là đồ chua mà. Khi sử dụng gói có phí bạn có thể cấu hình forwarding URL theo ý mình. Mình nghèo nên chịu khó thôi.</p>
</div>
</div>
<div class=single-post-meta>
<div class="row justify-content-center">
<div class="col-md-6 text-center text-md-left">
<ul class="post-meta-tags list-unstyled list-inline">
<li class=list-inline-item>
<a href=https://bluzky.github.io/tags/tech>#tech</a>
</li>
<li class=list-inline-item>
<a href=https://bluzky.github.io/tags/til>#til</a>
</li>
</ul>
</div>
<div class="col-md-6 text-center text-md-right mt-4 mt-md-0">
<ul class="social-links has-bg-color list-unstyled list-inline" style=line-height:0>
<li class=list-inline-item>
<a class="resp-sharing-button__link d-block" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fbluzky.github.io%2fblog%2f2018-05-08-test-fb-bot-localhost%2f" target=_blank rel=noopener aria-label>
<div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid">
<i class="lab la-facebook-f text-dark"></i>
</div>
</div>
</a>
</li>
<li class=list-inline-item>
<a class="resp-sharing-button__link d-block" href="https://twitter.com/intent/tweet/?text=C%e1%ba%a5u%20h%c3%acnh%20k%e1%ba%bft%20n%e1%bb%91i%20HTTPS%20%c4%91%e1%bb%83%20test%20Facebook%20app%20tr%c3%aan%20localhost&url=https%3a%2f%2fbluzky.github.io%2fblog%2f2018-05-08-test-fb-bot-localhost%2f" target=_blank rel=noopener aria-label>
<div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid">
<i class="lab la-twitter text-dark"></i>
</div>
</div>
</a>
</li>
<li class=list-inline-item>
<a class="resp-sharing-button__link d-block" href="https://plus.google.com/share?url=https%3a%2f%2fbluzky.github.io%2fblog%2f2018-05-08-test-fb-bot-localhost%2f" target=_blank rel=noopener aria-label>
<div class="resp-sharing-button resp-sharing-button--google resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid">
<i class="lab la-google-plus-g text-dark"></i>
</div>
</div>
</a>
</li>
<li class=list-inline-item>
<a class="resp-sharing-button__link d-block" href="mailto:?subject=C%e1%ba%a5u%20h%c3%acnh%20k%e1%ba%bft%20n%e1%bb%91i%20HTTPS%20%c4%91%e1%bb%83%20test%20Facebook%20app%20tr%c3%aan%20localhost&body=https%3a%2f%2fbluzky.github.io%2fblog%2f2018-05-08-test-fb-bot-localhost%2f" target=_self rel=noopener aria-label>
<div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid">
<i class="las la-envelope text-dark"></i>
</div>
</div>
</a>
</li>
<li class=list-inline-item>
<a class="resp-sharing-button__link d-block" href="whatsapp://send?text=C%e1%ba%a5u%20h%c3%acnh%20k%e1%ba%bft%20n%e1%bb%91i%20HTTPS%20%c4%91%e1%bb%83%20test%20Facebook%20app%20tr%c3%aan%20localhost%20https%3a%2f%2fbluzky.github.io%2fblog%2f2018-05-08-test-fb-bot-localhost%2f" target=_blank rel=noopener aria-label>
<div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid">
<i class="lab la-whatsapp text-dark"></i>
</div>
</div>
</a>
</li>
</ul></div>
</div>
</div>
<div class=single-post-author>
<div class="row justify-content-center">
<div class=col-md-12>
<div class="media d-block d-sm-flex text-center text-sm-left">
<a href=https://bluzky.github.io/author/dung-nguyen/><img loading=lazy class="img-fluid rounded-circle mr-0 mr-sm-4 mb-4" src=https://bluzky.github.io/images/author/dung-nguyen.jpg alt="Dung Nguyen"></a>
<div class=media-body>
<h4>
<a href=https://bluzky.github.io/author/dung-nguyen/ class="text-dark font-weight-700">Dung Nguyen</a>
</h4>
<p class=font-primary>Hi! I&rsquo;m Dung Nguyen. I&rsquo;m an Elixir developer at OnPoint Vietnam.</p>
<ul class="social-links list-unstyled list-inline ml-0 ml-sm-n2">
<li class=list-inline-item>
<a href=https://linkedin.com>
<i class="lab la-linkedin-in"></i>
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class=single-post-similer>
<div class="row justify-content-center">
<div class=col-md-12>
<div class="row mt-3">
<div id=disqus_thread class=w-100></div>
</div>
</div>
</div>
</div>
<div class=single-post-similer>
<div class="row justify-content-center">
<div class=col-md-12>
<div class="row mt-3">
<div class=col-12>
<h3 class="text-dark font-weight-800 mb-4 pb-2">
You May Also Like
</h3>
</div>
<div class=col-md-6><article class="card post-card">
<div class=card-body>
<ul class="card-meta list-inline mb-2">
<li class="list-inline-item mb-2">
<a href=https://bluzky.github.io/author/dung-nguyen/ class=card-meta-author>
<img loading=lazy src=https://bluzky.github.io/images/author/dung-nguyen.jpg alt="Dung Nguyen">
<span>Dung Nguyen</span>
</a>
</li>
<li class="list-inline-item mb-2">
<span>01 May, 2018</span>
</li>
</ul>
<h3 class=mb-3>
<a class=post-title href=https://bluzky.github.io/blog/2018-05-01-what-is-mem-cache/>Memcache là gì?</a>
</h3>
<p>1. Memcache Memcache là một cơ sở dữ liệu dạng key-value, các dữ liệu đuợc ghi nhớ trên RAM giúp tối ưu thời gian truy xuất.
2. Đặc điểm Dữ liệu …</p>
<ul class="card-meta list-inline">
<li class="list-inline-item mb-2">
<ul class="card-meta-tag list-inline">
<li class="list-inline-item tag">
<a href=https://bluzky.github.io/tags/tech>tech</a>
</li>
<li class="list-inline-item tag">
<a href=https://bluzky.github.io/tags/til>til</a>
</li>
</ul>
</li>
</ul>
</div>
</article>
</div>
<div class=col-md-6><article class="card post-card">
<div class=card-body>
<ul class="card-meta list-inline mb-2">
<li class="list-inline-item mb-2">
<a href=https://bluzky.github.io/author/dung-nguyen/ class=card-meta-author>
<img loading=lazy src=https://bluzky.github.io/images/author/dung-nguyen.jpg alt="Dung Nguyen">
<span>Dung Nguyen</span>
</a>
</li>
<li class="list-inline-item mb-2">
<span>02 May, 2018</span>
</li>
</ul>
<h3 class=mb-3>
<a class=post-title href=https://bluzky.github.io/blog/2018-05-02-phoenix-local-ssl/>Chạy server Phoenix với SSL trên localhost</a>
</h3>
<p> Từ tháng 04/2018 tất cả các app mới tạo trên Facebook chỉ chấp nhận callback url có sử dụng SSL. Đây là những bước đơn giản để có thể sử dụng giao …</p>
<ul class="card-meta list-inline">
<li class="list-inline-item mb-2">
<ul class="card-meta-tag list-inline">
<li class="list-inline-item tag">
<a href=https://bluzky.github.io/tags/elixir>elixir</a>
</li>
<li class="list-inline-item tag">
<a href=https://bluzky.github.io/tags/til>til</a>
</li>
</ul>
</li>
</ul>
</div>
</article>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<footer class=section-sm>
<div class=container>
<div class="row justify-content-center align-items-center">
<div class=col-lg-5>
</div>
<div class="col-lg-12 text-center mt-5">
<ul class="list-inline footer-menu mb-4">
<li class="list-inline-item mx-3">
<a href=https://bluzky.github.io/about/>About me</a>
</li>
<li class="list-inline-item mx-3">
<a href=https://bluzky.github.io/author/>Authors</a>
</li>
</ul>
<ul class="social-links icon-box list-unstyled list-inline font-weight-500 mb-3">
</ul>
<p class="mb-0 font-weight-500 copyright-text content">
Blog by Dung Nguyen.Theme by <a href=https://gethugothemes.com/>Gethugothemes</a>
</p>
</div>
</div>
</div>
</footer>
<script data-turbolinks-suppress-warning src=/js/vendor.min.49673e8e4f1ec34c98ef397e87de1845044dfbe687dedef74307932de0a45e95ffa823c3a19942eced3b82a4622fee79a33f9d2ca2adab559232efa452b0de45.js integrity="sha512-SWc+jk8ew0yY7zl+h94YRQRN++aH3t73QweTLeCkXpX/qCPDoZlC7O07gqRiL+55oz+dLKKtq1WSMu+kUrDeRQ=="></script>
<script>(function(){var a=document,b=a.createElement("script");b.src="https://the-orange-1.disqus.com/embed.js",b.setAttribute("data-timestamp",+new Date),(a.head||a.body).appendChild(b)})()</script>
<noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
</body>
</html>