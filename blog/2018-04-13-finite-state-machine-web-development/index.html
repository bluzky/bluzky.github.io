<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<title>Finite state machine trong lập trình</title>
<meta name=author content="Dung Nguyen">
<meta name=description content="  Drinking orange juice is good for your health. Reading some orange code is good too :D  ">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5">
<link rel=icon href=http://bluzky.github.io/images/favicon.png type=image/x-icon>
<link rel=preconnect href=https://fonts.gstatic.com>
<link rel=stylesheet href=https://maxst.icons8.com/vue-static/landings/line-awesome/font-awesome-line-awesome/css/all.min.css>
<link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Noto%20Serif:wght@400;600;700&display=swap">
<link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Mulish:wght@400;600;700&display=swap">
<link rel=stylesheet href=http://bluzky.github.io/css/vendor.min.f1fadd374499730cae93f0bb139129fe90d49ff275d512d21e163fe3e3d2d0d38ec6ea13a533a725958fbc57c6635e9afcc691235645566c26c5714c93cea279.css integrity="sha512-8frdN0SZcwyuk/C7E5Ep/pDUn/J11RLSHhY/4+PS0NOOxuoTpTOnJZWPvFfGY16a/MaRI1ZFVmwmxXFMk86ieQ==" media=screen>
</head>
<body>
<div class=header-height-fix></div>
<header class=header-nav>
<div class=container>
<div class=row>
<div class=col-12>
<nav class="navbar navbar-expand-lg navbar-light p-0">
<a class="navbar-brand font-weight-bold mr-0" href=http://bluzky.github.io/>
<img loading=lazy src=http://bluzky.github.io/images/logo.png alt="The Organge+" height=35px>
</a>
<button class="search-toggle d-inline-block d-lg-none ml-auto mr-3" data-toggle=search aria-label="Search Toggle">
<i class="las la-search"></i>
</button>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navHeader aria-controls=navHeader aria-expanded=false aria-label="Toggle navigation">
<i class="d-inline lab la-buromobelexperte"></i>
<i class="d-none las la-times"></i>
</button>
<div class="collapse navbar-collapse" id=navHeader>
<ul class="navbar-nav mx-auto">
<li class=nav-item>
<a class=nav-link href=http://bluzky.github.io/>Blog</a>
</li>
<li class=nav-item>
<a class=nav-link href=http://bluzky.github.io/tags/>Tags</a>
</li>
<li class=nav-item>
<a class=nav-link href=http://bluzky.github.io/about>About me</a>
</li>
</ul>
<div class="navbar-right d-none d-lg-inline-block">
<ul class="social-links list-unstyled list-inline">
<li class="list-inline-item ml-4 d-none d-lg-inline-block">
<button class=search-toggle data-toggle=search aria-label="Search Toggle">
<i class="las la-search"></i>
</button>
</li>
</ul>
</div>
</div>
</nav>
</div>
</div>
</div>
</header>
<div class=search-block>
<div data-toggle=search-close>
<i class="las la-times text-primary"></i>
</div>
<form action=/search>
<input id=search-query name=s type=search placeholder="Type words & hit enter" class=text-center aria-label=search-query>
</form>
</div>
<section class=section-sm>
<div class=container>
<div class="row justify-content-center">
<div class=col-lg-10>
<div class="text-center mb-5">
<h3 class="h2 mb-4 post-title">Finite state machine trong lập trình</h3>
<ul class="card-meta list-inline">
<li class=list-inline-item>
<a href=#! class=card-meta-author>
<a href=http://bluzky.github.io/author/dung-nguyen/ class=card-meta-author>
<img loading=lazy src=http://bluzky.github.io/images/author/dung-nguyen.jpg alt="Dung Nguyen">
<span>Dung Nguyen</span>
</a>
</a>
</li>
<li class=list-inline-item>|</li>
<li class=list-inline-item>
<span>13 April 2018</span>
</li>
</ul>
</div>
<div class=content><h2 id=1-tìm-hiểu-về-fsm>1. Tìm hiểu về FSM</h2>
<blockquote>
<p><a href=https://vi.wikipedia.org/wiki/M%C3%A1y_tr%E1%BA%A1ng_th%C3%A1i_h%E1%BB%AFu_h%E1%BA%A1n>FSM(Finite state machine)</a> - Máy trạng thái hữu hạn là một mô hình toán học biểu diễn trạng thái của hệ, trong đó số trạng thái là hữu hạn. Từ mỗi trạng thái, máy có thể chuyển đổi qua 1 số trạng thái cố định khác, dựa trên các sự kiện, input.</p>
</blockquote>
<p>Fsm được biểu diễn như 1 đồ thị có hướng.</p>
<p><strong>Ví dụ</strong>:</p>
<p>Máy trạng thái thể hiện trạng thái của 1 bài báo trên trang tin tức</p>
<p><img src=/img/fsm_post.png alt=fsm></p>
<ul>
<li><code>draft</code>, <code>in review</code> <code>published</code> là các trạng thái của bài viết</li>
<li><code>review</code>, <code>approve</code>, <code>reject</code>, <code>unpublish</code> là các sự kiện( event ). Các sự kiện này phát sinh khi nhận các input như click lên button, … Các sự kiện này gây ra việc chuyển trạng thái (ví dụ từ Draft -> In review), gọi là quá trình chuyển đổi (<code>transition</code>)</li>
</ul>
<p><strong>Đặc điểm</strong></p>
<p>Trong mô hình sử dụng <code>DFS</code> máy trạng thái đơn định.</p>
<ul>
<li>Tại mỗi thời điểm máy chỉ ở 1 trạng thái duy nhất</li>
<li>Tại mỗi trạng thái, chỉ có thể chuyển qua những trạng thái được cho phép</li>
<li>Từ trạng thái hiện tại, có thể biết được những trạng thái kế tiếp mà máy có thể chuyển qua</li>
</ul>
<h2 id=2-ứng-dụng-của-fsm-trong-lập-trình>2. Ứng dụng của FSM trong lập trình</h2>
<ul>
<li>
<p>FSM mô tả các trạng thái, sự kiện và quá trình chuyển đổi giữa các trạng thái, nên FSM có thể được sử dụng để quản lý trạng thái của object, hoặc workflow.</p>
</li>
<li>
<p>Ví dụ: Quản lý trạng thái đơn hàng, quản lý trạng thái của ticket, quản lý trạng thái của nhân vật trong game, &mldr;</p>
<p>​</p>
<p>Trong ví dụ trên, mỗi bài viết, chỉ có thể có một trạng thái tại một thời điểm, và từ 1 trạng thái chỉ có thể chuyển đổi qua một số trạng thái được quy định trước:</p>
<ul>
<li>Từ <code>draft</code> chỉ có thể chuyển qua <code>in review</code></li>
<li>Từ <code>draft</code> không thể chuyển qua <code>published</code></li>
</ul>
</li>
</ul>
<h3 id=21-khi-không-dùng-fsm>2.1 Khi không dùng FSM</h3>
<p>Khi không sử dụng FSM thì code sẽ phải dùng tới rất nhiều điều kiện <code>if … else…</code> hoặc <code>case</code> (<code>switch ... case …</code> trong các ngôn ngữ khác)</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=color:#8be9fd;font-style:italic>defmodule</span> <span style=color:#50fa7b>Post</span> <span style=color:#ff79c6>do</span>
	<span style=color:#8be9fd;font-style:italic>defstruct</span> <span style=color:#f1fa8c>content</span>: <span style=color:#f1fa8c>&#34;sample content&#34;</span>, <span style=color:#f1fa8c>status</span>: <span style=color:#f1fa8c>&#34;draft&#34;</span>
	
	<span style=color:#8be9fd;font-style:italic>def</span> all_status, <span style=color:#f1fa8c>do</span>: [<span style=color:#f1fa8c>&#34;draft&#34;</span>, <span style=color:#f1fa8c>&#34;in_review&#34;</span>, <span style=color:#f1fa8c>&#34;published&#34;</span>]
    
    <span style=color:#8be9fd;font-style:italic>def</span> update_status(%{<span style=color:#f1fa8c>status</span>: <span style=color:#f1fa8c>&#34;draft&#34;</span>} <span style=color:#ff79c6>=</span> post, status) <span style=color:#ff79c6>do</span>
    	<span style=color:#ff79c6>if</span> status <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;in_review&#34;</span> <span style=color:#ff79c6>do</span>
        	<span style=color:#50fa7b>IO</span><span style=color:#ff79c6>.</span>put(<span style=color:#f1fa8c>&#34;Update post status to in_review&#34;</span>)
        	<span style=color:#50fa7b>Map</span><span style=color:#ff79c6>.</span>put(post, <span style=color:#f1fa8c>:status</span>, <span style=color:#f1fa8c>&#34;in_review&#34;</span>)
        <span style=color:#ff79c6>else</span>
        	<span style=color:#50fa7b>IO</span><span style=color:#ff79c6>.</span>put(<span style=color:#f1fa8c>&#34;Cannot update to </span><span style=color:#f1fa8c>#{</span>status<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> from draft&#34;</span>)
        	post
        <span style=color:#ff79c6>end</span>
    <span style=color:#ff79c6>end</span>
    
    <span style=color:#8be9fd;font-style:italic>def</span> update_status(%{<span style=color:#f1fa8c>status</span>: <span style=color:#f1fa8c>&#34;in_review&#34;</span>} <span style=color:#ff79c6>=</span> post, status) <span style=color:#ff79c6>do</span>
    	<span style=color:#ff79c6>case</span> status <span style=color:#ff79c6>do</span>
			<span style=color:#f1fa8c>&#34;draft&#34;</span> <span style=color:#ff79c6>-&gt;</span>
	    		<span style=color:#50fa7b>IO</span><span style=color:#ff79c6>.</span>put(<span style=color:#f1fa8c>&#34;Reject the post&#34;</span>)
    	    	<span style=color:#50fa7b>Map</span><span style=color:#ff79c6>.</span>put(post, <span style=color:#f1fa8c>:status</span>, <span style=color:#f1fa8c>&#34;draft&#34;</span>)
    	    
    	    <span style=color:#f1fa8c>&#34;published&#34;</span>
    	   		<span style=color:#50fa7b>IO</span><span style=color:#ff79c6>.</span>put(<span style=color:#f1fa8c>&#34;Publish the post&#34;</span>)
    	    	<span style=color:#50fa7b>Map</span><span style=color:#ff79c6>.</span>put(post, <span style=color:#f1fa8c>:status</span>, <span style=color:#f1fa8c>&#34;published&#34;</span>)
        	true <span style=color:#ff79c6>-&gt;</span>
        		<span style=color:#50fa7b>IO</span><span style=color:#ff79c6>.</span>put(<span style=color:#f1fa8c>&#34;Cannot update to </span><span style=color:#f1fa8c>#{</span>status<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> from in_review&#34;</span>)
        		post
        <span style=color:#ff79c6>end</span>
    <span style=color:#ff79c6>end</span>
    
    <span style=color:#8be9fd;font-style:italic>def</span> update_status(%{<span style=color:#f1fa8c>status</span>: <span style=color:#f1fa8c>&#34;published&#34;</span>} <span style=color:#ff79c6>=</span> post, status) <span style=color:#ff79c6>do</span>
    	<span style=color:#ff79c6>if</span> status <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#34;draft&#34;</span> <span style=color:#ff79c6>do</span>
        	<span style=color:#50fa7b>IO</span><span style=color:#ff79c6>.</span>put(<span style=color:#f1fa8c>&#34;Unpublish the post&#34;</span>)
        	<span style=color:#50fa7b>Map</span><span style=color:#ff79c6>.</span>put(post, <span style=color:#f1fa8c>:status</span>, <span style=color:#f1fa8c>&#34;draft&#34;</span>)
        <span style=color:#ff79c6>else</span>
        	<span style=color:#50fa7b>IO</span><span style=color:#ff79c6>.</span>put(<span style=color:#f1fa8c>&#34;Cannot update to </span><span style=color:#f1fa8c>#{</span>status<span style=color:#f1fa8c>}</span><span style=color:#f1fa8c> from published&#34;</span>)
        	post
        <span style=color:#ff79c6>end</span>
    <span style=color:#ff79c6>end</span>
<span style=color:#ff79c6>end</span>
</code></pre></td></tr></table>
</div>
</div><p>**Vấn đề: **</p>
<ul>
<li>
<p>Code dài, khó mở rộng, dễ xảy ra lỗi</p>
</li>
<li>
<p>Nếu thêm nhiều trạng thái khác cho post, phải update toàn bộ các hàm <code>update_status</code></p>
</li>
<li>
<p>Nếu có nhiều cách chuyển đổi giữa các trạng thái, phải update toàn bộ</p>
</li>
<li>
<p>Làm sao biết từ trạng thái hiện tại có thể chuyển qua trạng thái nào khác?</p>
</li>
<li>
<p>Làm sao đảm bảo luồng dữ liệu/ logic chạy đúng</p>
</li>
</ul>
<h3 id=22-sử-dụng-fsm>2.2 Sử dụng FSM</h3>
<p>Trong ví dụ này sử dụng thư viện <a href=https://github.com/bluzky/as_fsm>as_fsm</a> hỗ trợ việc implement máy trạng thái trên ngôn ngữ elixir</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=color:#8be9fd;font-style:italic>defmodule</span> <span style=color:#50fa7b>Post</span> <span style=color:#ff79c6>do</span>
  <span style=color:#6272a4># define state, event and transition </span>
  <span style=color:#ff79c6>use</span> <span style=color:#50fa7b>AsFsm</span>,
    <span style=color:#f1fa8c>states</span>: [<span style=color:#f1fa8c>:draft</span>, <span style=color:#f1fa8c>:in_review</span>, <span style=color:#f1fa8c>:published</span>],
    <span style=color:#f1fa8c>events</span>: [
      <span style=color:#f1fa8c>review</span>: [
        <span style=color:#f1fa8c>name</span>:     <span style=color:#f1fa8c>&#34;In review&#34;</span>,
        <span style=color:#f1fa8c>from</span>:     [<span style=color:#f1fa8c>:draft</span>],
        <span style=color:#f1fa8c>to</span>:       <span style=color:#f1fa8c>:in_review</span>,
        <span style=color:#f1fa8c>on_transition</span>: <span style=color:#ff79c6>fn</span>(post, params) <span style=color:#ff79c6>-&gt;</span> 
        	<span style=color:#6272a4># thực ra việc gán trạng thái mới được tự động thực hiện bởi thư viện</span>
        	<span style=color:#6272a4># code này chỉ để mục đích cho dễ hiểu</span>
        	post <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>Map</span><span style=color:#ff79c6>.</span>put(post, <span style=color:#f1fa8c>:status</span>, <span style=color:#f1fa8c>:in_review</span>)
        	{<span style=color:#f1fa8c>:ok</span>, post}
        <span style=color:#ff79c6>end</span>
      ], 
      <span style=color:#f1fa8c>approve</span>: [
        <span style=color:#f1fa8c>name</span>:     <span style=color:#f1fa8c>&#34;Approve&#34;</span>,
        <span style=color:#f1fa8c>from</span>:     [<span style=color:#f1fa8c>:in_review</span>],
        <span style=color:#f1fa8c>to</span>:       <span style=color:#f1fa8c>:published</span>
        <span style=color:#f1fa8c>on_transition</span>: <span style=color:#ff79c6>fn</span>(post, params) <span style=color:#ff79c6>-&gt;</span> 
        	post <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>Map</span><span style=color:#ff79c6>.</span>put(post, <span style=color:#f1fa8c>:status</span>, <span style=color:#f1fa8c>:published</span>)
        	{<span style=color:#f1fa8c>:ok</span>, post}
        <span style=color:#ff79c6>end</span>
      ], 
      <span style=color:#f1fa8c>reject</span>: [
        <span style=color:#f1fa8c>name</span>:     <span style=color:#f1fa8c>&#34;Reject&#34;</span>,
        <span style=color:#f1fa8c>from</span>:     [<span style=color:#f1fa8c>:in_review</span>],
        <span style=color:#f1fa8c>to</span>:       <span style=color:#f1fa8c>:draft</span>,
        <span style=color:#f1fa8c>on_transition</span>: <span style=color:#ff79c6>fn</span>(post, params) <span style=color:#ff79c6>-&gt;</span> 
        	post <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>Map</span><span style=color:#ff79c6>.</span>put(post, <span style=color:#f1fa8c>:status</span>, <span style=color:#f1fa8c>:draft</span>)
        	{<span style=color:#f1fa8c>:ok</span>, post}
        <span style=color:#ff79c6>end</span>
      ],
      <span style=color:#f1fa8c>unpublish</span>: [
        <span style=color:#f1fa8c>name</span>:     <span style=color:#f1fa8c>&#34;Unpublish&#34;</span>,
        <span style=color:#f1fa8c>from</span>:     [<span style=color:#f1fa8c>:published</span>],
        <span style=color:#f1fa8c>to</span>:       <span style=color:#f1fa8c>:draft</span>,
        <span style=color:#f1fa8c>on_transition</span>: <span style=color:#ff79c6>fn</span>(post, params) <span style=color:#ff79c6>-&gt;</span> 
        	post <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>Map</span><span style=color:#ff79c6>.</span>put(post, <span style=color:#f1fa8c>:status</span>, <span style=color:#f1fa8c>:draft</span>)
        	{<span style=color:#f1fa8c>:ok</span>, post}
        <span style=color:#ff79c6>end</span>
      ]
    ]
    
    <span style=color:#8be9fd;font-style:italic>defstruct</span> <span style=color:#f1fa8c>content</span>: <span style=color:#f1fa8c>&#34;sample content&#34;</span>, <span style=color:#f1fa8c>status</span>: <span style=color:#f1fa8c>&#34;draft&#34;</span>
<span style=color:#ff79c6>end</span>

<span style=color:#6272a4># gọi thực hiện </span>
iex <span style=color:#ff79c6>&gt;</span> post <span style=color:#ff79c6>=</span> %<span style=color:#50fa7b>Post</span>{<span style=color:#f1fa8c>content</span>: <span style=color:#f1fa8c>&#34;test content&#34;</span>, <span style=color:#f1fa8c>status</span>: <span style=color:#f1fa8c>&#34;draft&#34;</span>}
iex <span style=color:#ff79c6>&gt;</span> post <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>Post</span><span style=color:#ff79c6>.</span>review(post)
<span style=color:#6272a4># hoac</span>
iex <span style=color:#ff79c6>&gt;</span> post <span style=color:#ff79c6>=</span> <span style=color:#50fa7b>Post</span><span style=color:#ff79c6>.</span>trigger(post, <span style=color:#f1fa8c>:review</span>)
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Việc implement FSM cũng không quá phức tạp nhưng có thể tái sử dụng được nhiều lần</li>
<li>Việc thêm mới các trạng thái (state) hoặc các bước chuyển tiếp (transition) không cần thay đổi quá nhiều code</li>
<li>các luồng xử lý, event được thể hiện rõ trên cấu hình trạng thái</li>
</ul>
<h2 id=3-tham-khảo>3. Tham khảo</h2>
<ul>
<li>
<p>Học thêm về <a href=https://brilliant.org/wiki/finite-state-machines/>FSM trên Brilliant</a></p>
</li>
<li>
<p><a href=https://blog.4xxi.com/finite-state-machine-in-web-development-dc1dc6f67d7c>Finite-state machine in web-development</a></p>
</li>
<li>
<p>Thư viện FSM cho ecto model <a href=https://github.com/asiniy/ecto_state_machine>ecto_state_machine</a></p>
</li>
<li>
<p>Slide <a href="https://www.slideshare.net/EuropeanSharePointCommunity/th11-fitzmauricestate-machine-workflows?next_slideshow=1">State Machine Workflow: Esoteric Techniques & Patterns</a></p>
<p>​</p>
</li>
</ul>
</div>
</div>
</div>
<div class=single-post-meta>
<div class="row justify-content-center">
<div class="col-lg-5 col-md-6 text-center text-md-left">
<ul class="post-meta-tags list-unstyled list-inline">
<li class=list-inline-item>
<a href=http://bluzky.github.io/tags/elixir>#elixir</a>
</li>
<li class=list-inline-item>
<a href=http://bluzky.github.io/tags/tech>#tech</a>
</li>
</ul>
</div>
<div class="col-lg-5 col-md-6 text-center text-md-right mt-4 mt-md-0">
<ul class="social-links has-bg-color list-unstyled list-inline" style=line-height:0>
<li class=list-inline-item>
<a class="resp-sharing-button__link d-block" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2fbluzky.github.io%2fblog%2f2018-04-13-finite-state-machine-web-development%2f" target=_blank rel=noopener aria-label>
<div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid">
<i class="lab la-facebook-f text-dark"></i>
</div>
</div>
</a>
</li>
<li class=list-inline-item>
<a class="resp-sharing-button__link d-block" href="https://twitter.com/intent/tweet/?text=Finite%20state%20machine%20trong%20l%e1%ba%adp%20tr%c3%acnh&url=http%3a%2f%2fbluzky.github.io%2fblog%2f2018-04-13-finite-state-machine-web-development%2f" target=_blank rel=noopener aria-label>
<div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid">
<i class="lab la-twitter text-dark"></i>
</div>
</div>
</a>
</li>
<li class=list-inline-item>
<a class="resp-sharing-button__link d-block" href="https://plus.google.com/share?url=http%3a%2f%2fbluzky.github.io%2fblog%2f2018-04-13-finite-state-machine-web-development%2f" target=_blank rel=noopener aria-label>
<div class="resp-sharing-button resp-sharing-button--google resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid">
<i class="lab la-google-plus-g text-dark"></i>
</div>
</div>
</a>
</li>
<li class=list-inline-item>
<a class="resp-sharing-button__link d-block" href="mailto:?subject=Finite%20state%20machine%20trong%20l%e1%ba%adp%20tr%c3%acnh&body=http%3a%2f%2fbluzky.github.io%2fblog%2f2018-04-13-finite-state-machine-web-development%2f" target=_self rel=noopener aria-label>
<div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid">
<i class="las la-envelope text-dark"></i>
</div>
</div>
</a>
</li>
<li class=list-inline-item>
<a class="resp-sharing-button__link d-block" href="whatsapp://send?text=Finite%20state%20machine%20trong%20l%e1%ba%adp%20tr%c3%acnh%20http%3a%2f%2fbluzky.github.io%2fblog%2f2018-04-13-finite-state-machine-web-development%2f" target=_blank rel=noopener aria-label>
<div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid">
<i class="lab la-whatsapp text-dark"></i>
</div>
</div>
</a>
</li>
</ul></div>
</div>
</div>
<div class=single-post-author>
<div class="row justify-content-center">
<div class=col-lg-10>
<div class="media d-block d-sm-flex text-center text-sm-left">
<a href=http://bluzky.github.io/author/dung-nguyen/><img loading=lazy class="img-fluid rounded-circle mr-0 mr-sm-4 mb-4" src=http://bluzky.github.io/images/author/dung-nguyen.jpg alt="Dung Nguyen"></a>
<div class=media-body>
<p class="font-primary mb-1">Written By</p>
<h4>
<a href=http://bluzky.github.io/author/dung-nguyen/ class="text-dark font-weight-700">Dung Nguyen</a>
</h4>
<p class=font-primary>Hi! I&rsquo;m Dung Nguyen. I&rsquo;m an Elixir developer at OnPoint Vietnam.</p>
<ul class="social-links list-unstyled list-inline ml-0 ml-sm-n2">
<li class=list-inline-item>
<a href=https://linkedin.com>
<i class="lab la-linkedin-in"></i>
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class=single-post-similer>
<div class="row justify-content-center">
<div class=col-lg-10>
<div class="row mt-3">
<div class=col-12>
<h3 class="text-dark font-weight-800 mb-4 pb-2">
You May Also Like
</h3>
</div>
<div class=col-md-6><article class="card post-card">
<a href=http://bluzky.github.io/blog/2018-04-11-blockchain/>
<img loading=lazy class="w-100 rounded" src=http://bluzky.github.io/img/blockchain.jpg alt="Tìm hiểu về công nghệ Blockchain">
</a>
<div class=card-body>
<ul class="card-meta list-inline mb-2">
<li class="list-inline-item mb-2">
<a href=http://bluzky.github.io/author/dung-nguyen/ class=card-meta-author>
<img loading=lazy src=http://bluzky.github.io/images/author/dung-nguyen.jpg alt="Dung Nguyen">
<span>Dung Nguyen</span>
</a>
</li>
<li class="list-inline-item mb-2">
<span>11 Apr, 2018</span>
</li>
</ul>
<h3 class=mb-3>
<a class=post-title href=http://bluzky.github.io/blog/2018-04-11-blockchain/>Tìm hiểu về công nghệ Blockchain</a>
</h3>
<p> Từ cơn sốt tiền ảo, công nghệ Blockchain được tung hô và được xem như là công nghệ sẽ làm thay đổi tương lại, thậm chí đến cả công ty thực phẩm thêm …</p>
<ul class="card-meta list-inline">
<li class="list-inline-item mb-2">
<ul class="card-meta-tag list-inline">
<li class="list-inline-item tag">
<a href=http://bluzky.github.io/tags/others>others</a>
</li>
<li class="list-inline-item tag">
<a href=http://bluzky.github.io/tags/tech>tech</a>
</li>
<li class="list-inline-item tag">
<a href=http://bluzky.github.io/tags/blockchain>blockchain</a>
</li>
</ul>
</li>
</ul>
</div>
</article>
</div>
<div class=col-md-6><article class="card post-card">
<div class=card-body>
<ul class="card-meta list-inline mb-2">
<li class="list-inline-item mb-2">
<a href=http://bluzky.github.io/author/dung-nguyen/ class=card-meta-author>
<img loading=lazy src=http://bluzky.github.io/images/author/dung-nguyen.jpg alt="Dung Nguyen">
<span>Dung Nguyen</span>
</a>
</li>
<li class="list-inline-item mb-2">
<span>21 Jan, 2018</span>
</li>
</ul>
<h3 class=mb-3>
<a class=post-title href=http://bluzky.github.io/blog/2018-01-21-what-is-rabbit-mq/>What is Rabbit MQ?</a>
</h3>
<p>1. What is Rabbit MQ? Rabbit MQ is an server application, it is a message broker which implement AMQP (Advanced Message Queue Protocol). It works …</p>
<ul class="card-meta list-inline">
<li class="list-inline-item mb-2">
<ul class="card-meta-tag list-inline">
<li class="list-inline-item tag">
<a href=http://bluzky.github.io/tags/others>others</a>
</li>
<li class="list-inline-item tag">
<a href=http://bluzky.github.io/tags/tech>tech</a>
</li>
</ul>
</li>
</ul>
</div>
</article>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<footer class=section-sm>
<div class=container>
<div class="row justify-content-center align-items-center">
<div class=col-lg-5>
</div>
<div class="col-lg-12 text-center mt-5">
<ul class="list-inline footer-menu mb-4">
<li class="list-inline-item mx-3">
<a href=http://bluzky.github.io/about/>About me</a>
</li>
<li class="list-inline-item mx-3">
<a href=http://bluzky.github.io/author/>Authors</a>
</li>
</ul>
<ul class="social-links icon-box list-unstyled list-inline font-weight-500 mb-3">
</ul>
<p class="mb-0 font-weight-500 copyright-text content">
Blog by Dung Nguyen.Theme by <a href=https://gethugothemes.com/>Gethugothemes</a>
</p>
</div>
</div>
</div>
</footer>
<script data-turbolinks-suppress-warning src=/js/vendor.min.49673e8e4f1ec34c98ef397e87de1845044dfbe687dedef74307932de0a45e95ffa823c3a19942eced3b82a4622fee79a33f9d2ca2adab559232efa452b0de45.js integrity="sha512-SWc+jk8ew0yY7zl+h94YRQRN++aH3t73QweTLeCkXpX/qCPDoZlC7O07gqRiL+55oz+dLKKtq1WSMu+kUrDeRQ=="></script>
</body>
</html>