[{"categories":null,"contents":"Khi viáº¿t cÃ¡c API hoáº·c cáº£ cÃ¡c endpoint thÃ¬ thÃ´ng thÆ°á»ng chÃºng ta sáº½ cÃ³ má»™t sá»‘ nhu cáº§u:\n Chá»‰ cho phÃ©p má»™t sá»‘ cÃ¡c tham sá»‘ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c truyá»n vÃ o. Chuyá»ƒn cÃ¡c tham sá»‘ vá» kiá»ƒu dá»¯ liá»‡u mong muá»‘n Validate cÃ¡c tham sá»‘ theo yÃªu cáº§u  BÃ i viáº¿t nÃ y sáº½ hÆ°á»›ng dáº«n cÃ¡c báº¡n giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» trÃªn sá»­ dá»¥ng Ecto.Changeset\nThÆ° viá»‡n Ecto Ä‘Ã£ cung cáº¥p sáºµn cho chÃºng ta module Changeset. NÃ³ há»— trá»£ viá»‡c cast cÃ¡c tham sá»‘ vá» Ä‘Ãºng kiá»ƒu dá»¯ liá»‡u mong muá»‘n, nÃ³ cÅ©ng há»— trá»£ cÃ¡c phÆ°Æ¡ng thá»©c Ä‘á»ƒ validate cÃ¡c tham sá»‘ yÃªu cáº§u, vÃ  nÃ³ cÅ©ng cho phÃ©p báº¡n giá»›i háº¡n tham sá»‘ nÃ o Ä‘Æ°á»£c truyá»n vÃ o.\nVÃ  sau Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ sá»­ dá»¥ng Chageset Ä‘á»ƒ validate cÃ¡c tham sá»‘ khi filter cÃ¡c Ä‘Æ¡n hÃ ng.\n1. Äáº§u tiÃªn báº¡n pháº£i Ä‘á»‹nh nghÄ©a má»™t schema 1 2 3 4 5 6 7 8 9 10 11 12  defmodule MyApp.OrderFilterParams do use Ecto.Schema import Ecto.Changeset schema \u0026#34;order_filter_params\u0026#34; do field :keyword, :string field :category_id, :integer field :status, :string field :start_date, :utc_datetime field :end_date, :utc_datetime end end   2. Cast vÃ  validate Sau Ä‘Ã³ pháº£i Ä‘á»‹nh nghÄ©a má»™t hÃ m Ä‘á»ƒ thá»±c hiá»‡n viá»‡c cast tham sá»‘ vÃ  validate changeset.\n1 2 3 4 5 6 7 8 9 10 11 12  defmodule MyApp.OrderFilterParams do ... @required ~w(category_id start_date) @optional ~w(keyword status end_date) def changeset(changeset_or_model, params) do cast(changeset_or_model, params, @required ++ @optional) |\u0026gt; validate_required(@required) end end   3. Set giÃ¡ trá»‹ default Ä‘á»™ng Náº¿u báº¡n muá»‘n sá»­ dá»¥ng cÃ¡c giÃ¡ trá»‹ default Ä‘á»™ng, vÃ­ dá»¥ nhÆ° máº·c Ä‘á»‹nh ngÃ y káº¿t thÃºc lÃ  ngÃ y hiá»‡n táº¡i, cÃ¡c báº¡n pháº£i Ä‘á»‹nh nghÄ©a má»™t function Ä‘á»ƒ set giÃ¡ trá»‹ mong muá»‘n.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  defmodule MyApp.OrderFilterParams do ... def changeset(changeset_or_model, params) do cast(changeset_or_model, params, @required ++ @optional) |\u0026gt; validate_required(@required) |\u0026gt; set_default_end_date() end defp set_defaut_end_date(changeset) do end_date = get_change(changeset, :end_date) if is_nil(end_date) do put_change(changeset, :end_date, Timex.today()) else changeset end end end   4. Sá»­ dá»¥ng Params schema 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  defmodule MyApp.OrderController do use MyApp, :controller alias MyApp.OrderFilterParams def index(conn, params) do changeset = OrderFilterParams.changeset(%OrderFilterParams{}, params) if changeset.valid? do strong_params = Ecto.Changeset.apply_changes(changeset) IO.put(strong_params.keyword) # Do something with your params else # handle error end end end   Ráº¥t Ä‘Æ¡n giáº£n Ä‘Ãºng khÃ´ng, náº¿u báº¡n Ä‘Ã£ sá»­ dá»¥ng Ecto thÃ¬ viá»‡c nÃ y chá»‰ lÃ  ruá»“i muá»—i. Tuy nhiÃªn Ä‘Æ¡n giáº£n thÃ¬ pháº£i cÃ³ thá»© Ä‘Ã¡nh Ä‘á»•i chá»©.\nVÃ i thá»© mÃ  báº¡n sáº½ tháº¥y báº¥t tiá»‡n 1. LÆ°á»£ng code mÃ  báº¡n pháº£i viáº¿t quÃ¡ nhiá»u. Thá»­ tÆ°á»Ÿng tÆ°á»£ng má»—i API báº¡n láº¡i pháº£i Ä‘á»‹nh nghÄ©a thÃªm má»™t Module params cho nÃ³ thÃ¬ phá»©c táº¡p vl.\nBáº¡n cÃ³ thá»ƒ sá»­ dá»¥ng schemaless, nhÆ°ng mÃ  function cá»§a báº¡n sáº½ rá»‘i nÃ¹i lÃªn vÃ¬ code logic vÃ  code xá»­ lÃ½ params nÃ³ khÃ´ng liÃªn quan gÃ¬ tá»›i nhau cáº£. VÃ  báº¡n thÃ¬ kiá»ƒu nhÆ° Ä‘á»• sting vÃ o cÆ¡m Ä‘á»ƒ Äƒn váº­y.\n2. Thiáº¿u linh hoáº¡t. Äiá»u nÃ y cÅ©ng Ä‘Ãºng vÃ¬ má»¥c Ä‘Ã­ch chÃ­nh cá»§a Ecto lÃ  phá»¥c vá»¥ cho viá»‡c Ä‘á»‹nh nghÄ©a cÃ¡c schema cho database.\nÄÆ¡n giáº£n nhÆ° viá»‡c Ä‘á»‹nh nghÄ©a giÃ¡ trá»‹ default Ä‘á»™ng nhÆ° trÃªn, báº¡n pháº£i viáº¿t luÃ´n 1 hÃ m má»›i\nTuy nhiÃªn nÃ³ cÅ©ng cÃ³ má»™t Æ°u Ä‘iá»ƒm lÃ  báº¡n khÃ´ng pháº£i sá»­ dá»¥ng thÃªm thÆ° viá»‡n cá»§a bÃªn thá»© ba.\nKáº¿t Náº¿u báº¡n khÃ´ng cáº§n pháº£i xá»­ lÃ½ nhiá»u rÃ ng buá»™c liÃªn quan Ä‘áº¿n tham sá»‘ cá»§a request thÃ¬ Ä‘Æ¡n giáº£n lÃ  cá»© dÃ¹ng Changeset thÃ´i.\nNáº¿u báº¡n muá»‘n nhanh gá»n hÆ¡n thÃ¬ trÃªn Hex cÃ³ má»™t sá»‘ thÆ° viá»‡n Ä‘á»ƒ há»— trá»£ Ä‘á»‹nh nghÄ©a param Ä‘Æ¡n giáº£n hÆ¡n, vÃ­ dá»¥ nhÆ° https://github.com/bluzky/tarams/\nThÆ° viá»‡n nÃ y cung cáº¥p cÃ¡ch thá»©c Ä‘Æ¡n giáº£n vÃ  nhanh chÃ³ng hÆ¡n Ä‘á»ƒ Ä‘á»‹nh nghÄ©a param cho API. MÃ¬nh sáº½ viáº¿t bÃ i hÆ°á»›ng dáº«n sau.\n","date":"26","image":"/images/parse-ecto-phoenix.webp","permalink":"http://bluzky.github.io/blog/validate-request-params-phoenix-ecto/","tags":["elixir","ecto","phoenix"],"title":"Parse vÃ  validate request param trong Phoenix vá»›i Ecto"},{"categories":null,"contents":" BÃ i viáº¿t nÃ y sáº½ hÆ°á»›ng dáº«n cÃ¡c báº¡n sá»­ dá»¥ng ETS nhÆ° lÃ  bá»™ nhá»› cache Ä‘á»ƒ tÄƒng tá»‘c cÃ¡c á»©ng dá»¥ng web Phoenix\n DÃ nh cho cÃ¡c báº¡n chÆ°a biáº¿t:\n ETS (Erlang Term Storage) lÃ  cÆ¡ sá»Ÿ dá»¯ liá»‡u dáº¡ng key-value lÆ°u trá»¯ trÃªn RAM, tÆ°Æ¡ng tá»± nhÆ° Memcache vÃ  Redis, vá»›i Æ°u Ä‘iá»ƒm lÃ  tá»‘c Ä‘á»™ truy xuáº¥t cá»±c nhanh. Äá»c thÃªm vá» ETS Cache lÃ  viá»‡c lÆ°u láº¡i cÃ¡c káº¿t quáº£ xá»­ lÃ½ cá»§a request vÃ o bá»™ nhá»› vÃ  tráº£ vá» cho cÃ¡c request sau mÃ  khÃ´ng cáº§n pháº£i tÃ­nh toÃ¡n láº¡i -\u0026gt; giáº£m response time.  1. Setup project   Táº¡o 1 project má»›i\n1 2  mix phx.new phoenix_cache mix deps.get     ThÃªm chá»©c nÄƒng táº¡o/xoÃ¡/sá»­a bÃ i viáº¿t\n1 2 3  mix phx.gen.html Posts Post posts title:string summary:text content:text mix ecto.create mix ecto.migrate     VÃ o http://0.0.0.0:4000/posts Ä‘á»ƒ xem chá»©c nÄƒng bÃ i viáº¿t. ThÃªm vÃ i bÃ i viáº¿t Ä‘á»ƒ cÃ³ dá»¯ liá»‡u test   2. Táº¡o má»™t module Ä‘á»ƒ quáº£n lÃ½ cache Do table trong ETS sáº½ bá»‹ huá»· khi process khá»Ÿi táº¡o table káº¿t thÃºc, nÃªn cáº§n pháº£i cÃ³ 1 process luÃ´n luÃ´n cháº¡y Ä‘á»ƒ table khÃ´ng bá»‹ xoÃ¡. Sá»­ dá»¥ng GenServer Ä‘á»ƒ quáº£n lÃ½ Cache lÃ  tiá»‡n nháº¥t vÃ¬ nÃ³ Ä‘Æ°á»£c cung cáº¥p sáºµn bá»Ÿi Elixir. Äá»c thÃªm vá» GenServer\n2.1 Táº¡o module Táº¡o má»™t file má»›i phoenix_cache/lib/phoenix_cache/bucket.ex\n1 2 3 4 5 6 7 8 9 10 11  defmodule PhoenixCache.Bucket do use GenServer alias :ets, as: Ets # thá»i gian sá»‘ng cá»§a 1 entry máº·c Ä‘á»‹nh lÃ  6 phÃºt @expired_after 6 * 60 def start_link(args \\\\ []) do GenServer.start_link(__MODULE__, args, name: __MODULE__) end end   2.2 Khá»Ÿi táº¡o cache table khi báº¯t Ä‘áº§u cháº¡y GenServer 1 2 3 4  def init(state) do Ets.new(:simple_cache, [:set, :protected, :named_table, read_concurrency: true]) {:ok, state} end   Module cache sáº½ há»— trá»£ 3 thao tÃ¡c:\n set: lÆ°u data vÃ o bá»™ nhá»› cache get: láº¥y data tá»« bá»™ nhá»› cache delete: xoÃ¡ data khá»i cache (cÃ¡i nÃ y cÃ³ váº» khÃ´ng cáº§n láº¯m thÃ¬ pháº£i)  2.3 ThÃªm data vÃ o cache 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  def set(key, value) do GenServer.cast(__MODULE__, {:set, key, value}) end @doc \u0026#34;\u0026#34;\u0026#34; Default TTL \u0026#34;\u0026#34;\u0026#34; def handle_cast({:set, key, val}, state) do expired_at = NaiveDateTime.utc_now() |\u0026gt; NaiveDateTime.add(@expired_after, :second) Ets.insert(:simple_cache, {key, val, expired_at}) {:noreply, state} end   á» Ä‘Ã¢y chÃºng ta sáº½ táº¡o tÃ­nh toÃ¡n thá»i Ä‘iá»ƒm expire/háº¿t háº¡n cá»§a giÃ¡ trá»‹ cache, tÃ­nh tá»« thá»i Ä‘iá»ƒm hiá»‡n táº¡i, sá»­ dá»¥ng giÃ¡ trá»‹ TTL(thá»i gian sá»‘ng) máº·c Ä‘á»‹nh lÃ  6phÃºt. Báº¡n cÃ³ thá»ƒ cáº¥u hÃ¬nh lÆ°u TTL máº·c Ä‘á»‹nh vÃ o config hoáº·c biáº¿n mÃ´i trÆ°á»ng. MÃ¬nh lÆ°u vÃ o thuá»™c tÃ­nh module cho tiá»‡n.\n2.4 ThÃªm data vÃ o cache vÃ  thiáº¿t láº­p thá»i gian sá»‘ng cá»§a data Äá»ƒ cÃ³ thá»ƒ thoáº£i mÃ¡i thiáº¿t láº­p TTL, ta thÃªm 1 hÃ m cho phÃ©p truyá»n vÃ o tham sá»‘ TTL\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  @doc \u0026#34;\u0026#34;\u0026#34; Custom TTL for cache entry ttl: Time to live in second \u0026#34;\u0026#34;\u0026#34; def set(key, value, ttl) do GenServer.cast(__MODULE__, {:set, key, value, ttl}) end @doc \u0026#34;\u0026#34;\u0026#34; Custom TTL \u0026#34;\u0026#34;\u0026#34; def handle_cast({:set, key, val, ttl}, state) do inserted_at = NaiveDateTime.utc_now() |\u0026gt; NaiveDateTime.add(ttl, :second) Ets.insert(:simple_cache, {key, val, inserted_at}) {:noreply, state} end   CÅ©ng tÆ°Æ¡ng tá»± nhÆ° trÃªn nhÆ°ng hÃ m set sáº½ nháº­n thÃªm tham sá»‘ thá»© 3 lÃ  TTL thay vÃ¬ xÃ i giÃ¡ trá»‹ máº·c Ä‘á»‹nh.\n2.5 Truy xuáº¥t dá»¯ liá»‡u tá»« cache CÃ³ vÃ o thÃ¬ pháº£i cÃ³ láº¥y ra chá»© nhá»‰, bÃ¢y giá» ta sáº½ thÃªm code Ä‘á»ƒ truy xuáº¥t data tá»« cache.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  def get(key) do # láº¥y giÃ¡ trá»‹ Ä‘áº§u tiÃªn tÃ¬m Ä‘uá»£c rs = Ets.lookup(:simple_cache, key) |\u0026gt; List.first() # Náº¿u khÃ´ng tÃ¬m tháº¥y thÃ¬ tráº£ vá» lá»—i if rs == nil do {:error, :not_found} else expired_at = elem(rs, 2) # So sÃ¡nh thá»i Ä‘iá»ƒm háº¿t háº¡n vá»›i hiá»‡n táº¡i, náº¿u háº¿t háº¡n thÃ¬ tráº£ vá» lá»—i cond do NaiveDateTime.diff(NaiveDateTime.utc_now(), expired_at) \u0026gt; 0 -\u0026gt; {:error, :expired} true -\u0026gt; {:ok, elem(rs, 1)} end end end   Note: Nhá» feedback cá»§a bÃ¡c @HQC, chá»— nÃ y mÃ¬nh Ä‘á»c trá»±c tiáº¿p tá»« table, thay vÃ¬ dÃ¹ng GenServer.call nhÆ° trÆ°á»›c vÃ¬ khi send request vÃ o GenServer thÃ¬ code sáº½ Ä‘Æ°á»£c cháº¡y sync/Ä‘á»“ng bá»™. Do váº­y sáº½ táº¡o nÃªn ngáº½n cá»• chai. MÃ¬nh sá»­a láº¡i á»Ÿ pháº§n táº¡o table thÃªm read_concurrency: true vÃ  Ä‘Æ°a pháº§n code query dá»¯ liá»‡u ra ngoÃ i GenServer\n2.6 XoÃ¡ dá»¯ liá»‡u khá»i cache 1 2 3 4 5 6 7 8  def delete(key) do GenServer.cast(__MODULE__, {:delete, key}) end def handle_cast({:delete, key}, state) do Ets.delete(:simple_cache, key) {:noreply, state} end   2.7 Module hoÃ n chá»‰nh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84  defmodule PhoenixCache.Bucket do use GenServer alias :ets, as: Ets @expired_after 6 * 60 def start_link(args \\\\ []) do GenServer.start_link(__MODULE__, args, name: __MODULE__) end def set(key, value) do GenServer.cast(__MODULE__, {:set, key, value}) end @doc \u0026#34;\u0026#34;\u0026#34; Custom TTL for cache entry ttl: Time to live in second \u0026#34;\u0026#34;\u0026#34; def set(key, value, ttl) do GenServer.cast(__MODULE__, {:set, key, value, ttl}) end def get(key) do rs = Ets.lookup(:simple_cache, key) |\u0026gt; List.first() if rs == nil do {:error, :not_found} else expired_at = elem(rs, 2) cond do NaiveDateTime.diff(NaiveDateTime.utc_now(), expired_at) \u0026gt; 0 -\u0026gt; {:error, :expired} true -\u0026gt; {:ok, elem(rs, 1)} end end end def delete(key) do GenServer.cast(__MODULE__, {:delete, key}) end # Server callbacks # Server (callbacks) @impl true def init(state) do Ets.new(:simple_cache, [:set, :protected, :named_table, read_concurrency: true]) {:ok, state} end @doc \u0026#34;\u0026#34;\u0026#34; Default TTL \u0026#34;\u0026#34;\u0026#34; def handle_cast({:set, key, val}, state) do expired_at = NaiveDateTime.utc_now() |\u0026gt; NaiveDateTime.add(@expired_after, :second) Ets.insert(:simple_cache, {key, val, expired_at}) {:noreply, state} end @doc \u0026#34;\u0026#34;\u0026#34; Custom TTL \u0026#34;\u0026#34;\u0026#34; def handle_cast({:set, key, val, ttl}, state) do inserted_at = NaiveDateTime.utc_now() |\u0026gt; NaiveDateTime.add(ttl, :second) Ets.insert(:simple_cache, {key, val, inserted_at}) {:noreply, state} end @impl true def handle_cast({:delete, key}, state) do Ets.delete(:simple_cache, key) {:noreply, state} end end   3. Setup cache Ta Ä‘Ã£ táº¡o xong module cache rá»“i, nhÆ°ng lÃ m sao Ä‘á»ƒ cache tá»± Ä‘á»™ng cháº¡y khi cháº¡y server?\nThÃªm worker vÃ o file phoenix_cache/lib/phoenix_cache/application.ex\n1 2 3 4  children = [ ... worker(PhoenixCache.Bucket, []) ]   Khi Supervisor khá»Ÿi cháº¡y, nÃ³ sáº½ start cÃ¡c children vÃ  quáº£n lÃ½ chÃºng. Äá»ƒ hiá»ƒu rÃµ hÆ¡n, Ä‘á»c thÃªm táº¡i https://hexdocs.pm/elixir/Supervisor.html\n4. XÃ i cache Olala, ta Ä‘Ã£ táº¡o module cache vÃ  thiáº¿t láº­p Ä‘á»ƒ cháº¡y cÃ¹ng vá»›i server, bÃ¢y giá» tá»›i lÃºc xÃ i nÃ³ rá»“i.\nThá»­ dÃ¹ng cache cho chá»©c nÄƒng xem bÃ i viáº¿t:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  def show(conn, %{\u0026#34;id\u0026#34; =\u0026gt; id}) do post = # láº¥y ná»™i dung post tá»« cache case PhoenixCache.Bucket.get(\u0026#34;posts-#{id}\u0026#34;) do # Náº¿u cÃ³ rÃ²i thÃ¬ khá»i cáº§n Ä‘á»c DB {:ok, post} -\u0026gt; IO.puts(\u0026#34;HIT\u0026#34;) post {:error, _} -\u0026gt; IO.puts(\u0026#34;MISS\u0026#34;) # ChÆ°a cache thÃ¬ Ä‘á»c tá»« DB post = Posts.get_post!(id) # cache bÃ i viáº¿t 60s PhoenixCache.Bucket.set(\u0026#34;posts-#{id}\u0026#34;, post, 60) post end render(conn, \u0026#34;show.html\u0026#34;, post: post) end   Káº¿t quáº£ request:\n1 2 3 4 5 6  [info] GET /posts/1 MISS ... [info] GET /posts/1 HIT ...   Láº§n request Ä‘áº§u tiÃªn, bÃ i viáº¿t chÆ°a Ä‘Æ°á»£c cache nÃªn pháº£i truy xuáº¥t database vÃ  cache láº¡i, láº§n thá»© 2 thÃ¬ Ä‘Ã£ cÃ³ trong cache nÃªn khÃ´ng cáº§n pháº£i Ä‘á»c tá»« database ná»¯a.\ná» vÃ­ dá»¥ nÃ y cÃ³ thá»ƒ báº¡n sáº½ chÆ°a tháº¥y sá»± khÃ¡c biá»‡t láº¯m vá» tá»‘c Ä‘á»™ response, nhÆ°ng náº¿u nhÆ° thay vÃ¬ load 1 bÃ i viáº¿t báº±ng viá»‡c xá»­ lÃ½ thá»‘ng kÃª dá»¯ liá»‡u thÃ¬ sá»± khÃ¡c biá»‡t sáº½ ráº¥t lá»›n.\n5. Plug cache Náº¿u cá»© má»—i chá»©c nÄƒng Ä‘á»u pháº£i thÃªm code Ä‘á»ƒ kiá»ƒm tra cache thÃ¬ sáº½ láº·p láº¡i ráº¥t nhiá»u. Äá»ƒ phÃ¡t huy cÃ¡i sá»± lÆ°á»i biáº¿ng thÃ¬ ta sáº½ táº¡o má»™t plug Ä‘Æ¡n giáº£n Ä‘á»ƒ khá»i pháº£i code nhiá»u láº§n.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53  defmodule PhoenixCache.Plug.Cache do import Plug.Conn # 6 minute @default_ttl 6 * 60 def init(ttl \\\\ nil), do: ttl def call(conn, ttl \\\\ nil) do ttl = ttl || @default_ttl # Chá»‰ cache vá»›i GET request if conn.method == \u0026#34;GET\u0026#34; do # táº¡o key tá»« request path vÃ  query param, thÃ´ng thÆ°á»ng # thÃ¬ cÃ¹ng path vÃ  cÃ¹ng param thÃ¬ káº¿t quáº£ lÃ  giá»‘ng nhau key = \u0026#34;#{conn.request_path}-#{conn.query_string}\u0026#34; case PhoenixCache.Bucket.get(key) do {:ok, body} -\u0026gt; IO.puts(\u0026#34;PLUG HIT\u0026#34;) # náº¿u Ä‘Ã£ cache thÃ¬ tráº£ vá» ngay conn |\u0026gt; send_resp(200, body) |\u0026gt; halt _ -\u0026gt; IO.puts(\u0026#34;PLUG MISS\u0026#34;) # náº¿u chÆ°a cache thÃ¬ xá»­ lÃ½ nhÆ° bÃ¬nh thÆ°á»ng conn |\u0026gt; assign(:ttl, ttl) |\u0026gt; register_before_send(\u0026amp;cache_before_send/1) # gá»i hÃ m nÃ y trÆ°á»›c khi tráº£ vá» end else conn end end def cache_before_send(conn) do # náº¿u request Ä‘uá»£c xá»­ lÃ½ thÃ nh cÃ´ng thÃ¬ cache if conn.status == 200 do key = \u0026#34;#{conn.request_path}-#{conn.query_string}\u0026#34; data = conn.resp_body PhoenixCache.Bucket.set(key, data, conn.assigns[:ttl] || @default_ttl) conn else # khÃ´ng thÃ¬ ká»‡ chÃºng mÃ y conn end end end   ÄÃ¢y chá»‰ lÃ  má»™t plug Ä‘Æ¡n giáº£n, báº¡n cÃ³ thá»ƒ viáº¿t láº¡i theo nhu cáº§u.\nSá»­ dá»¥ng Plug: plug(PhoenixCache.Plug.Cache, TTL )\n1 2 3 4  pipeline :browser do ... plug(PhoenixCache.Plug.Cache, 100) # cache 100s end   6. Káº¿t luáº­n Váº­y lÃ  báº¡n Ä‘Ã£ cÃ³ thá»ƒ sá»­ dá»¥ng ETS nhÆ° lÃ  bá»™ nhá»› cache cho á»©ng dá»¥ng Phoenix cá»§a mÃ¬nh mÃ  khÃ´ng cáº§n pháº£i cÃ i thÃªm pháº§n má»m/dá»‹ch vá»¥ khÃ¡c.\nHi vá»ng sáº½ giÃºp Ã­ch cho cÃ¡c báº¡n\nSource code project https://github.com/bluzky/phoenix_ets_cache_example\n","date":"18","image":null,"permalink":"http://bluzky.github.io/blog/2018-05-17-ets-as-cache-phoenix/","tags":["elixir","phoenix","ETS"],"title":"Sá»­ dá»¥ng ETS Ä‘á»ƒ tÄƒng tá»‘c á»©ng dá»¥ng vá»›i Phoenix"},{"categories":null,"contents":"ETS lÃ  gÃ¬? CÃ³ láº½ cÃ¡c báº¡n Ä‘Ã£ nghe qua vá» redis hoáº·c memcache, hoáº·c lÃ  cáº£ hai. CÃ²n náº¿u báº¡n chÆ°a nghe tá»›i bao giá» thÃ¬ Ä‘Ã³ lÃ  nhá»¯ng cÆ¡ sá»Ÿ dá»¯ liá»‡u lÆ°u trá»¯ trÃªn RAM vá»›i Æ°u Ä‘iá»ƒm lÃ  tá»‘c Ä‘á»™ truy xuáº¥t cá»±c ká»³ nhanh. ETS - Erlang Term Service - cÅ©ng lÃ  má»™t CSDL lÆ°u trá»¯ trÃªn RAM (in-ram DB) nhÆ°ng khÃ¡c á»Ÿ chá»— lÃ  ETS cÃ³ sáºµn khi cÃ i Elixir/Erlang vÃ  báº¡n cháº³ng pháº£i máº¥t cÃ´ng cÃ i Ä‘áº·t, cáº¥u hÃ¬nh nhÆ° 2 anh trÃªn kia, nhÃ  trá»“ng Ä‘Æ°á»£c viá»‡c gÃ¬ pháº£i ngáº¡i.\nÄáº·c Ä‘iá»ƒm cá»§a em nÃ³ lÃ :\n KhÃ´ng cáº§n cÃ i Ä‘áº·t Dá»¯ liá»‡u lÆ°u trá»¯ trÃªn RAM vÃ  máº¥t Ä‘i khi process káº¿t thÃºc Dá»¯ liá»‡u lÆ°u trá»¯ dáº¡ng key-value value cÃ³ thá»ƒ lÃ  set, ordered_set, bag, duplicated_bag Kiá»ƒu dá»¯ liá»‡u cá»§a value trÃªn cÃ¹ng 1 báº£ng lÃ  giá»‘ng nhau vÃ  Ä‘uá»£c khai bÃ¡o khi táº¡o báº£ng.  CÃ¡c thao tÃ¡c trong ETS 1. Táº¡o báº£ng 1  iex\u0026gt; :ets.new(:cache, [:set, :protected, :named_table])   **Syntax: ** :ets.new(ten_bang, [type, access, name_table])\n type lÃ  kiá»ƒu dá»¯ liá»‡u cá»§a value lÆ°u trong báº£ng  set lÃ  kiá»ƒu dá»¯ liá»‡u, chÃº nÃ y chung thuá»· chá»‰ cÃ³ 1 value cho 1 key vÃ  key lÃ  duy nháº¥t, khÃ´ng bá»‹ trÃ¹ng. ordered_set tháº±ng em nghiÃªm tÃºc cá»§a set, khÃ¡c tháº±ng anh á»Ÿ chá»— Ä‘uá»£c tá»± Ä‘á»™ng order khi thÃªm data vÃ o. bag khÃ¡c vá»›i set á»Ÿ chá»— chÃº nÃ y chÆ¡i harem, cho phÃ©p nhiá»u value cho cÃ¹ng 1 key, tuy nhiÃªn cÃ¡c value khÃ´ng Ä‘uá»£c trÃ¹ng nhau. duplicated_bag tháº±ng nÃ y Äƒn táº¡p giá»‘ng bag nhÆ°ng cho phÃ©p value trÃ¹ng nhau   access giá»›i háº¡n kháº£ nÄƒng truy xuáº¥t dá»¯ liá»‡u tá»« báº£ng, cÅ©ng khÃ¡ dá»… nhá»›  public: hÃ ng cÃ´ng cá»™ng, chÃº process nÃ o thÃ­ch nhÃ¬n (Ä‘á»c), sá» (ghi) gÃ¬ anh cho háº¿t protected: cÃ¡c chÃº chá»‰ Ä‘uá»£c nhÃ¬n thÃ´i, anh sá»Ÿ há»¯u thÃ¬ anh Ä‘uá»£c sá» private: anh giáº¥u háº¿t, chá»‰ cÃ³ anh má»›i Ä‘uá»£c nhÃ¬n vÃ  sá», cÃ¡c chÃº Ä‘i ra chá»— khÃ¡c   named_table CÃ¡i nÃ y tuá»³ chá»n, bÃ¬nh thuá»ng thÃ¬ sáº½ tráº£ vá» 1 id dÃ¹ng Ä‘á»ƒ truy xuáº¥t vÃ o table. Náº¿u thÃªm option nÃ y vÃ o thÃ¬ cÃ³ thá»ƒ dÃ¹ng ten_bang Ä‘á»ƒ truy xuáº¥t vÃ o table.  ÄÃ£ xong pháº§n khá»Ÿi táº¡o, giá» pháº§n hay ho nháº¥t Ä‘Ã¢y.\n2. Insert vÃ  update dá»¯ liá»‡u   Insert dá»¯ liá»‡u náº¿u key Ä‘Ã£ cÃ³ chá»§ thÃ¬ ghi Ä‘Ã¨ (Ä‘áº­p cháº­u cuá»›p bÃ´ng)\n1 2  iex\u0026gt; :ets.insert(:cache, {\u0026#34;post-1\u0026#34;, \u0026#34;world!\u0026#34;, %{view: 1}}) true      Insert dá»¯ liá»‡u, náº¿u key Ä‘Ã£ cÃ³ chá»§ thÃ¬ bá» qua.\n1 2 3 4  iex\u0026gt; :ets.insert_new(:cache, {\u0026#34;post-1\u0026#34;, \u0026#34;Lao!\u0026#34;, %{view: 2}}) false iex\u0026gt; :ets.insert_new(:cache, {\u0026#34;post-2\u0026#34;, \u0026#34;Vietnam!\u0026#34;, %{view: 999}}) true      Dá»¯ liá»‡u cho hÃ m insert/2 vÃ  insert_new/2 lÃ  1 tuple, pháº§n tá»­ Ä‘áº§u tiÃªn cá»§a tuple máº·c Ä‘á»‹nh Ä‘Æ°á»£c dÃ¹ng lÃ m key.\n3. Query dá»¯ liá»‡u 3.1 Query Ä‘Æ¡n giáº£n: tÃ¬m kiáº¿m dá»¯ liá»‡u theo key dÃ¹ng hÃ m lookup/2\n1 2  iex\u0026gt; :ets.lookup(:cache, \u0026#34;post-1\u0026#34;) [{\u0026#34;post-1\u0026#34;, \u0026#34;world!\u0026#34;, %{view: 1}}]   3.2 Query vá»›i nhiá»u trÆ°á»ng dá»¯ liá»‡u vá»›i hÃ m match_object/2\n1 2  iex\u0026gt; :ets.match_object(:cache, {:\u0026#34;_\u0026#34;, \u0026#34;Vietnam!\u0026#34;, :\u0026#34;_\u0026#34;}) [{\u0026#34;post-2\u0026#34;, \u0026#34;Vietnam!\u0026#34;, %{view: 999}}]    Note :\u0026quot;_\u0026quot; Ä‘Ã¡nh dáº¥u táº¡i vá»‹ trÃ­ nÃ y sáº½ khÃ´ng xÃ i Ä‘á»ƒ match dá»¯ liá»‡u, truá»ng nÃ y chá»©a dá»¯ liá»‡u gÃ¬ cÅ©ng Ä‘uá»£c, anh khÃ´ng quan tÃ¢m  3.3 Select trÆ°á»ng dá»¯ liá»‡u nÃ o sáº½ tráº£ vá» vá»›i match/2\n1 2  iex\u0026gt; :ets.match_object(:cache, {:\u0026#34;$1\u0026#34;, :\u0026#34;$2\u0026#34;, :\u0026#34;_\u0026#34;}) [{\u0026#34;post-1\u0026#34;, \u0026#34;world!\u0026#34;}, {\u0026#34;post-2\u0026#34;, \u0026#34;Vietnam!\u0026#34;}]    Note :\u0026quot;$N\u0026quot; dÃ¹ng Ä‘á»ƒ select káº¿t quáº£ tráº£ vá», N lÃ  má»™t sá»‘ nguyÃªn dÃ¹ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ cá»§a dá»¯ liá»‡u trong káº¿t quáº£.  1 2  iex\u0026gt; :ets.match_object(:cache, {:\u0026#34;$30\u0026#34;, :\u0026#34;$2\u0026#34;, :\u0026#34;_\u0026#34;}) [{\u0026#34;world!\u0026#34;, \u0026#34;post-1\u0026#34;}, {\u0026#34;Vietnam!\u0026#34;, \u0026#34;post-2\u0026#34;}]   3.4 Giá»›i háº¡n káº¿t quáº£ tra vá»\nSá»­ dá»¥ng hÃ m match/3 hoáº·c match_object/3 tÆ°Æ¡ng tá»± nhÆ° match/2 vÃ  match_object/2, trong Ä‘Ã³ tham sá»‘ thá»© 3 lÃ  sá»‘ lÆ°á»£ng pháº§n tá»­ sáº½ tráº£ vá».\n1 2 3 4 5 6 7 8 9 10 11  # them 1 phan tu iex\u0026gt; :ets.insert_new(:cache, {\u0026#34;post-3\u0026#34;, \u0026#34;Vietnam!\u0026#34;, %{view: 1000}}) true # khong limit iex\u0026gt; :ets.match_object(:cache, {:\u0026#34;_\u0026#34;, \u0026#34;Vietnam!\u0026#34;, :\u0026#34;_\u0026#34;}) [{\u0026#34;post-2\u0026#34;, \u0026#34;Vietnam!\u0026#34;, %{view: 999}}, {\u0026#34;post-3\u0026#34;, \u0026#34;Vietnam!\u0026#34;, %{view: 1000}}] # co limit iex\u0026gt; :ets.match_object(:cache, {:\u0026#34;_\u0026#34;, \u0026#34;Vietnam!\u0026#34;, :\u0026#34;_\u0026#34;}, 1) [{\u0026#34;post-2\u0026#34;, \u0026#34;Vietnam!\u0026#34;, %{view: 999}}]   4. XoÃ¡ dá»¯ liá»‡u XoÃ¡ theo key\n1 2  iex\u0026gt; :ets.delete(:cache, \u0026#34;post-1\u0026#34;) true   Match dá»¯ liá»‡u vÃ  xoÃ¡. CÃ¡ch match giá»‘ng nhÆ° trong query dá»¯ liá»‡u\n1 2  iex\u0026gt; :ets.match_delete(:cache, {:\u0026#34;_\u0026#34;, \u0026#34;Vietnam!\u0026#34;, :\u0026#34;_\u0026#34;}) true   5. XoÃ¡ báº£ng 1 2  iex\u0026gt; :ets.delete(:cache) true   Náº¿u khÃ´ng xoÃ¡ thÃ¬ dá»¯ liá»‡u sáº½ tá»“n táº¡i cho Ä‘áº¿n khi process káº¿t thÃºc má»›i bá»‹ máº¥t Ä‘i.\n6. CÃ¡c hÃ m hay xÃ i  member/2 kiá»ƒm tra xem key Ä‘Ã£ tá»“n taá»‹ trong báº£ng hay chÆ°a tab2list: Ä‘á»c táº¥t cáº£ dá»¯ liá»‡u cá»§a báº£ng vÃ o 1 list tab2file: lÆ°u táº¥t cáº£ dá»¯ liá»‡u trÃªn báº£ng vÃ o 1 file, báº¡n cÃ³ thá»ƒ lÆ°u dá»¯ liá»‡u láº¡i truá»›c khi process káº¿t thÃºc vÃ  cÃ³ thá»ƒ xÃ i láº¡i dá»¯ liá»‡u sau. file2tab : Ä‘á»c 1 file Ä‘uá»£c lÆ°u bá»Ÿi tab2file vÃ  táº¡o láº¡i báº£ng tÆ°Æ¡ng á»©ng to_dest/2: copy toÃ n bá»™ dá»¯ liá»‡u tá»« báº£ng ETS qua báº£ng DETS (lÆ°u dá»¯ liá»‡u trÃªn á»• cá»©ng) from_dest/2: copy toÃ n bá»™ dá»¯ liá»‡u tá»« báº£ng DETS qua báº£ng ETS  Tham kháº£o  http://erlang.org/doc/man/ets.html xem nhiá»u trÃ² hay http://learnyousomeerlang.com/ets NgoÃ i ra Erlang cÃ²n há»— trá»£ DETS (disk-based term storage) lÆ°u trÃªn á»• cá»©ng vá»›i API tÆ°Æ¡ng tá»± http://erlang.org/doc/man/dets.html  ","date":"12","image":null,"permalink":"http://bluzky.github.io/blog/2018-05-12-erlang-term-storage/","tags":["elixir","erlang"],"title":"Elixir - LÆ°u trá»¯ dá»¯ liá»‡u trÃªn RAM vá»›i ETS"},{"categories":null,"contents":"Trong quÃ¡ trÃ¬nh tÃ¬m hiá»ƒu vá» láº­p trÃ¬nh chat bot sá»­ dá»¥ng cÃ¡c API cá»§a Facebook Messenger thÃ¬ viá»‡t test chat bot trÃªn localhost lÃ  má»™t trá»Ÿ ngáº¡i.\nKhi táº¡o má»™t subscription cho app chat bot, Facebook sáº½ gá»­i má»™t request Ä‘áº¿n server mÃ  chat bot Ä‘ang cháº¡y Ä‘á»ƒ xÃ¡c nháº­n cÃ³ Ä‘Ãºng lÃ  chat bot cá»§a báº¡n khÃ´ng. CÅ©ng nhÆ° sau Ä‘Ã³, táº¥t cáº£ nhá»¯ng tin nháº¯n cá»§a nguá»i dÃ¹ng sáº½ Ä‘uá»£c gá»­i tá»›i chat bot thÃ´ng qua callback url. VÃ  váº¥n Ä‘á» lÃ  khi dev vÃ  test trÃªn localhost thÃ¬ lÃ m sao Ä‘á»ƒ server local cá»§a báº¡n cÃ³ thá»ƒ nháº­n vÃ  pháº£n há»“i request cá»§a Facebook.\nMá»™t giáº£i phÃ¡p Ä‘Æ¡n giáº£n lÃ  sá»­ dá»¥ng dá»‹ch vá»¥ cá»§a https://ngrok.com Ä‘á»ƒ chuyá»ƒn cÃ¡c request vá» mÃ¡y localhost. ngrok.com cung cáº¥p gÃ³i miá»…n phÃ­ test vÃ´ tÆ°, hÆ¡n ná»¯a ngrok há»— trá»£ cáº£ https. Äiá»u nÃ y ráº¥t quan trá»ng, bá»Ÿi vÃ¬ tá»« 2018 thÃ¬ táº¥t cáº£ cÃ¡c callback url khi Ä‘Äƒng kÃ½ á»©ng dá»¥ng trÃªn Facebook Developer Ä‘á»u pháº£i sá»­ dá»¥ng káº¿t ná»‘i TLS.\nBuá»›c 1: ÄÄƒng kÃ½ tÃ i khoáº£n  ÄÄƒng kÃ½ táº¡i https://ngrok.com/pricing VÃ¬ lÃ  tÃ i khoáº£n miá»…n phÃ­ nÃªn sáº½ cÃ³ má»™t sá»‘ giá»›i háº¡n: 40 káº¿t ná»‘i / phÃºt Má»—i láº§n chá»‰ cháº¡y Ä‘Æ°á»£c 1 ngrok process  BÆ°á»›c 2: Download ngrok vÃ  cáº¥u hÃ¬nh API key  Download táº¡i https://ngrok.com/download Giáº£i nÃ©n file vá»«a Download báº¡n sáº½ cÃ³ file ngrok ThÃªm token vÃ o ngrok config báº±ng lá»‡nh  1  $ ./ngrok authtoken \u0026lt;YOUR_AUTH_TOKEN\u0026gt;   Báº¡n cÃ³ thá»ƒ copy command trÃªn tá»« Dashboard trong pháº§n Connect your account\nBÆ°á»›c 3: Khá»Ÿi cháº¡y ngrok process Cháº¡y lá»‡nh\n1  ./ngrok http \u0026lt;PORT\u0026gt;   trong Ä‘Ã³ PORT lÃ  port number cá»§a server localhost mÃ  báº¡n muá»‘n test.\nOuput máº«u cá»§a ngrok\nngrok cung cáº¥p cho báº¡n 2 public URL Ä‘á»ƒ káº¿t ná»‘i vÃ o server localhost. 1 URL vá»›i giao thá»©c http vÃ  1 URL vá»›i https. Ngon khÃ´ng nÃ o!\nBÃ¢y giá» báº¡n Ä‘Ã£ cÃ³ thá»ƒ cáº¥u hÃ¬nh Facebook Ä‘á»ƒ test trÃªn localhost rá»“i.\nLÆ°u Ã½:\nKhi sá»­ dá»¥ng tÃ i khoáº£n Free, má»—i láº§n cháº¡y ngrok thÃ¬ forwarding URL sáº½ khÃ¡c nhau nÃªn sáº½ pháº£i sá»­a láº¡i sá»­a láº¡i cáº¥u hÃ¬nh app trÃªn Facebook Developer. Äá»“ chÃ¹a thÆ°á»ng lÃ  Ä‘á»“ chua mÃ . Khi sá»­ dá»¥ng gÃ³i cÃ³ phÃ­ báº¡n cÃ³ thá»ƒ cáº¥u hÃ¬nh forwarding URL theo Ã½ mÃ¬nh. MÃ¬nh nghÃ¨o nÃªn chá»‹u khÃ³ thÃ´i.\n","date":"08","image":null,"permalink":"http://bluzky.github.io/blog/2018-05-08-test-fb-bot-localhost/","tags":["tech","til"],"title":"Cáº¥u hÃ¬nh káº¿t ná»‘i HTTPS Ä‘á»ƒ test Facebook app trÃªn localhost"},{"categories":null,"contents":" Tá»« thÃ¡ng 04/2018 táº¥t cáº£ cÃ¡c app má»›i táº¡o trÃªn Facebook chá»‰ cháº¥p nháº­n callback url cÃ³ sá»­ dá»¥ng SSL. ÄÃ¢y lÃ  nhá»¯ng bÆ°á»›c Ä‘Æ¡n giáº£n Ä‘á»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng giao thá»©c https trÃªn localhost Ä‘á»‘i vá»›i Phoenix\n 1. Táº¡o chá»©ng chá»‰\nRun command\n1 2  openssl genrsa 1024 \u0026gt; app.key \u0026amp;\u0026amp; openssl req -new -x509 -nodes -sha1 -days 365 -key ~/app.key \u0026gt; ~/app.cert   2. Copy file\napp.key and app.cert file to priv/keys\n3. Chá»‰nh sá»­a cáº¥u hÃ¬nh\nfile dev.exs\n1 2 3  config :my_app, MyAppWeb.Endpoint, http: [port: 4000], https: [port: 4443, keyfile: \u0026#34;priv/keys/app.key\u0026#34;, certfile: \u0026#34;priv/keys/app.cert\u0026#34;],   Access https://localhost:4443 to use SSL connection\n","date":"02","image":null,"permalink":"http://bluzky.github.io/blog/2018-05-02-phoenix-local-ssl/","tags":["elixir","til"],"title":"Cháº¡y server Phoenix vá»›i SSL trÃªn localhost"},{"categories":null,"contents":"1. Memcache  Memcache lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u dáº¡ng key-value, cÃ¡c dá»¯ liá»‡u Ä‘uá»£c ghi nhá»› trÃªn RAM giÃºp tá»‘i Æ°u thá»i gian truy xuáº¥t.\n 2. Äáº·c Ä‘iá»ƒm  Dá»¯ liá»‡u lÆ°u trá»¯ dáº¡ng key-value Value lÃ  dá»¯ liá»‡u dáº¡ng string KÃ­ch thuá»›c cá»§a Value giá»›i háº¡n lÃ  1MB Dá»¯ liá»‡u sáº½ bá»‹ máº¥t khi táº¯t mÃ¡y/ táº¯t memcache Truy xuáº¥t dá»¯ liá»‡u nhanh  3. á»¨ng dá»¥ng Memcache thÆ°á»ng Ä‘uá»£c dÃ¹ng Ä‘á»… cache dá»¯ liá»‡u trÃªn cÃ¡c web server giÃºp giáº£m thá»i gian xá»­ lÃ½ cÃ¡c request giá»‘ng nhau, thay vÃ o Ä‘Ã³ chá»‰ cáº§n Ä‘á»c dá»¯ liá»‡u tá»« bá»™ nhá»› vÃ  tráº£ vá» ngay láº­p tá»©c.\n4. Æ¯u - NhÆ°á»£c Ä‘iá»ƒm Æ¯u Ä‘iá»ƒm\n Dá»¯ liá»‡u truy xuáº¥t nhanh Sá»­ dá»¥ng phá»• biáº¿n  NhÆ°á»£c Ä‘iá»ƒm\n Khi dá»¯ liá»‡u bá»‹ xoÃ¡, dá»¯ liá»‡u khÃ´ng Ä‘uá»£c phá»¥c há»“i Chá»‰ há»— trá»£ dá»¯ liá»‡u kiá»ƒu string KÃ­ch thÆ°á»›c dá»¯ liá»‡u giá»›i háº¡n chá»‰ 1MB KhÃ´ng há»— trá»£ lÆ°u dá»¯ liá»‡u persistent  5. CÃ¡ch sá»­ dá»¥ng VÃ­ dá»¥ sá»­ dá»¥ng trong Elixir:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  def get_post(conn, %{\u0026#34;id\u0026#34; =\u0026gt; id}) do response = Memcache.Client.get(\u0026#34;post-#{id}\u0026#34;) case response.status do :ok -\u0026gt; # tráº£ vá» ngay náº¿u tÃ¬m tháº¥y trong cache json(conn, Poison.decode!(response.value)) status -\u0026gt; # Náº¿u khÃ´ng tháº¥y, truy xuáº¥t dá»¯ liá»‡u má»›i data = get_post_data(id) # LÆ°u dá»¯ liá»‡u má»›i vÃ o cache json_data = Poison.encode!(data) Memcache.Client.set(\u0026#34;post-#{id}\u0026#34;, json_data) json(conn, data) end end   6. Refs  Trang chá»§ memcached.org So sÃ¡nh Memcache vÃ  Redis trÃªn Stack overflow  ","date":"01","image":null,"permalink":"http://bluzky.github.io/blog/2018-05-01-what-is-mem-cache/","tags":["tech","til"],"title":"Memcache lÃ  gÃ¬?"},{"categories":null,"contents":"Khi chuyá»ƒn qua dÃ¹ng cÃ¡c há»‡ Ä‘iá»u hÃ nh Unix vÃ  Mac, viá»‡c sá»­ dá»¥ng cÃ¡c command line lÃ  má»™t pháº§n khÃ´ng thá»ƒ thiáº¿u, Ä‘áº·c biá»‡t lÃ  cÃ¡c cÃ´ng viá»‡c liÃªn quan tá»›i Web dev vÃ  devops.\nTuy nhiÃªn pháº§n lá»›n lÃ  Ä‘á»¥ng tá»›i Ä‘Ã¢u cáº§n thÃ¬ má»›i search, hoáº·c lÃ  do xÃ i quen rá»“i nÃªn cÅ©ng lÆ°á»i tÃ¬m cÃ¡ch lÃ m khÃ¡c. Chá»‰ cáº§n dÃ nh 1 phÃºt Ä‘á»ƒ Ä‘á»c qua bÃ i viáº¿t nÃ y, cÃ¡c báº¡n sáº½ thá»±c sá»± báº¥t ngá» vÃ¬ cÃ³ nhá»¯ng thá»© cool Ä‘áº¿n khÃ´ng ngá».\nNguá»“n dwmkerr.com\n","date":"24","image":null,"permalink":"http://bluzky.github.io/blog/2018-04-24-terminal-tips/","tags":["tips","til","terminal"],"title":"Terminal tips - Má»™t sá»‘ command hay dÃ¹ng"},{"categories":null,"contents":"1. TÃ¬m hiá»ƒu vá» FSM  FSM(Finite state machine) - MÃ¡y tráº¡ng thÃ¡i há»¯u háº¡n lÃ  má»™t mÃ´ hÃ¬nh toÃ¡n há»c biá»ƒu diá»…n tráº¡ng thÃ¡i cá»§a há»‡, trong Ä‘Ã³ sá»‘ tráº¡ng thÃ¡i lÃ  há»¯u háº¡n. Tá»« má»—i tráº¡ng thÃ¡i, mÃ¡y cÃ³ thá»ƒ chuyá»ƒn Ä‘á»•i qua 1 sá»‘ tráº¡ng thÃ¡i cá»‘ Ä‘á»‹nh khÃ¡c, dá»±a trÃªn cÃ¡c sá»± kiá»‡n, input.\n Fsm Ä‘Æ°á»£c biá»ƒu diá»…n nhÆ° 1 Ä‘á»“ thá»‹ cÃ³ hÆ°á»›ng.\nVÃ­ dá»¥:\nMÃ¡y tráº¡ng thÃ¡i thá»ƒ hiá»‡n tráº¡ng thÃ¡i cá»§a 1 bÃ i bÃ¡o trÃªn trang tin tá»©c\n draft, in review published lÃ  cÃ¡c tráº¡ng thÃ¡i cá»§a bÃ i viáº¿t review, approve, reject, unpublish lÃ  cÃ¡c sá»± kiá»‡n( event ). CÃ¡c sá»± kiá»‡n nÃ y phÃ¡t sinh khi nháº­n cÃ¡c input nhÆ° click lÃªn button, â€¦ CÃ¡c sá»± kiá»‡n nÃ y gÃ¢y ra viá»‡c chuyá»ƒn tráº¡ng thÃ¡i (vÃ­ dá»¥ tá»« Draft -\u0026gt; In review), gá»i lÃ  quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i (transition)  Äáº·c Ä‘iá»ƒm\nTrong mÃ´ hÃ¬nh sá»­ dá»¥ng DFS mÃ¡y tráº¡ng thÃ¡i Ä‘Æ¡n Ä‘á»‹nh.\n Táº¡i má»—i thá»i Ä‘iá»ƒm mÃ¡y chá»‰ á»Ÿ 1 tráº¡ng thÃ¡i duy nháº¥t Táº¡i má»—i tráº¡ng thÃ¡i, chá»‰ cÃ³ thá»ƒ chuyá»ƒn qua nhá»¯ng tráº¡ng thÃ¡i Ä‘Æ°á»£c cho phÃ©p Tá»« tráº¡ng thÃ¡i hiá»‡n táº¡i, cÃ³ thá»ƒ biáº¿t Ä‘Æ°á»£c nhá»¯ng tráº¡ng thÃ¡i káº¿ tiáº¿p mÃ  mÃ¡y cÃ³ thá»ƒ chuyá»ƒn qua  2. á»¨ng dá»¥ng cá»§a FSM trong láº­p trÃ¬nh   FSM mÃ´ táº£ cÃ¡c tráº¡ng thÃ¡i, sá»± kiá»‡n vÃ  quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i giá»¯a cÃ¡c tráº¡ng thÃ¡i, nÃªn FSM cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a object, hoáº·c workflow.\n  VÃ­ dá»¥: Quáº£n lÃ½ tráº¡ng thÃ¡i Ä‘Æ¡n hÃ ng, quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a ticket, quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a nhÃ¢n váº­t trong game, \u0026hellip;\nâ€‹\nTrong vÃ­ dá»¥ trÃªn, má»—i bÃ i viáº¿t, chá»‰ cÃ³ thá»ƒ cÃ³ má»™t tráº¡ng thÃ¡i táº¡i má»™t thá»i Ä‘iá»ƒm, vÃ  tá»« 1 tráº¡ng thÃ¡i chá»‰ cÃ³ thá»ƒ chuyá»ƒn Ä‘á»•i qua má»™t sá»‘ tráº¡ng thÃ¡i Ä‘Æ°á»£c quy Ä‘á»‹nh trÆ°á»›c:\n Tá»« draft chá»‰ cÃ³ thá»ƒ chuyá»ƒn qua in review Tá»« draft khÃ´ng thá»ƒ chuyá»ƒn qua published    2.1 Khi khÃ´ng dÃ¹ng FSM Khi khÃ´ng sá»­ dá»¥ng FSM thÃ¬ code sáº½ pháº£i dÃ¹ng tá»›i ráº¥t nhiá»u Ä‘iá»u kiá»‡n if â€¦ elseâ€¦ hoáº·c case (switch ... case â€¦ trong cÃ¡c ngÃ´n ngá»¯ khÃ¡c)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40  defmodule Post do defstruct content: \u0026#34;sample content\u0026#34;, status: \u0026#34;draft\u0026#34; def all_status, do: [\u0026#34;draft\u0026#34;, \u0026#34;in_review\u0026#34;, \u0026#34;published\u0026#34;] def update_status(%{status: \u0026#34;draft\u0026#34;} = post, status) do if status == \u0026#34;in_review\u0026#34; do IO.put(\u0026#34;Update post status to in_review\u0026#34;) Map.put(post, :status, \u0026#34;in_review\u0026#34;) else IO.put(\u0026#34;Cannot update to #{status}from draft\u0026#34;) post end end def update_status(%{status: \u0026#34;in_review\u0026#34;} = post, status) do case status do \u0026#34;draft\u0026#34; -\u0026gt; IO.put(\u0026#34;Reject the post\u0026#34;) Map.put(post, :status, \u0026#34;draft\u0026#34;) \u0026#34;published\u0026#34; IO.put(\u0026#34;Publish the post\u0026#34;) Map.put(post, :status, \u0026#34;published\u0026#34;) true -\u0026gt; IO.put(\u0026#34;Cannot update to #{status}from in_review\u0026#34;) post end end def update_status(%{status: \u0026#34;published\u0026#34;} = post, status) do if status == \u0026#34;draft\u0026#34; do IO.put(\u0026#34;Unpublish the post\u0026#34;) Map.put(post, :status, \u0026#34;draft\u0026#34;) else IO.put(\u0026#34;Cannot update to #{status}from published\u0026#34;) post end end end   **Váº¥n Ä‘á»: **\n  Code dÃ i, khÃ³ má»Ÿ rá»™ng, dá»… xáº£y ra lá»—i\n  Náº¿u thÃªm nhiá»u tráº¡ng thÃ¡i khÃ¡c cho post, pháº£i update toÃ n bá»™ cÃ¡c hÃ m update_status\n  Náº¿u cÃ³ nhiá»u cÃ¡ch chuyá»ƒn Ä‘á»•i giá»¯a cÃ¡c tráº¡ng thÃ¡i, pháº£i update toÃ n bá»™\n  LÃ m sao biáº¿t tá»« tráº¡ng thÃ¡i hiá»‡n táº¡i cÃ³ thá»ƒ chuyá»ƒn qua tráº¡ng thÃ¡i nÃ o khÃ¡c?\n  LÃ m sao Ä‘áº£m báº£o luá»“ng dá»¯ liá»‡u/ logic cháº¡y Ä‘Ãºng\n  2.2 Sá»­ dá»¥ng FSM Trong vÃ­ dá»¥ nÃ y sá»­ dá»¥ng thÆ° viá»‡n as_fsm há»— trá»£ viá»‡c implement mÃ¡y tráº¡ng thÃ¡i trÃªn ngÃ´n ngá»¯ elixir\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53  defmodule Post do # define state, event and transition  use AsFsm, states: [:draft, :in_review, :published], events: [ review: [ name: \u0026#34;In review\u0026#34;, from: [:draft], to: :in_review, on_transition: fn(post, params) -\u0026gt; # thá»±c ra viá»‡c gÃ¡n tráº¡ng thÃ¡i má»›i Ä‘Æ°á»£c tá»± Ä‘á»™ng thá»±c hiá»‡n bá»Ÿi thÆ° viá»‡n # code nÃ y chá»‰ Ä‘á»ƒ má»¥c Ä‘Ã­ch cho dá»… hiá»ƒu post = Map.put(post, :status, :in_review) {:ok, post} end ], approve: [ name: \u0026#34;Approve\u0026#34;, from: [:in_review], to: :published on_transition: fn(post, params) -\u0026gt; post = Map.put(post, :status, :published) {:ok, post} end ], reject: [ name: \u0026#34;Reject\u0026#34;, from: [:in_review], to: :draft, on_transition: fn(post, params) -\u0026gt; post = Map.put(post, :status, :draft) {:ok, post} end ], unpublish: [ name: \u0026#34;Unpublish\u0026#34;, from: [:published], to: :draft, on_transition: fn(post, params) -\u0026gt; post = Map.put(post, :status, :draft) {:ok, post} end ] ] defstruct content: \u0026#34;sample content\u0026#34;, status: \u0026#34;draft\u0026#34; end # gá»i thá»±c hiá»‡n  iex \u0026gt; post = %Post{content: \u0026#34;test content\u0026#34;, status: \u0026#34;draft\u0026#34;} iex \u0026gt; post = Post.review(post) # hoac iex \u0026gt; post = Post.trigger(post, :review)    Viá»‡c implement FSM cÅ©ng khÃ´ng quÃ¡ phá»©c táº¡p nhÆ°ng cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng Ä‘Æ°á»£c nhiá»u láº§n Viá»‡c thÃªm má»›i cÃ¡c tráº¡ng thÃ¡i (state) hoáº·c cÃ¡c bÆ°á»›c chuyá»ƒn tiáº¿p (transition) khÃ´ng cáº§n thay Ä‘á»•i quÃ¡ nhiá»u code cÃ¡c luá»“ng xá»­ lÃ½, event Ä‘Æ°á»£c thá»ƒ hiá»‡n rÃµ trÃªn cáº¥u hÃ¬nh tráº¡ng thÃ¡i  3. Tham kháº£o   Há»c thÃªm vá» FSM trÃªn Brilliant\n  Finite-state machine in web-development\n  ThÆ° viá»‡n FSM cho ecto model ecto_state_machine\n  Slide State Machine Workflow: Esoteric Techniques \u0026amp; Patterns\nâ€‹\n  ","date":"13","image":null,"permalink":"http://bluzky.github.io/blog/2018-04-13-finite-state-machine-web-development/","tags":["elixir","tech"],"title":"Finite state machine trong láº­p trÃ¬nh"},{"categories":null,"contents":" Tá»« cÆ¡n sá»‘t tiá»n áº£o, cÃ´ng nghá»‡ Blockchain Ä‘Æ°á»£c tung hÃ´ vÃ  Ä‘Æ°á»£c xem nhÆ° lÃ  cÃ´ng nghá»‡ sáº½ lÃ m thay Ä‘á»•i tÆ°Æ¡ng láº¡i, tháº­m chÃ­ Ä‘áº¿n cáº£ cÃ´ng ty thá»±c pháº©m thÃªm chá»¯ Blockchain vÃ o tÃªn sáº£n pháº©m cÅ©ng Ä‘á»§ lÃ m giÃ¡ cá»• phiáº¿u tÄƒng máº¥y chá»¥c láº§n. Váº­y Blockchain lÃ  gÃ¬ vÃ  nÃ³ cÃ³ thá»±c sá»± lÃ  thá»© sáº½ lÃ m thay Ä‘á»•i tÆ°Æ¡ng lai cÃ´ng nghá»‡? Äá»ƒ tráº£ lá»i tháº¯c máº¯c cá»§a chÃ­nh mÃ¬nh, tÃ´i Ä‘Ã£ dÃ nh thá»i gian Ä‘á»ƒ tÃ¬m hiá»ƒu vá» Blockchain. CÃ³ thá»ƒ cÃ³ má»™t sá»‘ sai sÃ³t khÃ´ng trÃ¡nh khá»i. Ráº¥t mong nháº­n Ä‘Æ°á»£c sá»± gÃ³p Ã½.\n I. Blockchain lÃ  gÃ¬? 1. Äá»‹nh nghÄ©a KhÃ³ cÃ³ thá»ƒ Ä‘Æ°a ra má»™t Ä‘á»‹nh nghÄ©a chÃ­nh xÃ¡c cho Blockchain\nBlockchain lÃ  má»™t cÃ´ng nghá»‡ xÃ¡c thá»±c, xá»­ lÃ½ vÃ  lÆ°u trá»¯ cÃ¡c giao dá»‹ch trÃªn máº¡ng internet dá»±a trÃªn há»‡ thá»‘ng phÃ¢n tÃ¡n.\nNguá»“n gá»‘c tÃªn gá»i Blockchain xuáº¥t phÃ¡t tá»« cÃ´ng nghá»‡ lÆ°u trá»¯ dá»¯ liá»‡u thÃ nh cÃ¡c khá»‘i block, sau Ä‘Ã³ cÃ¡c khá»‘i nÃ y Ä‘Æ°á»£c káº¿t ná»‘i láº¡i vá»›i nhau thÃ nh má»™t chuá»—i chain.\n2. CÃ¡ch tá»• chá»©c dá»¯ liá»‡u Táº¥t cáº£ dá»¯ liá»‡u trong há»‡ thá»‘ng Blockchain sáº½ Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i thÃ nh cÃ¡c khá»‘i, cÃ¡c khá»‘i nÃ y liÃªn káº¿t vá»›i nhau táº¡o thÃ nh má»™t chuá»—i duy nháº¥t vÃ  thá»‘ng nháº¥t trÃªn toÃ n bá»™ há»‡ thá»‘ng.\nMá»—i block chá»©a nhiá»u giao dá»‹ch (transaction) khÃ¡c nhau vÃ  Má»—i block cÃ³ chá»©a mÃ£ hash cá»§a block trÆ°á»›c nÃ³. MÃ£ hash Ä‘Æ°á»£c táº¡o ra nhá» cÃ¡c thuáº­t toÃ¡n phá»©c táº¡p nhÆ° SHA256, MD5, â€¦ giÃ¡ trá»‹ cá»§a mÃ£ hash lÃ  khÃ¡c nhau cho cÃ¡c dá»¯ liá»‡u khÃ¡c nhau. Chá»‰ cáº§n má»™t sá»± thay Ä‘á»•i nhá» trong dá»¯ liá»‡u cÅ©ng sáº½ lÃ m thay Ä‘á»•i giÃ¡ trá»‹ cá»§a mÃ£ hash. Nhá» mÃ£ hash nÃ y mÃ  viá»‡c thay Ä‘á»•i giÃ¡ trá»‹ cá»§a má»™t block sáº½ khiáº¿n mÃ£ hash nÃ³ thay Ä‘á»•i vÃ  khÃ´ng cÃ²n trÃ¹ng vá»›i mÃ£ hash Ä‘Æ°á»£c lÆ°u á»Ÿ block sau nÃ³. Nhá» mÃ£ hash mÃ  há»‡ thá»‘ng cÃ³ thá»ƒ kiá»ƒm tra vÃ  loáº¡i bá» nhá»¯ng thÃ´ng tin bá»‹ cá»‘ tÃ¬nh thay Ä‘á»•i.\nTransaction lÃ  thÃ´ng tin cá»§a cÃ¡c giao dá»‹ch. Giao dá»‹ch á»Ÿ Ä‘Ã¢y khÃ´ng giá»›i háº¡n trong chuyá»ƒn tiá»n, transaction cÃ³ thá»ƒ chá»©a báº¥t cá»© thÃ´ng tin gÃ¬ nhÆ° hÃ¬nh áº£nh, Ã¢m thanh, â€¦.\n3. Blockchain network Äá»ƒ hiá»‡n thá»±c cÃ´ng nghá»‡ blockchain cáº§n cÃ³ má»™t há»‡ thá»‘ng cÃ¡c mÃ¡y tÃ­nh káº¿t ná»‘i vá»›i máº¡ng internet vÃ  cháº¡y má»™t á»©ng dá»¥ng khÃ¡ch client.\nMá»—i mÃ¡y tÃ­nh trong network Ä‘Æ°á»£c gá»i lÃ  node. Má»—i node cÃ³ thá»ƒ chá»©a báº£n sao (hoáº·c má»™t pháº§n) dá»¯ liá»‡u cá»§a há»‡ thá»‘ng blockchain. Äiá»u nÃ y giÃºp trÃ¡nh viá»‡t máº¥t mÃ¡t dá»¯ liá»‡u vÃ  Ä‘áº£m báº£o an toÃ n cho há»‡ thá»‘ng.\n4. LÆ°u trá»¯ dá»¯ liá»‡u Blockchain sá»­ dá»¥ng cÃ´ng nghá»‡ lÆ°u trá»¯ dá»¯ liá»‡u gá»i lÃ  sá»• cÃ¡i phÃ¢n tÃ¡n (distributed ledger). Trong Ä‘Ã³ dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c lÆ°u trÃªn táº¥t cáº£ cÃ¡c node trong network, má»—i node sáº½ chá»©a báº£n sao cá»§a blockchain. Khi cÃ³ má»™t thay Ä‘á»•i trÃªn blockchain, thay Ä‘á»•i nÃ y sáº½ Ä‘Æ°á»£c Ä‘á»“ng bá»™ hoÃ¡ trong toÃ n bá»™ há»‡ thá»‘ng. Sau 1 thá»i gian thÃ¬ toÃ n bá»™ cÃ¡c node trÃªn há»‡ thá»‘ng sáº½ Ä‘á»“ng bá»™ trá»Ÿ láº¡i vÃ  toÃ n bá»™ cÃ¡c báº£n sao trong há»‡ thá»‘ng sáº½ hoÃ n toÃ n giá»‘ng nhau.\n5. Äáº·c Ä‘iá»ƒm cá»§a há»‡ thá»‘ng Blockchain  Dá»¯ liá»‡u má»™t khi Ä‘Ã£ lÆ°u trá»¯ thÃ¬ háº§u nhÆ° khÃ´ng thá»ƒ sá»­a Ä‘á»•i Ä‘Æ°á»£c LuÃ´n cÃ³ thá»ƒ truy váº¿t nguá»“n gá»‘c cá»§a dá»¯ liá»‡u qua táº¥t cáº£ cÃ¡c giao dá»‹ch trÆ°á»›c Ä‘Ã³ Dá»¯ liá»‡u trÃªn toÃ n bá»™ há»‡ thá»‘ng thá»‘ng nháº¥t vá»›i nhau Phi táº­p trung: viá»‡c xÃ¡c nháº­n vÃ  thá»±c thi cÃ¡c giao dá»‹ch khÃ´ng cáº§n phá»¥ thuá»™c vÃ o má»™t bÃªn trung gian thá»© 3 cá»¥ thá»ƒ, mÃ  Ä‘Æ°á»£c xÃ¡c nháº­n bá»Ÿi toÃ n bá»™ há»‡ thá»‘ng. Dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ phÃ¢n tÃ¡n trÃªn toÃ n bá»™ há»‡ thá»‘ng Sá»­ dá»¥ng cÃ¡c cÆ¡ cháº¿ Ä‘á»“ng thuáº­n Ä‘á»ƒ xÃ¡c nháº­n giao dá»‹ch Má»—i giao dá»‹ch cáº§n cÃ³ sá»± tham gia cá»§a toÃ n bá»™ há»‡ thá»‘ng  6. Æ¯u Ä‘iá»ƒm   á»”n Ä‘á»‹nh : KhÃ¡c vá»›i há»‡ thá»‘ng táº­p trung, khi má»™t pháº§n dá»‹ch vá»¥ ngÆ°ng hoáº¡t Ä‘á»™ng sáº½ áº£nh hÆ°á»Ÿng toÃ n bá»™ há»‡ thá»‘ng. Khi má»™t vÃ i node trong há»‡ thá»‘ng bá»‹ dá»«ng hoáº·c máº¥t mÃ¡t dá»¯ liá»‡u, toÃ n bá»™ há»‡ thá»‘ng váº«n hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng.\n  An toÃ n dá»¯ liá»‡u: Má»™t khi dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c lÆ°u vÃ o trong há»‡ thá»‘ng thÃ¬ háº§u nhÆ° khÃ´ng thá»ƒ thay Ä‘á»•i\n  Báº£o máº­t: Dá»¯ liá»‡u khÃ´ng thá»ƒ thay Ä‘á»•i, viá»‡c thÃªm má»›i dá»¯ liá»‡u cáº§n cÃ³ sá»± xÃ¡c nháº­n vÃ  Ä‘á»“ng thuáº­n cá»§a toÃ n bá»™ há»‡ thá»‘ng nÃªn khÃ³ Ä‘á»ƒ giáº£ máº¡o thÃ´ng tin.\n  Thá»‘ng nháº¥t: Dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn cÃ¡c node Ä‘Æ°á»£c Ä‘á»“ng bá»™ vÃ  thá»‘ng nháº¥t vá»›i nhau. KhÃ´ng cáº§n trung gian/ khÃ´ng cáº§n tin tÆ°á»Ÿng: Viá»‡c xÃ¡c nháº­n cÃ¡c giao dá»‹ch do toÃ n bá»™ cÃ¡c node trong há»‡ thá»‘ng thá»±c hiá»‡n nÃªn khÃ´ng cáº§n pháº£i thÃ´ng qua má»™t bÃªn thá»© 3 Ä‘Æ°á»£c tin tÆ°á»Ÿng. VÃ­ dá»¥: thÃ´ng thÆ°á»ng chuyá»ƒn tiá»n qua ngÃ¢n hÃ ng cáº§n 2 bÃªn tin tÆ°á»Ÿng tuyá»‡t Ä‘á»‘i vÃ o ngÃ¢n hÃ ng. Trong blockchain, cÃ¡c giao dá»‹ch Ä‘Æ°á»£c thá»±c hiá»‡n trá»±c tiáº¿p\n  Giáº£m bá»›t chi phÃ­, thá»i gian: CÃ¡c giao dá»‹ch khÃ´ng cáº§n khoáº£n phÃ­ ráº¥t nhá» do khÃ´ng pháº£i tráº£ cho bÃªn trung gian. Thá»i gian giao dá»‹ch nhanh, khÃ´ng cáº§n Ä‘á»£i xÃ¡c nháº­n tá»« ngÃ¢n hÃ ng, khÃ´ng pháº£i chá» ngÃ y cuá»‘i tuáº§n, \u0026hellip;\n  Háº¡n cháº¿ lá»—i phÃ¡t sinh do con ngÆ°á»i: ToÃ n bá»™ cÃ¡c hoáº¡t Ä‘á»™ng cá»§a blockchain do há»‡ thá»‘ng tá»± váº­n hÃ nh, khÃ´ng cÃ³ sá»± can thiá»‡p cá»§a con ngÆ°á»i.\nâ€‹\n  7. NhÆ°á»£c Ä‘iá»ƒm  LÃ£ng phÃ­: viá»‡c xá»­ lÃ½ tÃ­nh toÃ¡n Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi táº¥t cáº£ cÃ¡c node trong há»‡ thá»‘ng nhÆ°ng chá»‰ káº¿t quáº£ cá»§a 1 node Ä‘Æ°á»£c sá»­ dá»¥ng, chi phÃ­ tÃ­nh toÃ¡n cá»§a táº¥t cáº£ node cÃ²n láº¡i bá»‹ lÃ£ng phÃ­. KhÃ³ má»Ÿ rá»™ng: Viá»‡c xÃ¡c nháº­n cÃ¡c giao dá»‹ch vÃ  Ä‘Ã³ng gÃ³i dá»¯ liá»‡u Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi toÃ n bá»™ cÃ¡c node trong há»‡ thá»‘ng. Náº¿u lÆ°á»£ng giao dá»‹ch quÃ¡ lá»›n trong khoáº£ng thá»i gian ngáº¯n thÃ¬ há»‡ thá»‘ng khÃ´ng thá»ƒ Ä‘Ã¡p á»©ng viá»‡c xá»­ lÃ½ Ä‘á»“ng thá»i quÃ¡ nhiá»u Váº¥n Ä‘á» lÆ°u trá»¯ dá»¯ liá»‡u: Khi há»‡ thá»‘ng trá»Ÿ nÃªn lá»›n hÆ¡n thÃ¬ lÆ°á»£ng dá»¯ liá»‡u cáº§n lÆ°u trá»¯ sáº½ ngÃ y cÃ ng lá»›n. NhÆ° Ethereum má»—i nÄƒm dá»¯ liá»‡u tÄƒng khoáº£ng 55GB, náº¿u táº¥t cáº£ cÃ¡c node Ä‘á»u lÆ°u trá»¯ dá»¯ liá»‡u nÃ y thÃ¬ cÃ¡c node sáº½ cáº§n kháº£ nÄƒng xá»­ lÃ½ cao hÆ¡n vÃ  Ä‘iá»u nÃ y khÃ´ng thá»±c táº¿. Náº¿u chá»‰ cÃ³ má»™t sá»‘ node lÆ°u trá»¯ full data thÃ¬ viá»‡c táº¥n cÃ´ng sáº½ dá»… hÆ¡n bá»Ÿi vÃ¬ chá»‰ cáº§n táº¥n cÃ´ng má»™t sá»‘ Ã­t node. TÃ­ch há»£p phá»©c táº¡p: Blockchain lÃ  cÃ´ng nghá»‡ hoÃ n toÃ n má»›i nÃªn viá»‡c tÃ­ch há»£p vÃ o cÃ¡c há»‡ thá»‘ng cÅ© sáº½ ráº¥t khÃ³ khÄƒn ChÆ°a hoÃ n thiá»‡n: Hiá»‡n nay cÃ´ng nghá»‡ blockchain váº«n Ä‘ang trong giai Ä‘oáº¡n phÃ¡t triá»ƒn vÃ  chÆ°a cÃ³ má»™t á»©ng dá»¥ng nÃ o Ã¡p dá»¥ng cÃ´ng nghá»‡ blockchain thÃ nh cÃ´ng ngoÃ i lÄ©nh vá»±c tiá»n áº£o  8. CÃ¡c á»©ng dá»¥ng cá»§a blockchain / CÃ¡c váº¥n Ä‘á» mÃ  blockchain cÃ³ thá»ƒ xá»­ lÃ½  Truy xuáº¥t nguá»“n gá»‘c sáº£n pháº©m (váº­t lÃ½ hay ká»¹ thuáº­t sá»‘) Giáº£m chi phÃ­ trung gian Giáº£i quyáº¿t váº¥n Ä‘á» giao dá»‹ch khÃ´ng cáº§n tin tÆ°á»Ÿng láº«n nhau Há»£p Ä‘á»“ng thÃ´ng minh smart contract tá»± Ä‘á»™ng thá»±c thi Ä‘iá»u khoáº£n há»£p Ä‘á»“ng khi cÃ¡c Ä‘iá»u kiá»‡n Ä‘Æ°á»£c Ä‘Ã¡p á»©ng, trÃ¡nh viá»‡c chÃ¢y á»³, phÃ¡ há»£p Ä‘á»“ng.  II. Smart contract 1. Smart contract lÃ  gÃ¬? Smart contract lÃ  má»™t chÆ°Æ¡ng trÃ¬nh mÃ¡y tÃ­nh Ä‘Æ°á»£c lÆ°u trá»¯ trong blockchain, cÃ³ kháº£ nÄƒng thá»±c thi cÃ¡c thoáº£ thuáº­n tá»± Ä‘á»™ng mÃ  khÃ´ng cáº§n sá»± can thiá»‡p tá»« con ngÆ°á»i.\nSmart contract nÃ³i má»™t cÃ¡ch chÃ­nh xÃ¡c hÆ¡n lÃ  giao dá»‹ch cÃ³ Ä‘iá»u kiá»‡n conditional transaction. NghÄ©a lÃ  khi 2 bÃªn Ä‘á»“ng Ã½ cÃ¡c Ä‘iá»u khoáº£n vá»›i nhau thÃ¬ sáº½ láº­p nÃªn má»™t smart contract/transaction vá»›i cÃ¡c Ä‘iá»u kiá»‡n rÃ ng buá»™c. Khi cÃ¡c Ä‘iá»u kiá»‡n nÃ y thoáº£ thÃ¬ sáº½ thá»±c hiá»‡n giao dá»‹ch (transaction)/ hoáº·c huá»· giao dá»‹ch tuá»³ Ä‘iá»u kiá»‡n.\nSmart contract Ä‘Æ°á»£c há»— trá»£ bá»Ÿi háº§u háº¿t cÃ¡c ná»n táº£ng blockchain hiá»‡n táº¡i nhÆ°ng Ethereum lÃ  ná»n táº£ng Ä‘Æ°á»£c sá»­ dá»¥ng nhiá»u nháº¥t bá»Ÿi sá»± linh hoáº¡t vÃ  cÃ¡c tÃ­nh nÄƒng mÃ  nÃ³ há»— trá»£.\nVÃ­ dá»¥:\nKhi A mua hÃ ng sÃ¡ch online táº¡i Shop P, cuá»‘n sÃ¡ch trá»‹ giÃ¡ 200k, A vÃ  Shop P láº­p 1 smart contract\n 200k cá»§a A sáº½ Ä‘Æ°á»£c lÆ°u trong smart contract Ä‘iá»u kiá»‡n lÃ  khi A nháº­n Ä‘Æ°á»£c cuá»‘n sÃ¡ch tá»« Shop P -\u0026gt; chuyá»ƒn 200k vÃ o tÃ i khoáº£n shop P.  2. Smart contract hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o? implement smart contract Ethereum\nLÃ m thá»­ rá»“i hiá»ƒu\n3. Æ¯u vÃ  nhÆ°á»£c Ä‘iá»ƒm cá»§a Smart contract Æ¯u Ä‘iá»ƒm:\n KhÃ´ng cáº§n sá»± can thiá»‡p cá»§a con ngÆ°á»i trong viá»‡c thá»±c thi há»£p Ä‘á»“ng Giáº£m bá»›t chi phÃ­ trung gian: luáº­t sÆ°, phÃ­ giao dá»‹ch ngÃ¢n hÃ ng KhÃ´ng cáº§n tin tÆ°á»Ÿng Ä‘á»‘i tÃ¡c Tá»± Ä‘á»™ng thá»±c thi  NhÆ°á»£c Ä‘iá»ƒm:\n  Äá»ƒ kiá»ƒm tra Ä‘iá»u kiá»‡n cá»§a smart contract thÃ¬ toÃ n bá»™ há»‡ thá»‘ng pháº£i truy xuáº¥t vÃ o cÃ¹ng 1 nguá»“n dá»¯ liá»‡u\n Viá»‡c nÃ y giá»‘ng nhÆ° táº¥n cÃ´ng DDOS KhÃ´ng cÃ³ gÃ¬ Ä‘áº£m báº£o táº¥t cáº£ cÃ¡c káº¿t quáº£ tráº£ vá» lÃ  giá»‘ng nhau, vd: nguá»“n ko hoáº¡t Ä‘á»™ng, bá»‹ thay Ä‘á»•i    Smart contract khÃ´ng thá»ƒ cáº­p nháº­t cÃ¡c Ä‘iá»u khoáº£n\n  KhÃ´ng thá»ƒ huá»· bá»\n  TÃ­nh chÃ­nh xÃ¡c cá»§a smart contract phá»¥ thuá»™c vÃ o ngÆ°á»i thiáº¿t láº­p cÃ¡c Ä‘iá»u khoáº£n (thÆ°á»ng lÃ  láº­p trÃ¬nh viÃªn)\n Láº­p trÃ¬nh viÃªn lÃ  con ngÆ°á»i vÃ  cÃ³ xÃ¡c suáº¥t lá»—i Láº­p trÃ¬nh viÃªn pháº£i hoÃ n toÃ n hiá»ƒu cÃ¡c Ä‘iá»u khoáº£n Ä‘á»ƒ chuyá»ƒn thÃ nh chÆ°Æ¡ng trÃ¬nh Pháº£i hoÃ n toÃ n tin tÆ°á»Ÿng vÃ o láº­p trÃ¬nh viÃªn. ğŸ‘¹(they can be evil)    Nguá»“n dá»¯ liá»‡u Ä‘á»ƒ kiá»ƒm tra cÃ¡c Ä‘iá»u kiá»‡n cÃ³ thá»ƒ Ä‘áº¿n tá»« tháº¿ giá»›i thá»±c (vd xÃ¡c nháº­n Ä‘Ã£ nháº­n hÃ ng) thÃ¬ váº«n cÃ³ thá»ƒ bá»‹ táº¥n cÃ´ng, giáº£ máº¡o cÃ¡c thÃ´ng tin Ä‘áº§u vÃ o, hoáº·c phá»¥ thuá»™c vÃ o 1 bÃªn thá»© 3 Ä‘Æ°á»£c tin tÆ°á»Ÿng tuyá»‡t Ä‘á»‘i\n  4. á»¨ng dá»¥ng cá»§a Smart contract Táº¥t cáº£ nhá»¯ng hoáº¡t Ä‘á»™ng giao dá»‹ch cÃ³ Ä‘iá»u kiá»‡n Ä‘á»u cÃ³ thá»ƒ sá»­ dá»¥ng smart contract\n  Táº¡o ra cÃ¡c token má»›i, cÃ³ thá»ƒ sá»­ dá»¥ng nhÆ° 1 loáº¡i tiá»n Ä‘iá»‡n tá»­\n  Xá»• sá»‘\n  Mua hÃ ng online\n  Báº£o hiá»ƒm\n  Mua nhÃ \n  Giao hÃ ng\n  CÃ¡ Ä‘á»™\n  â€¦..\n  III. Fork, Hard fork vs soft fork? 1 Fork lÃ  gÃ¬? NhÆ° Ä‘Ã£ biáº¿t Blockchain lÃ  má»™t chuá»—i cÃ¡c khá»‘i liÃªn káº¿t vá»›i nhau, vÃ  cÃ¡c chuá»—i nÃ y lÃ  giá»‘ng nhau trÃªn toÃ n bá»™ há»‡ thá»‘ng. CÃ¡c node  trong há»‡ thá»‘ng thÃ´ng qua má»™t cÆ¡ cháº¿ Ä‘á»“ng thuáº­n  consensus Ä‘á»ƒ xÃ¡c Ä‘á»‹nh khá»‘i nÃ o sáº½ Ä‘Æ°á»£c thÃªm vÃ o blockchain. Fork  xáº£y ra khi má»™t há»‡ thá»‘ng khÃ´ng Ä‘áº¡t Ä‘Æ°á»£c sá»± Ä‘á»‘ng thuáº­n trong viá»‡c ghi cÃ¡c khá»‘i má»›i vÃ  blockchain bá»‹ chia tÃ¡ch thÃ nh 2 nhÃ¡nh khÃ¡ch nhau.\nNguyÃªn nhÃ¢n cá»§a fork lÃ  do:\n ThÃªm cÃ¡c tÃ­nh nÄƒng má»›i Ä‘á»ƒ cáº£i tiáº¿n chá»©c nÄƒng cá»§a há»‡ thá»‘ng blockchain hiá»‡n táº¡i. Sá»­a Ä‘á»•i cÃ¡c rule (quy Ä‘á»‹nh) trong quÃ¡ trÃ¬nh xÃ¡c nháº­n giao dá»‹ch vÃ  táº¡o khá»‘i (Vd: kÃ­ch thÆ°á»›c cá»§a 1 block)  Do nhá»¯ng thay Ä‘á»•i nÃ y lÃ  permanent(lÃ¢u dÃ i) nÃªn khi thá»±c hiá»‡n fork cÃ¡c node trong há»‡ thá»‘ng cáº§n pháº£i cáº­p nháº­t á»©ng dá»¥ng client Ä‘á»ƒ tÃ­ch há»£p cÃ¡c rule má»›i.\nFork Ä‘Æ°á»£c chia lÃ m 3 loáº¡i:\n Soft fork Hard fork Spin-off coin  2 Soft fork Soft fork lÃ  nhá»¯ng cáº­p nháº­t pháº§n má»m cÃ³ tÆ°Æ¡ng thÃ­ch vá»›i phiÃªn báº£n cÅ© , nghÄ©a lÃ  cÃ¡c node khÃ´ng cáº§n cáº­p nháº­t pháº§n má»m má»›i váº«n cÃ³ thá»ƒ thá»±c hiá»‡n viá»‡c kiá»ƒm tra (validate) vÃ  xÃ¡c nháº­n(verify) cÃ¡c giao dá»‹ch. Äá»ƒ hoÃ n thÃ nh soft fork chá»‰ cáº§n pháº§n lá»›n cÃ¡c node trong há»‡ thá»‘ng cáº­p nháº­t phiÃªn báº£n má»›i, cÃ¡c node cÅ© váº«n cÃ³ thá»ƒ tiáº¿p tá»¥c xÃ¡c nháº­n cÃ¡c block má»›i táº¡o.\nSoft fork lÃ  thá»±c hiá»‡n viá»‡c cáº­p nháº­t tá»« tá»« vÃ  khÃ´ng áº£nh hÆ°á»Ÿng nhiá»u Ä‘áº¿n chá»©c nÄƒng cá»§a há»‡ thá»‘ng.\nVÃ­ dá»¥:\nThay Ä‘á»•i kÃ­ch thÆ°á»›c block tá»« 1MB lÃªn 2MB, cÃ¡c node chÆ°a cáº­p nháº­t váº«n cÃ³ thá»ƒ tiáº¿p nháº­n vÃ  xá»­ lÃ½ cÃ¡c giao dá»‹ch, tuy nhiÃªn cÃ¡c block do cÃ¡c node nÃ y táº¡o ra sáº½ bá»‹ há»‡ thá»‘ng bá» qua, khÃ´ng cho ghi vÃ o blockchain, nÃªn cÃ´ng sá»©c xá»­ lÃ½ cá»§a cÃ¡c node nÃ y coi nhÆ° lÃ  bá»‹ lÃ£ng phÃ­.\n3 Hard fork Hard fork lÃ  nhá»¯ng cáº­p nháº­t pháº§n má»m táº¡o nÃªn sá»± khÃ´ng tÆ°Æ¡ng thÃ­ch vá»›i cÃ¡c phiÃªn báº£n cÅ©. Äá»ƒ hoÃ n toÃ n cáº­p nháº­t, táº¥t cáº£ cÃ¡c node pháº£i cáº­p nháº­t pháº§n má»m lÃªn phiÃªn báº£n má»›i. Nhá»¯ng node khÃ´ng cáº­p nháº­t sáº½ váº«n tiáº¿p tá»¥c hoáº¡t Ä‘á»™ng theo cÃ¡c rule cÅ©. CÃ¡c node má»›i vÃ  node cÅ© sáº½ táº¡o nÃªn 2 phiÃªn báº£n khÃ¡c nhau tá»« 1 blockchain ban Ä‘áº§u.\nViá»‡c thá»±c hiá»‡n Hard fork cÃ³ thá»ƒ lÃ  do cÃ³ káº¿ hoáº¡ch trÆ°á»›c hoáº·c lÃ  do sá»± chia ráº½ trong cá»™ng Ä‘á»“ng sá»­ dá»¥ng, báº£o trÃ¬ blockchain.\n3.1 Hard fork cÃ³ káº¿ hoáº¡ch  LÃ  nhá»¯ng cáº­p nháº­t trong giao thá»©c Ä‘Ã£ Ä‘Æ°á»£c lÃªn káº¿ hoáº¡ch tá»« trÆ°á»›c vÃ  cÃ³ sá»± Ä‘á»“ng thuáº­n tá»« toÃ n bá»™ cá»™ng Ä‘á»“ng. Táº¥t cáº£ cÃ¡c node sáº½ dáº§n chuyá»ƒn hoÃ n toÃ n qua nhÃ¡nh má»›i tÃ¡ch ra. NhÃ¡nh cÅ© sáº½ bá»‹ bá» Ä‘i Viá»‡c cáº­p nháº­t sáº½ khÃ´ng gÃ¢y áº£nh hÆ°á»Ÿng tá»›i giÃ¡ trá»‹ cá»§a coin  3.2 Hard fork do tranh cÃ£i  ThÃ´ng thÆ°á»ng lÃ  do sá»± báº¥t Ä‘á»“ng Ã½ kiáº¿n trong cá»™ng Ä‘á»“ng trong viá»‡c xÃ¡c Ä‘á»‹nh nhá»¯ng thay Ä‘á»•i mÃ  má»—i bÃªn cho lÃ  tá»‘t nháº¥t Ä‘á»‘i vá»›i blockchain hiá»‡n táº¡i. Blockchain sáº½ chia tÃ¡ch thÃ nh 2 phiÃªn báº£n khÃ¡c nhau cÃ¹ng tá»“n táº¡i song song vá»›i nhau. CÃ¡c node trong máº¡ng lÆ°á»›i ban Ä‘áº§u cÅ©ng sáº½ tÃ¡ch thÃ nh 2 máº¡ng lÆ°á»›i khÃ¡c nhau: má»—i bÃªn sá»­ dá»¥ng 1 báº£n cáº­p nháº­t khÃ¡c nhau. CÃ¡c giao dá»‹ch trÆ°á»›c khi chia tÃ¡ch sáº½ tá»“n táº¡i trong cáº£ 2 blockchain  VÃ­ dá»¥\nViá»‡c hard fork Bitcoin thÃ nh Bitcoin vÃ  Bitcoin Cash, do 1 bÃªn muá»‘n giá»¯ kÃ­ch thÆ°á»›c Block 1MB vÃ  1 bÃªn muá»‘n nÃ¢ng kÃ­ch thÆ°á»›c block lÃªn 8MB Ä‘á»ƒ tÄƒng kháº£ nÄƒng má»Ÿ rá»™ng cá»§a Bitcoin (thá»±c hiá»‡n nhiá»u giao dá»‹ch hÆ¡n trong cÃ¹ng thá»i gian)\n4 Spin-off coin Sá»­ dá»¥ng mÃ£ nguá»“n cá»§a nhá»¯ng coin cÃ³ sáºµn vÃ  thay Ä‘á»•i Ä‘á»ƒ táº¡o nÃªn blockchain má»›i vá»›i nhá»¯ng tÃ­nh nÄƒng má»›i thÃªm vÃ o.\nVÃ­ dá»¥\nLitecoin lÃ  má»™t coin dá»±a trÃªn mÃ£ nguá»“n cá»§a Bitcoin vá»›i cÃ¡c thay Ä‘á»•i:\n Thá»i gian xá»­ lÃ½ block trung bÃ¬nh lÃ  2.5 phÃºt so vá»›i 10 phÃºt cá»§a Bitcoin Sá»­ dá»¥ng thuáº­t toÃ¡n Scrypt thay vÃ¬ SHA256 Giá»›i háº¡n tá»•ng sá»‘ coin lÃ  84 triá»‡u so vá»›i 21 triá»‡u Bitcoin  IV. Coin vs Token 1. Coin lÃ  gÃ¬? Coin lÃ  má»™t loáº¡i tiá»n mÃ£ hoÃ¡ (crypto currency) Ä‘Æ°á»£c táº¡o ra vÃ  váº­n hÃ nh má»™t cÃ¡ch Ä‘á»™c láº­p dá»±a trÃªn má»™t ná»n táº£ng blockchain cá»§a riÃªng nÃ³.\nCoin lÃ  tá»« dÃ¹ng Ä‘á»ƒ chá»‰ chung cÃ¡c loáº¡i tiá»n áº£o nhÆ° : Bitcoin, Ethereum, \u0026hellip;\nAltcoin dÃ¹ng Ä‘á»ƒ chá»‰ cÃ¡c loáº¡i tiá»n áº£o ngoÃ i Bitcoin\n2. Token lÃ  gÃ¬ ? Táº¡o token má»›i tá»« Ethereum\nToken lÃ  cÃ¡c Ä‘Æ¡n vá»‹ cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ dao dá»‹ch nhÆ° coin, tuy nhiÃªn token Ä‘Æ°á»£c táº¡o ra vÃ  hoáº¡t Ä‘á»™ng dá»±a trÃªn cÆ¡ cháº¿ Smart contract mÃ  cÃ¡c ná»n táº£ng Blockchain nhÆ° Ethereum hay Omni cung cáº¥p.\nHiá»‡n nay hÆ¡n 80% cÃ¡c loáº¡i token Ä‘Æ°á»£c táº¡o ra dá»±a trÃªn ná»n táº£ng Ethereum\n3. PhÃ¢n loáº¡i token KhÃ´ng cÃ³ phÃ¢n loáº¡i cá»¥ thá»ƒ cho token. Má»™t token cÃ³ thá»ƒ sá»­ dá»¥ng cho má»™t hoáº·c nhiá»u má»¥c Ä‘Ã­ch:\n Sá»­ dá»¥ng nhÆ° Ä‘Æ¡n vá»‹ tiá»n tá»‡ TÃ i sáº£n sá»‘ (digital) CÃ´ng cá»¥ káº¿ toÃ¡n CÃ´ng cá»¥ phÃ¢n chia cá»• pháº§n náº¯m giá»¯ trong cÃ¡c start-up Má»™t phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ chá»‘ng táº¥n cÃ´ng Má»™t dáº¡ng Ä‘iá»ƒm, reward cho user \u0026hellip;  ","date":"11","image":"/img/blockchain.jpg","permalink":"http://bluzky.github.io/blog/2018-04-11-blockchain/","tags":["others","tech","blockchain"],"title":"TÃ¬m hiá»ƒu vá» cÃ´ng nghá»‡ Blockchain"},{"categories":null,"contents":"  Vá»«a má»›i hoÃ n thÃ nh cÃ¡c chá»©c nÄƒng cÆ¡ báº£n cho há»‡ thá»‘ng OKR ná»™i bá»™ cÃ´ng ty. Sau quÃ¡ trÃ¬nh tÃ¬m hiá»ƒu cÃ¡c phÆ°Æ¡ng phÃ¡p Ã¡p dá»¥ng OKR vÃ o trong má»™t tá»• chá»©c, mÃ¬nh tháº¥y nÃ³ ráº¥t lÃ  hay vÃ  Ä‘Æ¡n giáº£n, dá»… Ã¡p dá»¥ng. NgoÃ i viá»‡c Ã¡p dá»¥ng cho cÃ´ng ty, cÃ³ thá»ƒ Ã¡p dá»¥ng cÃ¡c nguyÃªn táº¯c cá»§a OKR Ä‘á»ƒ thiáº¿t láº­p káº¿ hoáº¡ch cÃ¡ nhÃ¢n. ÄÃ¢y lÃ  tÃ³m táº¯t má»™t sá»‘ ná»™i dung cÆ¡ báº£n vá» OKR, cÃ³ thá»ƒ cÃ³ má»™t sá»‘ sai sÃ³t mong nháº­n Ä‘Æ°á»£c sá»± gÃ³p Ã½.   1. OKR lÃ  gÃ¬? OKR - Objectives and Key Results - táº¡m dá»‹ch Má»¥c tiÃªu vÃ  Káº¿t quáº£ then chÃ´t.\nOKR lÃ  má»™t phÆ°Æ¡ng phÃ¡p thiáº¿t láº­p má»¥c tiÃªu giÃºp táº¡o sá»± thá»‘ng nháº¥t giá»¯a má»¥c tiÃªu cá»§a tá»«ng cÃ¡ nhÃ¢n vá»›i má»¥c tiÃªu cá»§a toÃ n cÃ´ng ty, táº­p trung Ä‘á»™ng lá»±c cá»§a toÃ n bá»™ cÃ´ng ty Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu Ä‘á» ra.\nOKR Ä‘Ã£ Ä‘Æ°á»£c Ã¡p dá»¥ng bá»Ÿi cÃ¡c cÃ´ng ty hÃ ng Ä‘áº§u nhÆ° Intel, Google (tá»« 1999), Oracle, Linked in, \u0026hellip;\nÄiá»ƒm khÃ¡c biá»‡t cá»§a OKR so vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p truyá»n thá»‘ng:\n OKR Ä‘Æ°á»£c thiáº¿t láº­p thÆ°á»ng xuyÃªn (thÃ´ng thÆ°á»ng lÃ  má»—i quÃ½) QuÃ¡ trÃ¬nh thá»±c hiá»‡n OKR bao gá»“m viá»‡c liÃªn tá»¥c theo dÃµi vÃ  Ä‘Ã¡nh giÃ¡ káº¿t quáº£ thá»±c hiá»‡n Ä‘Æ°á»£c. OKR Ä‘Æ¡n giáº£n, theo nhá»‹p Ä‘iá»‡u nhanh (do thá»i gian thá»±c hiá»‡n OKR ngáº¯n) vÃ  khuyáº¿n khÃ­ch sá»± tham gia cá»§a cÃ¡c nhÃ¢n viÃªn.  2. CÃ¡c lá»£i Ã­ch khi Ã¡p dá»¥ng OKR  Táº¡o nÃªn sá»± thá»‘ng nháº¥t trong cÃ´ng ty: má»¥c tiÃªu cá»§a má»—i cÃ¡ nhÃ¢n Ä‘á»u theo Ä‘á»‹nh hÆ°á»›ng cá»§a má»¥c tiÃªu cÃ´ng ty, khi má»—i cÃ¡ nhÃ¢n Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu thÃ¬ cÃ´ng ty sáº½ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu. Sá»± rÃµ rÃ ng vÃ  táº­p trung: Má»¥c tiÃªu cÃ¡ nhÃ¢n Ã­t vÃ  rÃµ rÃ ng, giÃºp nhÃ¢n viÃªn biáº¿t rÃµ má»¥c tiÃªu cá»§a mÃ¬nh vÃ  cáº§n lÃ m gÃ¬ Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu. Káº¿t ná»‘i nhÃ¢n viÃªn vá»›i sá»© má»‡nh cÃ´ng ty: khi má»¥c tiÃªu cá»§a má»—i nhÃ¢n viÃªn gáº¯n vá»›i má»¥c tiÃªu cÃ´ng ty, má»—i ngÆ°á»i sáº½ Ã½ thá»©c Ä‘Æ°á»£c sá»± Ä‘Ã³ng gÃ³p cá»§a cÃ¡ nhÃ¢n cho sá»± phÃ¡t triá»ƒn cá»§a cÃ´ng ty. Táº¡o nÃªn sá»± trong suá»‘t: nghÄ©a lÃ  má»—i nhÃ¢n viÃªn cÃ³ thá»ƒ tháº¥y Ä‘Æ°á»£c má»¥c tiÃªu cá»§a nhá»¯ng nhÃ¢n viÃªn khÃ¡c, qua Ä‘Ã³ thÃºc Ä‘áº©y sá»± há»£p tÃ¡c/há»— trá»£ Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu chung. ÄÆ¡n giáº£n, dá»… Ã¡p dá»¥ng, khÃ´ng tá»‘n nhiá»u thá»i gian  3. OKR hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o OKR dá»±a trÃªn cÃ¡c khÃ¡i niá»‡m\n Objective: Má»¥c tiÃªu muá»‘n Ä‘áº¡t Ä‘Æ°á»£c. (Báº¡n muá»‘n Ä‘i Ä‘áº¿n Ä‘Ã¢u?) Key Result: cÃ¡c káº¿t quáº£ then chá»‘t dÃ¹ng Ä‘á»ƒ Ä‘o lÆ°á»ng má»©c Ä‘á»™ hoÃ n thÃ nh cá»§a má»¥c tiÃªu. (LÃ m sao Ä‘á»ƒ biáº¿t lÃ  báº¡n Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu hay chÆ°a?)  BÆ°á»›c 1: XÃ¢y dá»±ng má»¥c tiÃªu cho toÃ n cÃ´ng ty Má»¥c tiÃªu cá»§a cÃ´ng ty nÃªn Ä‘Æ°á»£c thiáº¿t láº­p má»—i quÃ½ 1 láº§n. Dá»±a trÃªn má»¥c tiÃªu cá»§a cÃ´ng ty, cÃ¡c phÃ²ng ban thiáº¿t láº­p má»¥c tiÃªu phÃ²ng ban theo Ä‘á»‹nh hÆ°á»›ng cÃ´ng ty, tÆ°Æ¡ng tá»± thiáº¿t láº­p má»¥c tiÃªu xuá»‘ng cÃ¡c cáº¥p tháº¥p hÆ¡n. CÃ¡c má»¥c tiÃªu pháº£i Ä‘Æ°á»£c cá»¥ thá»ƒ hoÃ¡ báº±ng cÃ¡c káº¿t quáº£ then chá»‘t\n  Má»¥c tiÃªu (Objective)\n Má»—i cÃ¡ nhÃ¢n/ cÃ´ng ty chá»‰ nÃªn cÃ³ 3-5 má»¥c tiÃªu. CÃ¡c má»¥c tiÃªu nÃªn mang tÃ­nh tham vá»ng, lá»›n hÆ¡n kháº£ nÄƒng. CÃ¡c nghiÃªn cá»©u chá»©ng minh ráº±ng náº¿u Ä‘áº·t má»¥c tiÃªu cao thÃ¬ sáº½ cÃ³ kháº£ nÄƒng Ä‘áº¡t Ä‘Æ°á»£c káº¿t quáº£ cao hÆ¡n. Má»—i má»¥c tiÃªu chá»‰ nÃªn cÃ³ 3-4 káº¿t quáº£ then chá»‘t. Nhiá»u káº¿t quáº£ then chá»‘t sáº½ dá»… táº¡o nÃªn sá»± máº¥t táº­p trung. Má»¥c tiÃªu cá»§a cáº¥p tháº¥p hÆ¡n (vd phÃ²ng ban) sáº½ dá»±a trÃªn má»¥c tiÃªu cá»§a cáº¥p cao hÆ¡n(vd cÃ´ng ty). Má»—i cÃ¡ nhÃ¢n tá»± Ä‘áº·t ra má»¥c tiÃªu cá»§a mÃ¬nh vÃ  tháº£o luáº­n vá»›i cáº¥p trÃªn trá»±c tiáº¿p Ä‘á»ƒ thá»‘ng nháº¥t má»¥c tiÃªu theo Ä‘Ãºng Ä‘á»‹nh hÆ°á»›ng.    Káº¿t quáº£ then chá»‘t (key result) cáº§n pháº£i\n Cá»¥ thá»ƒ: CÃ³ thá»ƒ Ä‘o lÆ°á»ng Ä‘Æ°á»£c (cÃ³ thá»ƒ tÃ­nh báº±ng con sá»‘ cá»¥ thá»ƒ hoáº·c %) CÃ³ xÃ¡c Ä‘á»‹nh thá»i gian deadline KhÃ´ng nÃªn cáº£m tÃ­nh, cáº§n dá»±a trÃªn tÃ¬nh hÃ¬nh cá»¥ thá»ƒ cá»§a cÃ´ng ty    BÆ°á»›c 2: Thá»±c hiá»‡n  á» má»©c Ä‘á»™ cÃ¡ nhÃ¢n, cÃ¡c Key Result nÃªn Ä‘Æ°á»£c chia thÃ nh cÃ¡c Task (TÃ¡c vá»¥) thá»±c hiá»‡n trong ngÃ y hoáº·c tuáº§n.  BÆ°á»›c 3: ÄÃ¡nh giÃ¡ liÃªn tá»¥c (Check - in)  Check - in nÃªn Ä‘Æ°á»£c thá»±c hiá»‡n hÃ ng tuáº§n, cÃ³ thá»ƒ káº¿t há»£p vá»›i cÃ¡c buá»•i há»p khÃ¡c nhÆ° 15' stand-up meeting Má»¥c Ä‘Ã­ch cá»§a Check - in  ÄÃ¡nh giÃ¡ láº¡i cÃ¡c cÃ´ng viá»‡c Ä‘Ã£ lÃ m Giáº£i quyáº¿t cÃ¡c vÆ°á»›ng máº¯c/ khÃ³ khÄƒn gáº·p pháº£i. Nháº¯c nhá»Ÿ má»¥c tiÃªu mÃ  má»—i nhÃ¢n viÃªn cáº§n hÆ°á»›ng tá»›i    BÆ°á»›c 4: ÄÃ¡nh giÃ¡ tá»•ng káº¿t   ÄÃ¡nh giÃ¡ káº¿t quáº£ thá»±c hiá»‡n\n  Má»©c Ä‘á»™ hoÃ n thÃ nh Key result Ä‘Æ°á»£c tÃ­nh Ä‘iá»ƒm 0.0 - 1.0\n  Äiá»ƒm Ä‘Ã¡nh giÃ¡ cá»§a Objective tÃ­nh báº±ng Ä‘iá»ƒm trung bÃ¬nh cá»§a cÃ¡c Key result\n  Thang Ä‘Ã¡nh giÃ¡\n \u0026lt; 0.4: ChÆ°a Ä‘áº¡t 0.6 - 0.7: Tá»‘t   0.7: quÃ¡ dá»…\n     Khi má»¥c tiÃªu cÃ³ Ä‘iá»ƒm \u0026gt; 0.7 nghÄ©a lÃ  má»¥c tiÃªu Ä‘áº·t ra quÃ¡ dá»…, cáº§n pháº£i xem xÃ©t láº¡i viá»‡c Ä‘áº·t má»¥c tiÃªu láº§n sau\n  Khi má»¥c tiÃªu \u0026lt; 0.4 nghÄ©a lÃ  viá»‡c xÃ¡c Ä‘inh hoáº·c thá»±c hiá»‡n má»¥c tiÃªu chÆ°a tá»‘t.\n    Táº¡i sao má»¥c tiÃªu cty nÃªn theo tá»«ng quÃ½\n Thá»‘ng nháº¥t vá»›i lá»‹ch tÃ i chÃ­nh cá»§a cÃ´ng ty 3 thÃ¡ng lÃ  khoáº£ng thá»i gian Ä‘á»§ Ä‘á»ƒ táº¡o nÃªn káº¿t quáº£ cÃ³ thá»ƒ Ä‘Ã¡nh giÃ¡ Ä‘Æ°á»£c    OKR cho phÃ©p ngÆ°á»i quáº£n lÃ½ Ä‘áº£m báº£o ráº±ng táº¥t cáº£ nhÃ¢n viÃªn Ä‘ang hÆ°á»›ng Ä‘áº¿n má»¥c tiÃªu chung. Má»—i tuáº§n, má»—i cÃ¡ nhÃ¢n cáº§n (check-in) cáº­p nháº­t/Ä‘Ã¡nh giÃ¡ cÃ¡c káº¿t quáº£ then chá»‘t cá»§a mÃ¬nh Ä‘á»ƒ Ä‘áº£m báº£o cÃ¡c nhÃ¢n viÃªn Ä‘ang Ä‘i Ä‘Ãºng hÆ°á»›ng vÃ  giáº£m thá»i gian há»p khÃ´ng cáº§n thiáº¿t. Náº¿u má»™t nhÃ¢n viÃªn gáº·p cÃ¡c váº¥n Ä‘á» vÆ°á»›ng máº¯c, cÃ¡c váº¥n Ä‘á» nÃªn Ä‘Æ°á»£c giáº£i quyáº¿t thÃ´ng qua cÃ¡c cuá»™c há»p trá»±c tiáº¿p 1-1 vá»›i cáº¥p trÃªn trá»±c tiáº¿p.\n- NÃªn tÃ¡ch biá»‡t OKR vá»›i há»‡ thá»‘ng Ä‘Ã¡nh giÃ¡ hiá»‡u quáº£ cÃ´ng viá»‡c cá»§a nhÃ¢n viÃªn Ä‘á»ƒ trÃ¡nh táº¡o nÃªn viá»‡c Ä‘áº·t ra cÃ¡c\n4. Má»™t vÃ­ dá»¥ Ã¡p dá»¥ng OKR trong thiáº¿t láº­p má»¥c tiÃªu cÃ´ng ty  Comming soon\n 5. Má»™t sá»‘ sai láº§m khi Ã¡p dá»¥ng OKR  Sá»­ dá»¥ng OKR nhÆ° list cÃ´ng viá»‡c QuÃ¡ nhiá»u má»¥c tiÃªu. Thay vÃ¬ liá»‡t kÃª táº¥t cáº£ cÃ¡c má»¥c tiÃªu muá»‘n Ä‘áº¡t Ä‘Æ°á»£c, chá»‰ nÃªn chá»n ra 3-4 má»¥c tiÃªu vá»›i Ä‘á»™ Æ°u tiÃªn cao nháº¥t Thiáº¿u sá»± thá»‘ng nháº¥t má»¥c tiÃªu. Má»¥c tiÃªu cáº§n Ä‘Æ°á»£c thiáº¿t láº­p dá»±a trÃªn má»¥c tiÃªu chung cá»§a cÃ´ng ty vÃ  thÃ´ng qua tháº£o luáº­n Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Ä‘Ãºng trá»ng tÃ¢m. Thiáº¿t láº­p xong rá»“i quÃªn. Thá»±c hiá»‡n OKR pháº£i bao gá»“m viá»‡c liÃªn tá»¥c theo dÃµi vÃ  Ä‘Ã¡nh giÃ¡ káº¿t quáº£/tiáº¿n Ä‘á»™ thá»±c hiá»‡n, Ä‘áº£m báº£o má»—i cÃ¡ nhÃ¢n luÃ´n táº­p trung vÃ o OKR cá»§a mÃ¬nh. XÃ¢y dá»±ng OKR theo kiá»ƒu phÃ¢n cáº¥p, cáº¥p dÆ°á»›i pháº£i Ä‘á»£i cáº¥p trÃªn thiáº¿t láº­p xong má»¥c tiÃªu rá»“i má»›i táº¡o má»¥c tiÃªu cá»§a mÃ¬nh. Äiá»u nÃ y dáº«n tá»›i viá»‡c tá»‘n nhiá»u thá»i gian vÃ  má»¥c tiÃªu cá»§a cÃ¡ nhÃ¢n sáº½ sai lá»‡ch soi vá»›i má»¥c tiÃªu cÃ´ng ty náº¿u má»¥c tiÃªu á»Ÿ cáº¥p trÃªn chÆ°a Ä‘Ãºng.  ","date":"09","image":null,"permalink":"http://bluzky.github.io/blog/2018-02-09-tim-hieu-okr/","tags":["others","management"],"title":"Thiáº¿t láº­p vÃ  quáº£n lÃ½ má»¥c tiÃªu theo phÆ°Æ¡ng phÃ¡p OKR"},{"categories":null,"contents":"1. Giá»›i thiá»‡u  List lÃ  má»™t trong nhá»¯ng kiá»ƒu dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng ráº¥t nhiá»u trong python. CÃ¡c thao tÃ¡c thÆ°á»ng Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn list: xá»­ lÃ½ tá»«ng pháº§n tá»­ trong list, lá»c láº¥y má»™t sá»‘ pháº§n tá»­ thá»a Ä‘iá»u kiá»‡n, tÃ­nh toÃ¡n dá»±a trÃªn táº¥t cáº£ cÃ¡c pháº§n tá»­ cá»§a list( vd tÃ­nh tá»•ng) vÃ  tráº£ vá» káº¿t quáº£. Äá»ƒ Ä‘Æ¡n giáº£n viá»‡c xá»­ lÃ½ List, Python há»— trá»£ má»™t sá»‘ hÃ m cÃ³ sáºµn Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥ trÃªn gá»“m map(), filter(), reduce()  2. Map  map(func, seq) \u0026gt; map sáº½ Ã¡p dá»¥ng hÃ m func cho má»—i pháº§n tá»­ cá»§a seq vÃ  tráº£ vá» list káº¿t quáº£.\n VÃ­ dá»¥: TÃ­nh bÃ¬nh phÆ°Æ¡ng cÃ¡c sá»‘ cÃ³ trong list\na. sá»­ dá»¥ng map():\n1 2 3 4 5 6  my_list = [1,2,3,4,5] def binh_phuong(number): return number*number print map(binh_phuong, my_list) # [1,2,9,16,25]    Trong vÃ­ dá»¥ trÃªn, map sáº½ tá»± Ä‘á»™ng Ã¡p dá»¥ng hÃ m binh_phuong vá»›i má»—i pháº§n tá»­ trong danh sÃ¡ch my_list HÃ m truyá»n vÃ o hÃ m map nháº­n vÃ o má»™t tham sá»‘ cÃ¹ng kiá»ƒu vá»›i pháº§n tá»­ cá»§a list CÃ³ thá»ƒ sá»­ dá»¥ng lamda thay tháº¿ cho hÃ m. VÃ­ dá»¥ trÃªn cÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t láº¡i: print map(lambda x: x*x, my_list)  b. CÃ¡ch thÃ´ng thÆ°á»ng:\n1 2 3 4 5 6  my_list = [1,2,3,4,5] result = list() for number in my_list: result.append( number*number) print result # [1,2,9,16,25]   3. Filter   filter(func, list) HÃ m filter sáº½ gá»i hÃ m func vá»›i tham sá»‘ láº§n lÆ°á»£t lÃ  tá»«ng pháº§n tá»­ cá»§a list vÃ  tráº£ vá» danh sÃ¡ch cÃ¡c pháº§n tá»­ mÃ  func tráº£ vá» True func chá»‰ cÃ³ thá»ƒ tráº£ vá» True hoáº·c False   VÃ­ dá»¥: lá»c ra cÃ¡c sá»‘ cháºµn tá»« danh sÃ¡ch a. Sá»­ dá»¥ng filter:\n1 2 3 4 5 6 7 8 9  my_list = [1, 2, 3, 4, 5] def so_chan(number): if number % 2 == 0: return True else: return False print filter(so_chan, my_list) # [2,4]   #Sá»­ dá»¥ng lambda\n1  print filter(lambda x: x%2 ==0, my_list)# [2,4]   b. KhÃ´ng dÃ¹ng filter\n1 2 3 4 5 6 7 8  my_list = [1, 2, 3, 4, 5] ket_qua = list() for number in my_list: if number % 2 == 0: ket_qua.append(number) print ket_qua   4. Reduce  reduce(func, seq) reduce sáº½ tÃ­nh toÃ¡n vá»›i cÃ¡c pháº§n tá»­ cá»§a danh sÃ¡ch vÃ  tráº£ vá» káº¿t quáº£. func lÃ  má»™t hÃ m nháº­n vÃ o 2 tham sá»‘ cÃ³ dáº¡ngfunc(arg1, arg2) trong Ä‘Ã³ arg1 lÃ  káº¿t quáº£ tÃ­nh toÃ¡n vá»›i cÃ¡c pháº§n tá»­ trÆ°á»›c, arg2 lÃ  giÃ¡ trá»‹ cá»§a pháº§n tá»­ cá»§a danh sÃ¡ch Ä‘ang Ä‘Æ°á»£c tÃ­nh toÃ¡n.\n VÃ­ dá»¥: tÃ­nh tá»•ng bÃ¬nh phÆ°Æ¡ng cá»§a cÃ¡c pháº§n tá»­ trong máº£ng a. Su dung reduce\n1 2 3 4 5 6 7 8 9  data = [1,2,3,4] def tinh_tong(tong, so): return tong + so*so #su dung ham print reduce(tinh_tong, data) #30 #su dung lambda print reduce( (lambda tong, so: tong + so*so), data) #30   b. Khong su dung reduce\n1 2 3 4 5 6  data = [1,2,3,4] tong = 0 for so in data: tong += so*so print tong #30   5. Káº¿t luáº­n  Trong bÃ i viáº¿t chá»‰ Ä‘Æ°a ra nhá»¯ng vÃ­ dá»¥ Ä‘Æ¡n giáº£n nÃªn cÃ³ thá»ƒ cÃ¡c báº¡n chÆ°a tháº¥y Ä‘Æ°á»£c sá»± tiá»‡n dá»¥ng cá»§a map, filter, reduce. Tuy nhiÃªn khi pháº£i lÃ m viá»‡c vá»›i list nhiá»u cÃ¡c báº¡n sáº½ tháº¥y nÃ³ ráº¥t lÃ  tiá»‡n Ä‘áº·c biá»‡t lÃ  khi sá»­ dá»¥ng kÃ¨m lambda hoáº·c tÃ¡i sá»­ dá»¥ng cÃ¡c hÃ m vá»›i map, filter vÃ  reduce  ","date":"21","image":null,"permalink":"http://bluzky.github.io/blog/2018-01-21-python-xu-ly-mang-voi-filter-reduce/","tags":["python","python-basic"],"title":"DÃ¹ng MAP, FILTER vÃ  REDUCE Ä‘á»ƒ xá»­ lÃ½ danh sÃ¡ch / list trong Python"},{"categories":null,"contents":"1. Decorator lÃ  gÃ¬?  Decorator lÃ  má»™t máº«u thiáº¿t káº¿ (Design pattern) thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ thay Ä‘á»•i hÃ nh vi, chá»©c nÄƒng cá»§a hÃ m(function) hoáº·c lá»›p (class) mÃ  khÃ´ng cáº§n pháº£i thay Ä‘á»•i code cá»§a hÃ m hoáº·c lá»›p. Tham kháº£o Python há»— trá»£ cÃº phÃ¡p (syntax) cho Decorator tá»« version 2.4 Vá» cÆ¡ báº£n Decorator giá»‘ng nhÆ° má»™t lá»›p vá» bá»c (wrapper), nÃ³ thay Ä‘á»•i hÃ nh vi(behavior) cá»§a code trÆ°á»›c vÃ  sau khi gá»i hÃ m chÃ­nh (hÃ m Ä‘Æ°á»£c decorate).  2. Decorator Ä‘Æ°á»£c dÃ¹ng lÃ m gÃ¬? Táº¡i sao chÃºng ta cáº§n Decorator?\n Cho phÃ©p tÃ¡i sá»­ dá»¥ng code. Má»Ÿ rá»™ng cÃ¡c hÃ m, hoáº·c lá»›p mÃ  khÃ´ng cáº§n pháº£i thay Ä‘á»•i code cÃ³ sáºµn \u0026ndash;\u0026gt; khÃ´ng cáº§n test láº¡i.  VÃ­ dá»¥ trong chÆ°Æ¡ng trÃ¬nh cá»§a báº¡n báº¡n cáº§n kiá»ƒm tra quyá»n (permission) cá»§a ngÆ°á»i dÃ¹ng trÆ°á»›c khi thá»±c hiá»‡n hÃ m. Báº¡n cÃ³ thá»ƒ pháº£i thÃªm code vÃ o táº¥t cáº£ cÃ¡c hÃ m Ä‘Ã£ cÃ³ Ä‘á»ƒ kiá»ƒm tra. Thay vÃ o Ä‘Ã³ vá»›i decorator, báº¡n chá»‰ cáº§n Ä‘á»‹nh nghÄ©a má»™t decorator vÃ  khai bÃ¡o nÃ³ trÆ°á»›c hÃ m.\n3. LÃ m sao Ä‘á»ƒ Ä‘á»‹nh nghÄ©a má»™t decorator?   Decorator cÅ©ng lÃ  má»™t hÃ m chá»‰ khÃ¡c lÃ  hÃ m decorator nháº­n vÃ o má»™t hÃ m vÃ  káº¿t quáº£ tráº£ vá» cá»§a nÃ³ lÃ  hÃ m sau khi Ä‘Æ°á»£c decorate.\n  NhÆ° váº­y Ä‘á»ƒ Ä‘á»‹nh nghÄ©a má»™t decorator chá»‰ Ä‘Æ¡n giáº£n lÃ  Ä‘á»‹nh nghÄ©a má»™t hÃ m nháº­n vÃ o má»™t hÃ m khÃ¡c vÃ  tráº£ vá» má»™t hÃ m má»›i cÃ³ prototype tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i hÃ m nháº­n vÃ o.\n  VÃ­ dá»¥ 1:\n1 2 3 4 5 6 7 8  def ten_decorator(f): def wrapper(ten): chuoi_moi = \u0026#34;Ten tui la %s\u0026#34; % ten return f(chuoi_moi) return wrapper def xuat_ten( ten ): print ten     CHÃš Ã QUAN TRá»ŒNG: hÃ m wrapper vÃ  hÃ m f pháº£i cÃ³ tham sá»‘ phÃ¹ há»£p vá»›i nhau. VÃ­ dá»¥ nhÆ° hÃ m f nháº­n vÃ o chá»‰ 2 tham sá»‘ thÃ¬ hÃ m decorator khÃ´ng thá»ƒ nháº­n vÃ o 3 tham sá»‘ hoáº·c 1 tham sá»‘.\n  4. Sá»­ dá»¥ng decorator nhÆ° tháº¿ nÃ o?  Sá»­ dá»¥ng Decorator háº¿t sá»©c Ä‘Æ¡n giáº£n. Sá»­ dá»¥ng decorator trong vÃ­ dá»¥ trÃªn cho hÃ m xuat_ten nhÆ° sau:  1 2 3  @ten_decorator def xuat_ten(ten): print ten    DÃ¹ng dáº¥u @ Ä‘á»ƒ thÃ´ng bÃ¡o Ä‘Ã³ lÃ  má»™t decorator. Má»™t hÃ m cÃ³ thá»ƒ dÃ¹ng nhiá»u decorator cÃ¹ng lÃºc:  1 2 3 4 5  @ten_decorator1 @ten_decorator2 @ten_decorator3 def xuat_ten(ten): print ten   5. Decorator hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o? NhÆ° trong vÃ­ dá»¥ á»Ÿ trÃªn:\n  ten_decorator nháº­n vÃ o hÃ m f, sau Ä‘Ã³ bá»c hÃ m f trong hÃ m wrapper cá»§a nÃ³ vÃ  tráº£ vá» hÃ m wrapper. HÃ m wrapper cÃ³ nhiá»‡m vá»¥ gáº¯n thÃªm thÃ´ng tin vÃ o tÃªn rá»“i má»›i gá»i thá»±c hiá»‡n hÃ m f vá»›i chuá»—i má»›i.\n  Viá»‡c sá»­ dá»¥ng:\n1 2 3 4  @ten_decorator def xuat_ten(ten): print ten xuat_ten(\u0026#39;coulson\u0026#39;)   TÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i:\n1 2 3 4  def xuat_ten(ten): print ten ham_xuat_ten_moi = ten_decorator(xuat_ten) ham_xuat_ten_moi(\u0026#39;coulson\u0026#39;)     RÃµ rÃ ng vá»›i viá»‡c sá»­ dá»¥ng cÃº phÃ¡p decorator thÃ¬ code sáº½ ngáº¯n gá»n vÃ  Ä‘Æ¡n giáº£n hÆ¡n. Developer khÃ´ng pháº£i gá»i decorator má»—i láº§n sá»­ dá»¥ng mÃ  trÃ¬nh thÃ´ng dá»‹ch sáº½ lÃ m viá»‡c Ä‘Ã³.\n  Äá»‘i vá»›i hÃ m sá»­ dá»¥ng nhiá»u decorator\nVÃ­ dá»¥ 2\n1 2 3 4 5  @ten_decorator1 @ten_decorator2 @ten_decorator3 def xuat_ten(ten): print ten    Decorator nÃ o cÃ ng á»Ÿ trÃªn, xa function thÃ¬ sáº½ bá»c lá»›p ngoÃ i Giá»‘ng nhÆ° khi báº¡n bá»c trÃ¡i xoÃ i vÃ o trong bá»‹, rá»“i láº¡i láº¥y cÃ¡i bá»‹ khÃ¡c Ä‘á»ƒ bá»c bÃªn ngoÃ i ná»¯a. Thá»© tá»± thá»±c thi code: - Code cá»§a decorator Ä‘Æ°á»£c thá»±c thi ngay lÃºc file nguá»“n Python Ä‘Æ°á»£c load lÃªn. Ngoáº¡i trá»« code trong hÃ m wrapper cá»§a decorator trong cÃ¹ng sáº½ Ä‘Æ°á»£c thá»±c thi lÃºc gá»i hÃ m. - Decorator Ä‘Æ°á»£c gá»i thá»±c thi theo thá»© tá»± tá»« trong (gáº§n hÃ m nháº¥t) ra ngoÃ i.  6 Truyá»n tham sá»‘ cho decorator  á» trÃªn, Ä‘á»ƒ cho Ä‘Æ¡n giáº£n, vÃ  dá»… hiá»ƒu thÃ¬ decorator lÃ  má»™t hÃ m cÃ³ tham sá»‘ lÃ  má»™t hÃ m khÃ¡c. NhÆ°ng Ä‘iá»u Ä‘Ã³ khÃ´ng báº¯t buá»™c, decorator cÅ©ng cÃ³ thá»ƒ lÃ  má»™t hÃ m nháº­n vÃ o tham sá»‘ báº¥t ká»³ vÃ  tráº£ vá» má»™t hÃ m vÃ  hÃ m tráº£ vá» nÃ y nháº­n vÃ o tham sá»‘ lÃ  má»™t hÃ m khÃ¡c.\n VÃ­ dá»¥ 3: thÃªm chá»©c danh vÃ o chuá»—i xuáº¥t ra mÃ¬nh cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a decorator nhÆ° sau:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  def chuc_danh_decorator(ten_chuc_danh): def ten_decorator(f): def wrapper(ten): chuoi_moi = \u0026#34;Xin gioi thieu %s%s\u0026#34; % (ten_chuc_danh, ten) return f(chuoi_moi) return wrapper return ten_decorator @chuc_danh_decorator(\u0026#34;Giao su\u0026#34;) def gioi_thieu(ten): print ten @chuc_danh_decorator(\u0026#34;Tien si\u0026#34;) def gioi_thieu_2(ten): print ten gioi_thieu(\u0026#34;Teo\u0026#34;) gioi_thieu_2(\u0026#34;Ti\u0026#34;) \u0026gt;\u0026gt; Xin gioi thieu Giao su Teo \u0026gt;\u0026gt; Xin gioi thieu Tien si Ti   Sá»± khÃ¡c biá»‡t:\n HÃ m decorator bÃ¢y giá» khÃ´ng pháº£i nháº­n vÃ o tham sá»‘ lÃ  má»™t hÃ m mÃ  cÃ³ thá»ƒ lÃ  tham sá»‘ báº¥t ká»³. HÃ m tráº£ vá» tá»« decorator nháº­n vÃ o má»™t hÃ m vÃ  chÃ­nh nÃ³ má»›i tráº£ vá» hÃ m wrapper CÃ¡ch sá»­ dá»¥ng decorator cÅ©ng khÃ¡c má»™t chÃºt. Decorator Ä‘Æ°á»£c gá»i cháº¡y ( dÃ¹ng dáº¥u () ) vÃ  truyá»n vÃ o tham sá»‘.  NÃ³ cháº¡y nhÆ° tháº¿ nÃ o:\n Trong vÃ­ dá»¥ 3 decorator Ä‘Æ°á»£c sá»­ dá»¥ng @chuc_danh_decorator(\u0026quot;Giao su\u0026quot;). ChÃº Ã½ dáº¥u (\u0026hellip;), decorator Ä‘Æ°á»£c gá»i thá»±c thi vÃ  nÃ³ tráº£ vá» hÃ m ten_decorator vÃ  chÃ­nh nÃ³ sáº½ bá»c hÃ m Ä‘Æ°á»£c decorate. HÃ m chuc_danh_decorator chá»‰ cÃ³ tÃ¡c dá»¥ng lÃ  dÃ¹ng Ä‘á»ƒ truyá»n tham sá»‘ vÃ o decorator.  7. Debug hÃ m decorator. Khi sá»­ dá»¥ng decorator thÃ¬ hÃ m thá»±c sá»± Ä‘Æ°á»£c gá»i lÃ  hÃ m wrapper cá»§a tráº£ vá» tá»« decorator. NÃªn cÃ¡c thuá»™c tÃ­nh __name__, __doc__, __module__ khÃ´ng cÃ²n lÃ  cá»§a hÃ m Ä‘Æ°á»£c decorate ná»¯a mÃ  lÃ  cá»§a wrapper\nSá»­ dá»¥ng láº¡i code trong vÃ­ dá»¥ 1:\n1 2 3  print xuat_ten.__name__ \u0026gt;\u0026gt; wrapper   Kháº¯c phá»¥c: sá»­ dá»¥ng thÆ° viá»‡n functools VÃ­ dá»¥ 4:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  from functools import wraps def ten_decorator(f): @wraps(f) def wrapper(ten): chuoi_moi = \u0026#34;Ten tui la %s\u0026#34; % ten return f(chuoi_moi) return wrapper def xuat_ten( ten ): print ten print xuat_ten.__name__ \u0026gt;\u0026gt; xuat_ten   Decorator wraps sáº½ láº¥y cÃ¡c thuá»™c tÃ­nh __name__, __doc__, __module__ cá»§a hÃ m Ä‘Æ°á»£c decorate vÃ  gÃ¡n cho hÃ m wrapper nÃªn khi láº¥y nhá»¯ng thuá»™c tÃ­nh nÃ y sáº½ tráº£ vá» thÃ´ng tin Ä‘Ãºng.\n8. Khi nÃ o nÃªn sá»­ dá»¥ng decorator? Tham kháº£o trang Wiki cá»§a Python\n","date":"21","image":null,"permalink":"http://bluzky.github.io/blog/2018-01-21-python-decorator/","tags":["python","python-basic"],"title":"Python decorator lÃ  gÃ¬? dÃ¹ng khi nÃ o"},{"categories":null,"contents":"Thá»±c sá»± thÃ¬ khÃ´ng nháº¥t thiáº¿t pháº£i lÃ  *args vÃ  **kwargs. Ä‘iá»u quan trá»ng lÃ  tham sá»‘ cÃ³ 1 dáº¥u sao * hay lÃ  2 dáº¥u sao **. Äáº·t tÃªn tham sá»‘ lÃ  *var hay **vars hay báº¥t cá»© thá»© gÃ¬ báº¡n muá»‘n. NhÆ°ng Ä‘á»ƒ dá»… hiá»ƒu thÃ¬ nÃªn dÃ¹ng tÃªn chuáº©n lÃ  *args vÃ  **kwargs\n1. *args vÃ  **kwargs dÃ¹ng Ä‘á»ƒ lÃ m gÃ¬?  Khi khai bÃ¡o 1 hÃ m, sá»­ dá»¥ng *args vÃ  **kwargs cho phÃ©p báº¡n truyá»n vÃ o bao nhiÃªu tham sá»‘ cÅ©ng Ä‘Æ°á»£c mÃ  khÃ´ng cáº§n biáº¿t trÆ°á»›c sá»‘ lÆ°á»£ng. VÃ­ dá»¥  1 2 3 4 5 6 7 8 9 10  # vá»›i giáº£ sá»­ cÃ¡c tham sá»‘ truyá»n vÃ o Ä‘á»u lÃ  sá»‘ def sum(*args): total = 0 for number in args: total += number return total # gá»i hÃ m sum(1, 2, 3,19) sum( 1, 100)   2. *args vÃ  **kwargs khÃ¡c gÃ¬ nhau?  Cho nhá»¯ng báº¡n chÆ°a biÃªt: Khi gá»i hÃ m trong Python, cÃ³ 2 kiá»ƒu truyá»n tham sá»‘:  Truyá»n tham sá»‘ theo tÃªn. Truyá»n tham sá»‘ bÃ¬nh thÆ°á»ng theo thá»© tá»± khai bÃ¡o Ä‘á»‘i sá»‘. VÃ­ dá»¥  1 2 3 4 5 6  def register(name, password): .... # Truyá»n tham sá»‘ theo kiá»ƒu thÃ´ng thÆ°á»ng, pháº£i theo Ä‘Ãºng thá»© tá»± register( \u0026#39;Coulson\u0026#39;, \u0026#39;hail_Hydra\u0026#39;) # Truyá»n tham sá»‘ theo tÃªn, KhÃ´ng cáº§n pháº£i theo thá»© tá»± khai bÃ¡o thao sá»‘ register( password=\u0026#39;cookHim\u0026#39;, name=\u0026#39;Skye\u0026#39;)    *args nháº­n cÃ¡c tham sá»‘ truyá»n bÃ¬nh thÆ°á»ng. Sá»­ dá»¥ng args nhÆ° má»™t list. **kwargs nháº­n tham sá»‘ truyá»n theo tÃªn. Sá»­ dá»¥ng **kwargs** nhÆ° má»™t. dictionary  VÃ­ dá»¥\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  def test_args(*args): for item in args: print item \u0026gt;\u0026gt;test_args(\u0026#39;Hello\u0026#39;, \u0026#39;world!\u0026#39;) Hello world! def test_kwargs(*kwargs): for key, value in kwargs.iteritems(): print \u0026#39;{0}= {1}\u0026#39;.format(key, value) \u0026gt;\u0026gt;test_kwargs(name=\u0026#39;Dzung\u0026#39;, age=10) age = 10 name = Dzung   3. Thá»© tá»± sá»­ dá»¥ng vÃ  truyá»n tham sá»‘ *args, **kwargs vÃ  tham sá»‘ bÃ¬nh thÆ°á»ng Khi sá»­ dá»¥ng pháº£i khai bÃ¡o Ä‘á»‘i sá»‘ theo thá»© tá»±:\n **Ä‘á»‘i sá»‘ xÃ¡c Ä‘inh \u0026ndash;\u0026gt; *args \u0026ndash;\u0026gt; **kwargs**\n ÄÃ¢y lÃ  thá»© tá»± báº¯t buá»™c. VÃ  khi truyá»n tham sá»‘ báº¡n cÅ©ng pháº£i truyá»n theo Ä‘Ãºng thá»© tá»± nÃ y. KhÃ´ng thá»ƒ truyá»n láº«n lá»™n giá»¯a 2 loáº¡i.\n Khi sá»­ dá»¥ng Ä‘á»“ng thá»i *args **kwargs thÃ¬ khÃ´ng thá»ƒ truyá»n tham sá»‘ bÃ¬nh thÆ°á»ng theo tÃªn\n VÃ­ dá»¥\n1 2 3 4 5 6 7 8 9 10 11  def show_detail(name, *args, **kwargs): ..... show_detail(name=\u0026#39;Coulson\u0026#39;, \u0026#39;agent\u0026#39;, age=\u0026#39;40\u0026#39;, level=\u0026#39;A\u0026#39;) \u0026gt;\u0026gt; Lá»—i def show_detail_2(name, **kwargs): .... show_detail_2(name=Coulson\u0026#39;, age=\u0026#39;40\u0026#39;, level=\u0026#39;A\u0026#39;) \u0026gt;\u0026gt; Cháº¡y Ok   ","date":"21","image":null,"permalink":"http://bluzky.github.io/blog/2018-01-21-truyen-tham-so-dong-python/","tags":["python","python-basic"],"title":"Truyá»n tham sá»‘ Ä‘á»™ng trong python (*args | **kwargs)?"},{"categories":null,"contents":"1. Oauthh 2 vÃ  cÃ¡c khÃ¡i niá»‡m 1.1 Oauth 2 lÃ  gÃ¬: Oauth 2 lÃ  báº£n nÃ¢ng cáº¥p cá»§a giao thá»©c chá»©ng thá»±c Oauth 1.0\n1.2 CÃ¡c Role (vai trÃ²) trong mÃ´ hÃ¬nh oauth  resource owner lÃ  Ä‘á»‘i tÆ°á»£ng cÃ³ kháº£ nÄƒng cáº¥p quyá»n truy cáº­p tá»›i tÃ i nguyÃªn (resource) Ä‘Æ°á»£c báº£o vá»‡ Resource server lÃ  má»™t server lÆ°u trá»¯ cÃ¡c tÃ i nguyÃªn, cÃ³ kháº£ nÄƒng xá»­ lÃ½ cÃ¡c yÃªu cáº§u truy cáº­p tá»›i tÃ i nguyÃªn Ä‘Æ°á»£c báº£o vá»‡. Client á»¨ng dá»¥ng muá»‘n truy cáº­p vÃ o protected resource vá»›i tÆ° cÃ¡ch cá»§a ngÆ°á»i sá»Ÿ há»¯u resource Authorization server lÃ  server chuyÃªn cáº¥p access token cho client sau khi resource owner Ä‘á»“ng Ã½ cáº¥p phÃ©p cho client truy xuáº¥t vÃ o resource Ä‘Æ°á»£c báº£o vá»‡  1.3 Luá»“ng xá»­ lÃ½ cá»§a giao thá»©c 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  +--------+ +---------------+ | |--(A)- Authorization Request -\u0026gt;| Resource | | | | Owner | | |\u0026lt;-(B)-- Authorization Grant ---| | | | +---------------+ | | | | +---------------+ | |--(C)-- Authorization Grant --\u0026gt;| Authorization | | Client | | Server | | |\u0026lt;-(D)----- Access Token -------| | | | +---------------+ | | | | +---------------+ | |--(E)----- Access Token ------\u0026gt;| Resource | | | | Server | | |\u0026lt;-(F)--- Protected Resource ---| | +--------+ +---------------+    (A) á»¨ng dá»¥ng client yÃªu cáº§u resource owner cáº¥p quyá»n (B) Client nháº­n Ä‘Æ°á»£c sá»± cáº¥p phÃ©p tá»« resource owner tÃ¹y theo loáº¡i grant trong yÃªu cáº§u. Náº¿u Ä‘Æ°á»£c chá»©ng thá»±c, client sáº½ Ä‘Æ°á»£c cáº¥p 1 authorization grant (C) Client yÃªu cáº§u Authorization server xÃ¡c thá»±c authorization grant tá»« resource owner. (D) Authorization server sáº½ kiá»ƒm tra vÃ  xÃ¡c nháº­n authorization grant. Náº¿u Ä‘Æ°á»£c xÃ¡c thá»±c, Client sáº½ nháº­n Ä‘Æ°á»£c access token (E) Client request resource tá»« resource server, dÃ­nh kÃ¨m access token trong request. (F)Resource Server sáº½ kiá»ƒm tra tÃ­nh há»£p lá»‡ cá»§a access token. Náº¿u token há»£p lá»‡, resource theo yÃªu cáº§u sáº½ Ä‘Æ°á»£c cáº¥p phÃ¡t.  1.4 Authorization Grant Authorization grant lÃ  má»™t chá»©ng nháº­n xÃ¡c Ä‘á»‹nh nhá»¯ng resource nÃ o Ä‘Ã£ Ä‘Æ°á»£c cáº¥p quyá»n truy cáº­p bá»Ÿi chá»§ sá»Ÿ há»¯u cá»§a resource. NÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi á»©ng dá»¥ng client Ä‘á»ƒ Ä‘á»•i láº¥y access token. CÃ³ 4 loáº¡i authorization grant:\n Authorization code Implicit Resource owner password credential Client credential  1.4.1 Authorization code Authorization code Ä‘Æ°á»£c cáº¥p phÃ¡t trong mÃ´ hÃ¬nh mÃ  server á»§y quyá»n Ä‘Ã³ng vai trÃ² trung gian giá»¯a client vÃ  resource owner. Client sáº½ chuyá»ƒn resource owner tá»›i server á»§y quyá»n. Sau khi resource owner Ä‘á»“ng Ã½, server á»§y quyá»n sáº½ tráº£ vá» cho clien authorization code\n1.4.2 Implicit Implicit grant lÃ  sá»± báº£n Ä‘Æ¡n giáº£n hÃ³a cá»§a Authorization code, thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng trÃªn cÃ¡c á»©ng dá»¥ng khÃ´ng cÃ³ kháº£ nÄƒng báº£o máº­t authorization grant. VÃ­ dá»¥ nhÆ° web browser hoáº·c á»©ng dá»¥ng mobile. Thay vÃ¬ táº¡o ra cÃ¡c authorization code, client Ä‘Æ°á»£c nháº­n trá»±c tiáº¿p access token. Do sá»± Ä‘Æ¡n giáº£n hÃ³a cá»§a nÃ³ nÃªn implicit grant dá»… bá»‹ táº¥n cÃ´ng, vÃ  cÃ¡c váº¥n Ä‘á» vá» báº£o máº­t.\n1.4.3 Resource Owner Password Credentials ÄÃ¢y lÃ  phÆ°Æ¡ng thá»©c xÃ¡c thá»±c trong Ä‘Ã³ á»©ng dá»¥ng clieownernt sáº½ dÃ¹ng username vÃ  password cá»§a ngÆ°á»i dÃ¹ng/ resource owner Ä‘á»ƒ xÃ¡c thá»±c vá»›i server á»§y quyá»n. Sau khi xÃ¡c thá»±c thÃ¬ server á»§y quyá»n sáº½ tráº£ vá» cho á»©ng dá»¥ng client access token vÃ  refresh token. Do Ä‘Ã³ á»©ng dá»¥ng client khÃ´ng cáº§n pháº£i lÆ°u thÃ´ng tin Ä‘Äƒng nháº­p cá»§a resource owner. Kiá»ƒu chá»©ng thá»±c nÃ y chá»‰ Ä‘Æ°á»£c sá»­ dá»¥ng trÃªn nhá»¯ng á»©ng dá»¥ng cá»§a Ä‘á»‘i tÃ¡c cÃ³ Ä‘á»™ tin cáº­y cao.\n1.4 CÃ¡c khÃ¡i niá»‡m khÃ¡c 1.4.1 Access token  Access token lÃ  nhá»¯ng chá»©ng nháº­n dÃ¹ng Ä‘á»ƒ truy cáº­p vÃ o nhá»¯ng tÃ i nguyÃªn Ä‘Æ°á»£c báº£o vá»‡. Access token lÃ  má»™t chuá»—i kÃ½ tá»±, chá»©a thÃ´ng tin vá» chá»©ng nháº­n Ä‘Æ°á»£c cáº¥p cho á»©ng dá»¥ng client nhÆ°: thá»i gian háº¿t háº¡n, pháº¡m vi tÃ i nguyÃªn Ä‘Æ°á»£c sá»­ dá»¥ng \u0026hellip;. Access token cÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ Ä‘á»‹nh danh ngÆ°á»i dÃ¹ng. nÃ³ dÃ¹ng Ä‘á»ƒ láº¥y thÃ´ng tin cá»§a resource owner hoáº·c báº£n thÃ¢n nÃ³ chá»©a thÃ´ng tin cá»§a resource owner. Access token giÃºp cho viá»‡c xÃ¡c thá»±c Ä‘Æ¡n giáº£n hÆ¡n. 4 cÃ¡ch yÃªu cáº§u cáº¥p quyá»n tá»« resource owner Ä‘á»u táº¡o ra access token do Ä‘Ã³ resource server khÃ´ng cáº§n pháº£i biáº¿t phÆ°Æ¡ng thá»©c chá»©ng thá»±c nÃ o Ä‘Æ°á»£c sá»­ dá»¥ng. NÃ³ chá»‰ cáº§n biáº¿t sá»­ dá»¥ng access token lÃ  Ä‘á»§.  1.4.2 Refresh token  Refresh token lÃ  chá»©ng chá»‰ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ trao Ä‘á»•i láº¥y access token. NÃ³ Ä‘Æ°á»£c tráº£ vá» cÃ¹ng vá»›i authorization grant, vÃ  Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ yÃªu cáº§u cáº¥p má»›i access token khi access token hiá»‡n táº¡i háº¿t háº¡n. Refresh token Ä‘Æ°á»£c sá»­ dá»¥ng vá»›i server á»§y quyá»n, khÃ´ng sá»­ dá»¥ng vá»›i resource server.  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  +--------+ +---------------+ | |--(A)------- Authorization Grant ---------\u0026gt;| | | | | | | |\u0026lt;-(B)----------- Access Token -------------| | | | \u0026amp; Refresh Token | | | | | | | | +----------+ | | | |--(C)---- Access Token ----\u0026gt;| | | | | | | | | | | |\u0026lt;-(D)- Protected Resource --| Resource | | Authorization | | Client | | Server | | Server | | |--(E)---- Access Token ----\u0026gt;| | | | | | | | | | | |\u0026lt;-(F)- Invalid Token Error -| | | | | | +----------+ | | | | | | | |--(G)----------- Refresh Token -----------\u0026gt;| | | | | | | |\u0026lt;-(H)----------- Access Token -------------| | +--------+ \u0026amp; Optional Refresh Token +---------------+   Figure 2: Refreshing an Expired Access Token\n (A) Client gá»­i authorization grant vÃ  yÃªu cáº§u server á»§y quyá»n cáº¥p access tocken vÃ  refresh token (B) server á»§y quyá»n xÃ¡c thá»±c client vÃ  authorization grant. Náº¿u há»£p lá»‡, nÃ³ sáº½ táº¡o ra access token vÃ  refresh token vÃ  tráº£ vá» cho client (C) Client yÃªu cáº§u truy xuáº¥t tá»›i resource Ä‘Æ°á»£c báº£o vá»‡ sá»­ dá»¥ng access token (D) Resource server kiá»ƒm tra access token, náº¿u há»£p lá»‡, thá»±c hiá»‡n yÃªu cáº§u tá»« client. (E) bÆ°á»›c (C) vÃ  (D) Ä‘Æ°á»£c láº·p láº¡i cho tá»›i khi access token háº¿t háº¡n. Náº¿u client biáº¿t access token háº¿t háº¡n, nÃ³ sáº½ chá»§ Ä‘á»™ng chuyá»ƒn qua bÆ°á»›c (G), náº¿u khÃ´ng nÃ³ sáº½ gá»­i request má»›i. (F) PhÃ¡t hiá»‡n access token háº¿t háº¡n, resource server tráº£ vá» lá»—i access token khÃ´ng há»£p lá»‡. (G) Client gá»­i refresh token lÃªn server á»§y quyá»n vÃ  yÃªu cáº§u cáº¥p phÃ¡t access token má»›i. (H) server á»§y quyá»n kiá»ƒm tra thÃ´ng tin client vÃ  refresh token, náº¿u há»£p lá»‡, nÃ³ sáº½ cáº¥p phÃ¡t access token vÃ  cÃ³ thá»ƒ lÃ  cáº£ refresh token má»›i  2. ÄÄƒng kÃ½ client  TrÆ°á»›c khi cÃ³ thá»ƒ sá»­ dá»¥ng giao thá»©c oauth 2, client pháº£i Ä‘Äƒng kÃ½ vá»›i server á»§y quyá»n. Viá»‡c Ä‘Äƒng kÃ½ tÃ¹y thuá»™c vÃ o server ThÃ´ng tin Ä‘Äƒng kÃ½ cÃ³ thá»ƒ bao gá»“m:\n Loáº¡i client redirection URI Má»™t sá»‘ thÃ´ng tin khÃ¡c: mÃ´ táº£, tÃªn á»©ng dá»¥ng \u0026hellip;.   2.1 Loáº¡i Client Oauth Ä‘á»‹nh nghÄ©a 2 loáº¡i client:\n confidential(bÃ­ máº­t): client cÃ³ kháº£ nÄƒng lÆ°u trá»¯ vÃ  báº£o máº­t cÃ¡c chá»©ng nháº­n Ä‘Æ°á»£c cáº¥p. public (cÃ´ng khai): client khÃ´ng thá»ƒ báº£o vá»‡ cÃ¡c chá»­ng nháº­n Ä‘Æ°á»£c cáº¥p má»™t cÃ¡ch bÃ­ máº­t.  Viá»‡c phÃ¢n loáº¡i nÃ y dá»±a trÃªn cÃ¡c loáº¡i á»©ng dá»¥ng sau:\n á»¨ng dá»¥ng web: lÃ  má»™t loáº¡i client bÃ­ máº­t(confidential) cháº¡y trÃªn web server. Resource owner truy cáº­p tá»›i á»©ng dá»¥ng web thÃ´ng qua browser. CÃ¡c chá»©ng nháº­n Ä‘Æ°á»£c cáº¥p cÅ©ng nhÆ° access token Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn server vÃ  resource owner khÃ´ng thá»ƒ Ä‘á»c nhá»¯ng thÃ´ng tin nÃ y. á»¨ng dá»¥ng trÃªn ná»n browser: lÃ  loáº¡i public client trong Ä‘Ã³ code cá»§a á»©ng dá»¥ng client Ä‘Æ°á»£c táº£i vá» vÃ  cháº¡y trÃªn thiáº¿t bá»‹ cá»§a ngÆ°á»i dÃ¹ng. CÃ¡c chá»©ng nháº­n, access token cÃ³ thá»ƒ dá»… dÃ ng truy cáº­p bá»Ÿi ngÆ°á»i sá»­ dá»¥ng. á»¨ng dá»¥ng native: lÃ  má»™t dáº¡ng public client, Ä‘Æ°á»£c cÃ i vÃ  thá»±c thi trÃªn thiáº¿t bá»‹ cá»§a ngÆ°á»i dÃ¹ng. CÃ¡c dá»¯ liá»‡u cá»§a giao thá»©c vÃ  cÃ¡c dá»¯ liá»‡u bÃ­ máº­t nhÆ° access token cÃ³ thá»ƒ Ä‘Æ°á»£c truy xuáº¥t bá»Ÿi ngÆ°á»i dÃ¹ng vá»›i giáº£ sá»­ ráº±ng á»©ng dá»¥ng cÃ³ thá»ƒ bá»‹ tÃ¡ch ra(extracted). Tuy nhiÃªn á»©ng dá»¥ng cÃ³ thá»ƒ Ä‘á»‹nh nghÄ©a má»™t sá»‘ phÆ°Æ¡ng thá»©c báº£o vá»‡ cÃ¡c thÃ´ng tin bÃ­ máº­t cá»§a giao thá»©c. TÃ¹y vÃ o ná»n táº£ng(platform) cÃ¡c thÃ´ng tin nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c báº£o vá»‡ trÃ¡nh sá»± truy xuáº¥t cá»§a cÃ¡c á»©ng dá»¥ng khÃ¡c trÃªn cÃ¹ng thiáº¿t bá»‹.  2.2 Äá»‹nh danh client (client identifier) Vá»›i má»—i client Ä‘Äƒng kÃ½, server á»§y quyá»n sáº½ táº¡o ra má»™t chuá»—i duy nháº¥t Ä‘á»ƒ xÃ¡c Ä‘á»‹nh client Ä‘Ã³(Ä‘Æ°á»£c gá»i lÃ  client identifier). Client identifier Ä‘Æ°á»£c cÃ´ng khai, Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ server á»§y quyá»n kiá»ƒm tra liá»‡u client cÃ³ há»£p lá»‡ hay khÃ´ng.\n2.3 Chá»©ng thá»±c client Äá»‘i vá»›i loai client bÃ­ máº­t(confidential), client vÃ  server á»§y quyá»n thiáº¿t láº­p má»™t phÆ°Æ¡ng phÃ¡p phÃ¹ há»£p Ä‘á»ƒ xÃ¡c thá»±c client. PhÆ°Æ¡ng thá»©c xÃ¡c thá»±c nÃ y lÃ  tÃ¹y vÃ o client vÃ  server\n2.4 Máº­t kháº©u cá»§a client  Náº¿u client sá»­ dá»¥ng password. NÃ³ cÃ³ thá»ƒ dÃ¹ng mÃ´ hÃ¬nh chá»©ng thá»±c cung cáº¥p bá»Ÿi giao thá»©c HTTP(RFC2617). Äá»‹nh danh cá»§a client Ä‘Æ°á»£c mÃ£ hÃ³a sá»­ dá»¥ng thuáº­t toÃ¡n \u0026ldquo;application/x-www-form-urlencoded\u0026rdquo;. GiÃ¡ trá»‹ sau khi mÃ£ hÃ³a Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° máº­t kháº©u cá»§a client. server á»§y quyá»n pháº£i há»— trá»£ mÃ´ hÃ¬nh chá»©ng thá»±c cá»§a giao thá»©c HTTP. Má»™t cÃ¡ch khÃ¡c, server á»§y quyá»n cÃ³ thá»ƒ há»— trá»£ viá»‡c gá»­i thÃ´ng tin cá»§a client trong thÃ¢n cá»§a request( request-body) vá»›i cÃ¡c tham sá»‘: - client_id [REQUIRED]: Ä‘á»‹nh danh cá»§a client - client_secret [REQUIRED]: chuá»—i bÃ­ máº­t cá»§a client\nVÃ­ dá»¥:  POST /token HTTP/1.1 Host: server.example.com Content-Type: application/x-www-form-urlencoded grant_type=refresh_token\u0026amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA \u0026amp;client_id=s6BhdRkqt3\u0026amp;client_secret=7Fjfp0ZBr1KtDRbnfVdmIw  PhÆ°Æ¡ng phÃ¡p gá»­i thÃ´ng tin client qua request-body khÃ´ng Ä‘Æ°á»£c khuyáº¿n khÃ­ch sá»­ dá»¥ng. Bá»Ÿi vÃ¬ nÃ³ dá»… bá»‹ táº¥n cÃ´ng hÆ¡n so vá»›i phÆ°Æ¡ng phÃ¡p Ä‘áº§u tiÃªn.\n 3. CÃ¡c Ä‘iá»ƒm cuá»‘i cá»§a giao thá»©c (Protocol Endpoint) Tiáº¿n trÃ¬nh chá»©ng thá»±c trÃªn server cÃ³ 2 Ä‘iá»ƒm cuá»‘i(endpoint)\n Authorization endpoint : Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi client Ä‘á»ƒ yÃªu cáº§u sá»± xÃ¡c nháº­n tá»« resource owner thÃ´ng qua user-agent(thÆ°á»ng lÃ  browser). Token endpoint: Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi client Ä‘á»ƒ trao Ä‘á»•i authorization grant láº¥y access token.  PhÃ­a client chá»‰ cÃ³ 1 Ä‘iá»ƒm cuá»‘i:\n Redirection endpoint: lÃ  Ä‘iá»ƒm mÃ  server á»§y quyá»n dÃ¹ng Ä‘á»ƒ tráº£ vá» thÃ´ng tin cho client thÃ´ng qua user-agent(thÆ°á»ng lÃ  browser) cá»§a resource owner   KhÃ´ng pháº£i táº¥t cáº£ cÃ¡c kiá»ƒu chá»©ng thá»±c Ä‘á»u táº¡o ra 2 endpoint. Má»™t sá»‘ kiá»ƒu chá»©ng thá»±c má»Ÿ rá»™ng cÃ³ thá»ƒ táº¡o ra cÃ¡c endpoint khÃ¡c\n 3.1 Authorization Endpoint(sÆ¡ lÆ°á»£c) Authorization endpoint Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i resource owner, yÃªu cáº§u sá»± cáº¥p quyá»n tá»« resource owner. server á»§y quyá»n trÆ°á»›c tiÃªn pháº£i xÃ¡c thá»±c resource owner.\n3.1.1 Response type (kiá»ƒu tráº£ vá») Äá»‘i vá»›i trÆ°á»ng há»£p authorization endpoint Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi authorization code vÃ  implicit grant, client thÃ´ng bÃ¡o vá»›i server á»§y quyá»n kiá»ƒu cáº¥p quyá»n sá»­ dá»¥ng tham sá»‘: response_type [REQUIRED] cÃ³ thá»ƒ lÃ  má»™t trong 2 giÃ¡ trá»‹ sau:\n code \u0026ndash;\u0026gt; yÃªu cáº§u sá»­ dá»¥ng kiá»ƒu authorization code token \u0026ndash;\u0026gt; yÃªu cáº§u cáº¥p phÃ¡t access token (sá»­ dá»¥ng cho implicit)  cÃ³ thá»ƒ má»Ÿ rá»™ng response_type tÃ¹y nhu cáº§u. CÃ³ thá»ƒ cÃ¹ng lÃºc request nhiá»u response_type; cÃ¡c gÃ­a trá»‹ pháº£i cÃ¡ch nhau báº±ng khoáº£ng tráº¯ng.\n3.2 Redirection Endpoint (sÆ¡ lÆ°á»£c)  Sau khi yÃªu cáº§u cáº¥p quyá»n xong, server á»§y quyá»n chuyá»ƒn hÆ°á»›ng user-agent vÃ o redirection URI lÃºc Ä‘Äƒng kÃ½ client. Request nÃ y chá»©a cÃ¡c thÃ´ng tin vá» chá»©ng chá»‰ Ä‘Ã£ Ä‘Æ°á»£c cáº¥p phÃ¡t cho client. Má»™t client cÃ³ thá»ƒ Ä‘Äƒng kÃ½ nhiá»u redirection URI. Náº¿u khÃ´ng cÃ³ URI nÃ o Ä‘Æ°á»£c Ä‘Äƒng kÃ½ thÃ¬ ráº¥t dá»… bá»‹ táº¥n cÃ´ng. Náº¿u nhiá»u URI Ä‘Æ°á»£c Ä‘Äƒng kÃ½, thÃ¬ lÃºc yÃªu cáº§u chá»©ng thá»±c, client pháº£i gá»­i kÃ¨m tham sá»‘ redirect_uri. server á»§y quyá»n sáº½ tÃ¬m URI giá»‘ng vá»›i trong request Ä‘á»ƒ tráº£ vá» cÃ¡c chá»©ng nháº­n  3.3 Token endpoint (sÆ¡ lÆ°á»£c) Token endpoint Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi client, lÃ  nÆ¡i xÃ¡c thá»±c authorization grant vÃ  tráº£ vÃª access token vÃ  refresh token cho client.\n3.4 Pháº¡m vi(scope) cá»§a access token  Authorization endpoint vÃ  Token endpoint cho phÃ©p client xÃ¡c Ä‘á»‹nh pháº¡m vi/ giá»›i háº¡n truy xuáº¥t cá»§a request thÃ´ng qua tham sá»‘ scope. Sau khi Ä‘Æ°á»£c cáº¥p quyá»n, authorization server sá»­ dá»¥ng scope Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c giá»›i háº¡n/ pháº¡m vi Ä‘Æ°á»£c quyá»n truy cáº­p Ä‘á»‘i vá»›i access token Ä‘Æ°á»£c tráº£ vá». Scope Ä‘Æ°á»£c thá»ƒ hiá»‡n dÆ°á»›i dáº¡ng má»™t chuá»—i gá»“m nhiá»u scope cÃ¡ch nhau báº±ng khoáº£ng tráº¯ng. Náº¿u scope cá»§a access token Ä‘Æ°á»£c cáº¥p phÃ¡t giá»‘ng vá»›i scope trong request cá»§a client thÃ¬ server cÃ³ thá»ƒ bá» qua tham sá»‘ scope trong response. Náº¿u scope khÃ¡c vá»›i trong request thÃ¬ báº¯t buá»™c pháº£i tráº£ vá» tham sá»‘ scope trong response.  4. Láº¥y á»§y quyá»n (Obtain authorization) Äá»ƒ yÃªu cáº§u má»™t access token, client cáº§n pháº£i nháº­n Ä‘Æ°á»£c sá»± á»§y quyá»n tá»« resource owner. Sá»± á»§y quyá»n Ä‘Æ°á»£c thá»ƒ hiá»‡n dÆ°á»›i dáº¡ng authorization grant. Client sá»­ dá»¥ng nÃ³ Ä‘á»ƒ yÃªu cáº§u láº¥y má»™t access token. CÃ³ 4 loáº¡i cáº¥p quyá»n: authorization code, implicit, resource owner password credentials, vÃ  client credentials.\n4.1 Cáº¥p quyá»n sá»­ dá»¥ng code thay tháº¿ cho á»§y quyá»n (Athorization code grant)  Kiá»ƒu nÃ y sá»­ dá»¥ng Ä‘á»ƒ yÃªu cáº§u cáº£ access token vÃ  refresh token, thÆ°á»ng dÃ¹ng vá»›i confidential client. Kiá»ƒu cáº¥p quyá»n nÃ y dá»±a trÃªn redirection (chuyá»ƒn hÆ°á»›ng) nÃªn client pháº£i cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i user-agent (browser) cÃ  nháº­n request thÃ´ng qua redirection tá»« server á»§y quyá»n. SÆ¡ Ä‘á»“:   +----------+ | Resource | | Owner | | | +----------+ ^ | (B) +----|-----+ Client Identifier +---------------+ | -+----(A)-- \u0026amp; Redirection URI ----\u0026gt;| | | User- | | Authorization | | Agent -+----(B)-- User authenticates ---\u0026gt;| Server | | | | | | -+----(C)-- Authorization Code ---\u0026lt;| | +-|----|---+ +---------------+ | | ^ v (A) (C) | | | | | | ^ v | | +---------+ | | | |\u0026gt;---(D)-- Authorization Code ---------' | | Client | \u0026amp; Redirection URI | | | | | |\u0026lt;---(E)----- Access Token -------------------' +---------+ (w/ Optional Refresh Token) Note: CÃ¡c Ä‘Æ°á»ng tháº³ng minh hoáº¡ bÆ°á»›c (A), (B), vÃ  (C) Ä‘Æ°á»£c chia thÃ nh 2 pháº§n bá»Ÿi vÃ¬ chÃºng Ä‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua user agent Figure 3: QuÃ¡ trÃ¬nh cáº¥p code á»§y quyá»n  (A)client khá»Ÿi táº¡o luá»“ng xá»­ lÃ½ báº±ng viá»‡c chuyá»ƒn hÆ°á»›ng user-agent(browser) cá»§a resource owner tá»›i authorizatio endpoint. Client gá»­i kÃ¨m theo Ä‘á»‹nh danh cá»§a nÃ³ Ä‘Æ°á»£c server á»§y quyá»n cáº¥p, pháº¡m vi quyá»n háº¡n (scope), redirection URI. (B)Server á»§y quyá»n sáº½ xÃ¡c thá»±c resource owner (yÃªu cáº§u Ä‘Äƒng nháº­p) vÃ  yÃªu cáº§u resource owner quyáº¿t Ä‘á»‹nh Ä‘á»“ng Ã½ hay tá»« chá»‘i yÃªu cáº§u cáº¥p quyá»n. (C) Giáº£ sá»­ resource owner Ä‘á»“ng Ã½ cáº¥p quyá»n, server á»§y quyá»n sáº½ chuyá»ƒn hÆ°á»›ng user-agent Ä‘áº¿n clien sá»­ dá»¥ng redirection URI, kÃ¨m theo Ä‘Ã³ lÃ  auhthorization code (code xÃ¡c nháº­n á»§y quyá»n). (D) Client yÃªu cáº§u cáº¥p access token tá»›i server á»§y quyá»n, kÃ¨m theo Ä‘Ã³ lÃ  authorization code tá»« bÆ°á»›c (C) váº£ redirection URI. (E) Server á»§y quyá»n xÃ¡c thá»±c client, kiá»ƒm tra sá»± há»£p lá»‡ cá»§a authorization code vÃ  redirection URI. Náº¿u táº¥t cáº£ Ä‘á»u há»£p lá»‡, server xÃ¡c thá»±c sáº½ tráº£ vá» cho client access token vÃ  cÃ³ thá»ƒ gá»“m refresh token.  4.1.1 YÃªu cáº§u á»§y quyá»n (Authorization request) Client táº¡o 1 request vá»›i cÃ¡c tham sá»‘ sau, sá»­ dá»¥ng Ä‘á»‹nh dáº¡ng application/x-www-form-urlencoded\n response_type [REQUIRED] pháº£i cÃ³ giÃ¡ trá»‹ lÃ  code client_id [REQUIRED] Ä‘á»‹nh danh cá»§a client, Ä‘Æ°á»£c nÃ³i trong pháº§n 2 redirect_uri [OPTIONAL] url chuyá»ƒn hÆ°á»›ng Ä‘áº¿n sau khi Ä‘Æ°á»£c á»§y quyá»n scope [OPTIONAL] giá»›i háº¡n/pháº¡m vi cá»§a request Ä‘Æ°á»£c á»§y quyá»n. Trong pháº§n 3.4 state [RECOMMENDED]. Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi client Ä‘á»ƒ truyá»n thÃ´ng tin tráº¡ng thÃ¡i tá»« request vÃ  callback. Server á»§y quyá»n sáº½ gá»­i kÃ¨m state khi chuyá»ƒn hÆ°á»›ng tá»›i redirec URI. state nÃªn Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ ngÄƒn cháº·n kiá»ƒu táº¥n cÃ´ng cross-site request forgery. VÃ­ dá»¥  GET /authorize?response_type=code\u0026amp;client_id=s6BhdRkqt3\u0026amp;state=xyz \u0026amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1 Host: server.example.com 4.1.2 Káº¿t quáº£ náº¿u thÃ nh cÃ´ng (Authorization response) Náº¿u resource server Ä‘á»“ng Ã½ cáº¥p quyá»n truy cáº­p, server á»§y quyá»n sáº½ sinh ra má»™t code xÃ¡c nháº­n á»§y quyá»n (authorization code) vÃ  tráº£ vá» cho client thÃ´ng qua redirection URI vá»›i cÃ¡c tham sá»‘ sau:\n code [REQUIRED] code á»§y quyá»n Ä‘Æ°á»£c sinh ra bá»Ÿi server á»§y quyá»n. NÃ³ pháº£i háº¿t háº¡n trong khoáº£ng thá»i gian ngáº¯n, khuyáº¿n khÃ­ch tá»‘i Ä‘a lÃ  10 phÃºt Ä‘á»ƒ trÃ¡nh bá»‹ rÃ² rá»‰. clien chá»‰ Ä‘Æ°á»£c sá»­ dá»¥ng authorization code 1 láº§n. Náº¿u nhiá»u hÆ¡n 1 láº§n thÃ¬ server á»§y quyá»n pháº£i tá»« chá»‘i vÃ  nÃªn há»§y bá» cÃ¡c access token Ä‘Ã£ cáº¥p sá»­ dá»¥ng authorization code Ä‘Ã³ ngay khi cÃ³ thá»ƒ. state [REQUIRED] náº¿u tham sá»‘ state Ä‘Æ°á»£c gá»­i Ä‘i trong authorization request thÃ¬ nÃ³ sáº½ Ä‘Æ°á»£c nháº­n láº¡i nguyÃªn váº¹n á»Ÿ client. VÃ­ dá»¥  HTTP/1.1 302 Found Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA \u0026amp;state=xyz Client pháº£i bá» qua táº¥t cáº£ cÃ¡c tham sá»‘ khÃ¡c náº¿u cÃ³.\n4.1.3 Káº¿t quáº£ tráº£ vá» náº¿u bá»‹ lá»—i (Error response) Náº¿u yÃªu cáº§u á»§y quyá»n tháº¥t báº¡i, server á»§y quyá»n pháº£i thÃ´ng bÃ¡o cho client biáº¿t lÃ½ do vÃ  khÃ´ng Ä‘Æ°á»£c tá»± Ä‘á»™ng chuyá»ƒn hÆ°á»›ng qua redirection URI khÃ´ng há»£p lá»‡. Lá»—i nÃªn Ä‘Æ°á»£c tráº£ vá» thÃ´ng qua redirection URI vá»›i cÃ¡c tham sá»‘ sau:\n error [REQUIRED] má»™t chuá»—i kÃ½ tá»± ASCII trong cÃ¡c lá»—i sau: - unauthorized_client: client khÃ´ng Ä‘Æ°á»£c á»§y quyá»n Ä‘á»ƒ yÃªu cáº§u authorization code - access_denied: resource owner hoáº·c server á»§y quyá»n tá»« chá»‘i request - unsupported_response_type: server á»§y quyá»n khÃ´ng há»— trwoj viá»‡c láº¥y authorization code sá»­ dá»¥ng phÆ°Æ¡ng thá»©c nÃ y. - invalid_scope: scope trong yÃªu cáº§u cáº¥p quyá»n khÃ´ng há»£p lá»‡. - server_eror: server á»§y quyá»n gáº·p má»™t lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh nÃªn nÃ³ khÃ´ng thá»ƒ thá»±c hiá»‡n viá»‡c cáº¥p á»§y quyá»n Ä‘Æ°á»£c. - temporarily_unavailable: server á»§y quyá»n táº¡m thá»i khÃ´ng thá»ƒ xá»­ lÃ½ yÃªu cáº§u vÃ¬ má»™t lÃ½ do nÃ o Ä‘Ã³. error_description [OPTIONAL] chuá»—i kÃ½ tá»± cung cáº¥p thÃ´ng tin chi tiáº¿t vá» lá»—i mÃ  con ngÆ°á»i cÃ³ thá»ƒ Ä‘á»c Ä‘Æ°á»£c error_uri [OPTIONAL] má»™t URI dáº«n tá»›i má»™t trang web cung cáº¥p thÃ´ng tin vá» lá»—i state [REQUIRED] báº¯t buá»™c pháº£i cÃ³ náº¿u trong request gá»­i lÃªn server cÃ³ kÃ¨m theo tham sá»‘ state.  4.1.4 YÃªu cáº§u cáº¥p Access token Client gá»­i yÃªu cáº§u cáº¥p token tá»›i token endpoint cÃ¹ng vá»›i cÃ¡c tham sá»‘ sau sá»­ dá»¥ng kiá»ƒu Ä‘á»‹nh dáº¡ng( format) application/x-www-form-urlencoded.\n grant_type [REQUIRED] giáº£ trá»‹ pháº£i lÃ  authorization_code. code [REQUIRED] authorization code nháº­n Ä‘Æ°á»£c tá»« server á»§y quyá»n. redirect_uri [REQUIRED] cáº§n pháº£i cÃ³ náº¿u tham sá»‘ redirect_uri Ä‘Æ°á»£c gá»­i Ä‘i lÃºc yÃªu cáº§u á»§y quyá»n trong pháº§n 4.1.1 client_id [REREQUIRED] Ä‘á»‹nh danh cá»§a lient VÃ­ dá»¥:  1 2 3 4 5 6 7  POST /token HTTP/1.1 Host: server.example.com Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW Content-Type: application/x-www-form-urlencoded grant_type=authorization_code\u0026amp;code=SplxlOBeZQQYbYS6WxSbIA \u0026amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb   Server á»§y quyá»n pháº£i:\n YÃªu cáº§u client chá»©ng thá»±c Ä‘á»‘i vá»›i confidential client Äáº£m báº£o ráº±ng authorization code Ä‘Æ°á»£c cáº¥p phÃ¡t cho Ä‘Ãºng client. Náº¿u client lÃ  public thÃ¬ Ä‘áº£m báº£o ráº±ng code Ä‘Æ°á»£c cáº¥p Ä‘Ãºng cho client_id trong request Kiá»ƒm tra authorization code cÃ³ cÃ²n há»£p lá»‡ hay khÃ´ng Äáº£m báº£o tham redirect_uri Ä‘Æ°á»£c gá»­i náº¿u redirect_uri Ä‘Ã£ Ä‘Æ°á»£c gá»­i trong yÃªu cáº§u 4.1.1  4.1.5 Káº¿t quáº£ cáº¥p access token Náº¿u yÃªu cáº§u há»£p lá»‡ vÃ  quÃ¡ trÃ¬nh cáº¥p phÃ¡t thÃ nh cÃ´ng, server á»§y quyá»n sáº½ táº¡o ra má»™t access token vÃ  cÃ³ thá»ƒ kÃ¨m theo refresh token. Náº¿u yÃªu cáº§u tháº¥t báº¡i thÃ¬ server sáº½ tráº£ vá» lá»—i Ä‘Æ°á»£c trÃ¬nh bÃ y trong phÃ n 5.2. VÃ­ dá»¥:\n1 2 3 4 5 6 7 8 9 10 11 12  HTTP/1.1 200 OK Content-Type: application/json;charset=UTF-8 Cache-Control: no-store Pragma: no-cache { \u0026#34;access_token\u0026#34;:\u0026#34;2YotnFZFEjr1zCsicMWpAA\u0026#34;, \u0026#34;token_type\u0026#34;:\u0026#34;example\u0026#34;, \u0026#34;expires_in\u0026#34;:3600, \u0026#34;refresh_token\u0026#34;:\u0026#34;tGzv3JOkF0XG5Qx2TlKWIA\u0026#34;, \u0026#34;example_parameter\u0026#34;:\u0026#34;example_value\u0026#34; }   4.2 Implicit grant Implicit grant Ä‘Æ°á»£c sá»­ Ä‘á»¥ng Ä‘á»ƒ láº¥y access token (khÃ´ng há»— trá»£ refresh token) vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c client cÃ´ng khai. SÆ¡ Ä‘á»“ hoáº¡t Ä‘á»™ng:\n\t+----------+ | Resource | | Owner | | | +----------+ ^ | (B) +----|-----+ Client Identifier +---------------+ | -+----(A)-- \u0026amp; Redirection URI ---\u0026gt;| | | User- | | Authorization | | Agent -|----(B)-- User authenticates --\u0026gt;| Server | | | | | | |\u0026lt;---(C)--- Redirection URI ----\u0026lt;| | | | with Access Token +---------------+ | | in Fragment | | +---------------+ | |----(D)--- Redirection URI ----\u0026gt;| Web-Hosted | | | without Fragment | Client | | | | Resource | | (F) |\u0026lt;---(E)------- Script ---------\u0026lt;| | | | +---------------+ +-|--------+ | | (A) (G) Access Token | | ^ v +---------+ | | | Client | | | +---------+ Note: ÄÆ°á»ng tháº³ng minh há»a cÃ¡c bÆ°á»›c (A) vÃ  (B) Ä‘Æ°á»£c chia thÃ nh 2 pháº§n vÃ¬ chÃºng Ä‘Æ°á»£c chuyá»ƒn thÃ´ng qua user-agent. Figure 4: Implicit Grant Flow  (A) client khá»Ÿi táº¡o luá»“ng chá»©ng thá»±c báº±ng viá»‡c chuyá»ƒn hÆ°á»›ng user-agent cá»§a resource owner tá»›i authentication endpoint. Client gá»­i kÃ¨m theo Ä‘Ã³ lÃ  Ä‘á»‹nh danh client, pháº¡m vi/giá»›i háº¡n yÃªu cáº§u, tráº¡ng thÃ¡i hiá»‡n táº¡i vÃ  URI chuyá»ƒn hÆ°á»›ng sau khi Ä‘Æ°á»£c á»§y quyá»n. (B) Server á»§y quyá»n sáº½ xÃ¡c thá»±c ngÆ°á»i dÃ¹ng, vÃ  há»i ngÆ°á»i dÃ¹ng cÃ³ cháº¥p nháº­n á»§y quyá»n hay tá»« chá»‘i yÃªu cáº§u tá»« client. (C) giáº£ sá»­ resource owner Ä‘Æ°á»£c cáº¥p quyá»n truy cáº­p, server á»§y quyá»n sáº½ chuyá»ƒn hÆ°á»›ng user-agent Ä‘áº¿n redirection URI trong bÆ°á»›c (A) kÃ¨m theo access token trong URI fragment(pháº§n sau dáº¥u # trÃªn URL) (D) user-agent giá»¯ láº¡i thÃ´ng tin vá» access token vÃ  chuyá»ƒn hÆ°á»›ng tá»›i redirection URI cá»§a á»©ng dá»¥ng web. (E) á»©ng dá»¥ng web cá»§a client tráº£ vá» má»™t trag web vá»›i kháº£ láº¥y vÃ  sá»­ dá»¥ng access token trÃªn user-agent. (F) user-agent thá»±c thi cÃ¡c script tá»« á»©ng dá»¥ng web Ä‘á»ƒ láº¥y access token . (G) user-agent chuyá»ƒn access token cho client sá»­ dá»¥ng.  4.2.1 YÃªu cáº§u á»§y quyá»n: Client táº¡o má»™t request vá»›i cÃ¡c tham sá»‘ sau, sá»­ dá»¥ng Ä‘á»‹nh dáº¡ng application/x-www-form-urlencoded.\n response_type [REQUIRED] giÃ¡ trá»‹ pháº£i lÃ  token client_id [REQUIRED] Ä‘á»‹nh Ä‘anh cá»§a client redirect_uri [OPTIONAL] (Ä‘Ã£ nÃ³i á»Ÿ pháº§n trÆ°á»›c). scope [OPTIONAL] (Ä‘Ã£ nÃ³i á»Ÿ pháº§n trÆ°á»›c). state [RECOMMENDED] (giá»‘ng nhÆ° authorization code grant)  VÃ­ dá»¥:\n\tGET /authorize?response_type=token\u0026amp;client_id=s6BhdRkqt3\u0026amp;state=xyz \u0026amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1 Host: server.example.com Server á»§y quyá»n sáº½ kiá»ƒm tra request Ä‘á»ƒ Ä‘áº£m báº£o cÃ¡c tham sá»‘ Ä‘áº§y Ä‘á»§ vÃ  há»£p lá»‡. Náº¿u táº¥t cáº£ thÃ´ng tin Ä‘á»u há»£p lá»‡ thÃ¬ server á»§y quyá»n sáº½ chá»©ng thá»±c resource owner vÃ  há»i viá»‡c cáº¥p quyá»n tá»« resource owner. Sau khi hoÃ n táº¥t, server sáº½ chuyá»ƒn thÃ´ng tin vá» cho client thÃ´ng qua redirection URI\n4.2.2 Access token tráº£ vá» Náº¿u resource owner cháº¥p nháº­n yÃªu cáº§u á»§y quá»n thÃ¬ server sáº½ tráº£ vá» trong redirection URI vá»›i cÃ¡c tham sá»‘ sau:\n access_token [REQUIRED] access token cáº¥p phÃ¡t bá»Ÿi server token_type [REQUIRED] loáº¡i token Ä‘Æ°á»£c cáº¥p phÃ¡t. TrÃ¬nh bÃ y trong pháº§n 7 expired_in [RECOMMENDED] thá»i gian sá»‘ng cá»§a access token tÃ­nh theo giÃ¢y scope [OPTIONAL] tÃ¹y chá»n náº¿u giá»‘ng vá»›i scope trong request, báº¯t buá»™c tráº£ vá» trong trÆ°á»ng há»£p ngÆ°á»£c láº¡i. state báº¯t buá»™c náº¿u trong request cÃ³ gá»­i kÃ¨m tham sá»‘ state  Server khÃ´ng Ä‘Æ°á»£c tráº£ vá» refresh_token\nVÃ­ dá»¥\n\tHTTP/1.1 302 Found Location: http://example.com/cb# access_token=2YotnFZFEjr1zCsicMWpAA \u0026amp;state=xyz\u0026amp;token_type=example\u0026amp;expires_in=3600 4.2.3 Lá»—i tráº£ vá» Náº¿u quÃ¡ trÃ¬nh xin á»§y quyá»n tháº¥t báº¡i thÃ¬ server sáº½ tráº£ vá» cÃ¡c tham sá»‘ sau trong thÃ´ng qua redirect URI\n error [REQUIRED] má»™t chuá»—i kÃ½ tá»± ASCII chá»©a mÃ£ lá»—i trong nhá»¯ng chuá»—i sau: - invalid_request request thiáº¿u tham sá»‘ hoáº·c cÃ¡c tham sá»‘ khÃ´ng há»£p lá»‡. - unauthorized_client client khÃ´ng Ä‘Æ°á»£c á»§y quyá»n Ä‘á»‘i vá»›i phÆ°Æ¡ng phÃ¡p nÃ y. - access_denied rresource Æ¡nowner tá»« chá»‘i á»§y quyá»n cho client. - unsupported_response_typeserver á»§y quyá»n khÃ´ng há»— trá»£ phÆ°Æ¡ng thá»©c á»§y quyá»n nÃ y. - invalid_scope quyá»n háº¡n yÃªu cáº§u khÃ´ng há»£p lá»‡, sai Ä‘á»‹nh Ä‘áº¡ng. - server_error lá»—i server khÃ´ng thá»ƒ tiáº¿p tá»¥c quÃ¡ trÃ¬nh xin cáº¥p á»§y quyá»n. - temporarily_unavailable server táº¡m thá»i khÃ´ng thá»ƒ xá»­ lÃ½ yÃªu cáº§u xin cáº¥p á»§y quyá»n. error_description [OPTIONAL] mÃ´ táº£ chi tiáº¿t cá»§a lá»—i xáº£y ra. error_uri má»™t URI dáº«n tá»›i má»™i trang web chá»©a thÃ´ng tin chi tiáº¿t vá» lá»—i xáº£y ra. state báº¯t buá»™c pháº£i cÃ³ náº¿u trong request cÃ³ gá»­i kÃ¨m tham sá»‘ state.  VÃ­ dá»¥:\n HTTP/1.1 302 Found Location: https://client.example.com/cb# error=access_denied\u0026amp;state=xyz 4.3 Cáº¥p quyá»n sá»­ dá»¥ng thÃ´ng tin Ä‘Äƒng nháº­p cá»§a resource owner. Chá»‰ nÃªn sá»­ dá»¥ng khi client vÃ  resource owner cÃ³ má»‘i quan há»‡ tin tÆ°á»Ÿng láº«n nhau.\nLuá»“ng xá»­ lÃ½:\n +----------+ | Resource | | Owner | | | +----------+ v | Resource Owner (A) Password Credentials | v +---------+ +---------------+ | |\u0026gt;--(B)---- Resource Owner -------\u0026gt;| | | | Password Credentials | Authorization | | Client | | Server | | |\u0026lt;--(C)---- Access Token ---------\u0026lt;| | | | (w/ Optional Refresh Token) | | +---------+ +---------------+ Figure 5: Resource Owner Password Credentials Flow  (A) resource owner cung cáº¥p thÃ´ng tin username, password cho client. (B) Client yÃªu cáº§u server á»§y quyá»n cáº¥p access token cho nÃ³, kÃ¨m theo Ä‘Ã³ lÃ  thÃ´ng tin Ä‘Äƒng nháº­p cá»§a resource owner. Äá»“ng thá»i server á»§y quyá»n cÅ©ng chá»©ng thá»±c client. (C) server á»§y quyá»n kiá»ƒm tra táº¥t cáº£ cÃ¡c thÃ´ng tin, náº¿u há»£p lá»‡ nÃ³ sáº½ táº¡o access token vÃ  tráº£ vá» cho client.  4.3.1 YÃªu cáº§u access token Client sau khi láº¥y Ä‘Æ°á»£c thÃ´ng tin Ä‘Äƒng nháº­p cá»§a resource owner , táº¡o má»™t request kÃ¨m cÃ¡c thÃ´ng sá»‘ sau, sá»­ dá»¥ng format \u0026quot;application/x-www-form-urlencoded\u0026quot;\n grant_type [REQUIRED] giÃ¡ trá»‹ pháº£i lÃ  \u0026quot;password\u0026quot;. user_name [REQUIRED] username cá»§a resource owner. password [REQUIRED] password cá»§a resource owner. scope [OPOPTIONAL] pháº¡m vi quyá»n háº¡n Ä‘Æ°á»£c á»§y quyá»n.  VÃ­ dá»¥:\n1 2 3 4 5 6  POST /token HTTP/1.1 Host: server.example.com Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW Content-Type: application/x-www-form-urlencoded grant_type=password\u0026amp;username=johndoe\u0026amp;password=A3ddj3w   4.3.2 Káº¿t quáº£ access token Náº¿u quÃ¡ trÃ¬nh xin á»§y quyá»n thá»±c hiá»‡n thÃ nh cÃ´ng. Server á»§y quyá»n táº¡o ra access token vÃ  cÃ³ thá»ƒ cáº£ refresh token vÃ  tráº£ vá» cho client\nVÃ­ dá»¥: cáº¥p phÃ¡t thÃ nh cÃ´ng\n1 2 3 4 5 6 7 8 9 10 11 12  HTTP/1.1 200 OK Content-Type: application/json;charset=UTF-8 Cache-Control: no-store Pragma: no-cache { \u0026#34;access_token\u0026#34;:\u0026#34;2YotnFZFEjr1zCsicMWpAA\u0026#34;, \u0026#34;token_type\u0026#34;:\u0026#34;example\u0026#34;, \u0026#34;expires_in\u0026#34;:3600, \u0026#34;refresh_token\u0026#34;:\u0026#34;tGzv3JOkF0XG5Qx2TlKWIA\u0026#34;, \u0026#34;example_parameter\u0026#34;:\u0026#34;example_value\u0026#34; }   4.4 Cáº¥p quyá»n báº±ng thÃ´ng tin chá»©ng thá»±c cá»§a client Client cÃ³ thá»ƒ yÃªu cáº§u cáº¥p access token sá»­ dung thÃ´ng tin chá»©ng thá»±c cá»§a chÃ­nh nÃ³. Kiá»ƒu á»§y quyá»n nÃ y chá»‰ Ä‘Æ°á»£c sá»­ dá»¥ng cho confidential client.\nLuá»“ng xá»­ lÃ½:\n +---------+ +---------------+ | | | | | |\u0026gt;--(A)- Client Authentication ---\u0026gt;| Authorization | | Client | | Server | | |\u0026lt;--(B)---- Access Token ---------\u0026lt;| | | | | | +---------+ +---------------+ Figure 6: Client Credentials Flow  (A) client chá»©n thá»±c nÃ³ vá»›i server á»§y quyá»n vÃ  yÃªu cáº§u cáº¥p access token tá»« token endpoint. (B) server á»§y quyá»n chá»©ng thá»±c client, náº¿u há»£p lá»‡, cáº¥p má»™t access token.  4.4.1 YÃªu cáº§u cáº¥p Access token Client gá»­i táº¡o má»™t request vá»›i cÃ¡c tham sá»‘ sau, sá»­ dá»¥ng format \u0026quot;application/x-www-form-urlencoded\u0026quot;:\n grant_type [REREQUIRED] giÃ¡ trá»‹ báº¯t buá»™c lÃ  client_credentials. scope [OPTIONAL] pháº¡m vi quyá»n háº¡n Ä‘Æ°á»£c á»§y quyá»n.  VÃ­ dá»¥:\n POST /token HTTP/1.1 Host: server.example.com Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW Content-Type: application/x-www-form-urlencoded grant_type=client_credentials 4.4.2 Káº¿t quáº£ access token Náº¿u quÃ¡ trÃ¬nh chá»©ng thá»±c thÃ nh cÃ´ng thÃ¬ server tráº£ vá» cho client access token nhÆ°ng khÃ´ng nÃªn gá»­i refresh token. VÃ­ dá»¥:\n1 2 3 4 5 6 7 8 9 10 11  HTTP/1.1 200 OK Content-Type: application/json;charset=UTF-8 Cache-Control: no-store Pragma: no-cache { \u0026#34;access_token\u0026#34;:\u0026#34;2YotnFZFEjr1zCsicMWpAA\u0026#34;, \u0026#34;token_type\u0026#34;:\u0026#34;example\u0026#34;, \u0026#34;expires_in\u0026#34;:3600, \u0026#34;example_parameter\u0026#34;:\u0026#34;example_value\u0026#34; }   4.5 Má»Ÿ rá»™ng kiá»ƒu cáº¥p á»§y quyá»n Client sá»­ dá»¥ng kiá»ƒu cáº¥p á»§y quyá»n má»Ÿ rá»™ng báº±ng cÃ¡ch thay Ä‘á»•i giÃ¡ trá»‹ cá»§a tham sá»‘ grant_type trong request gá»­i tá»›i token endpoint vÃ  thÃªm cÃ¡c tham sá»‘ khÃ¡c náº¿u cáº§n thiáº¿t.\nPHáº¦N NÃ€Y KHÃ”NG Dá»ŠCH CHI TIáº¾T\n5 Cáº¥p phÃ¡t access token 5.1 Káº¿t quáº£ tráº£ vá» náº¿u thÃ nh cÃ´ng CÃ¡c thÃ´ng tin tráº£ vá» Ä‘Æ°á»£c chá»©a trong body cá»§a gÃ³i tin HTTP tráº£ vá» vá»›i mÃ£ lá»—i 200. CÃ¡c tham sá»‘:\n access_token [REQUIRED] access token Ä‘Æ°á»£c cáº¥p. token_type [REQUIRED] loáº¡i token Ä‘Æ°á»£c cáº¥p phÃ¡t. xem pháº§n 7 expires_in [RECOMMENDED] thá»i gian sá»‘ng cá»§a access token. refresh_token [OPTIONAL] token dÃ¹ng Ä‘á»ƒ xin cáº¥p láº¡i access token khi háº¿t háº¡n. scope [OPTIONAL] náº¿u scope giá»‘ng vá»›i trong request. [REQUIRED] náº¿u khÃ¡c vá»›i trong request.  CÃ¡c tham sá»‘ Ä‘Æ°á»£c chá»©a trong thÃ¢n cá»§a cá»§a HTTP response cÃ³ Ä‘á»‹nh dáº¡ng \u0026quot;application/json\u0026quot; Server á»§y quyá»n pháº£i kÃ¨m theo header \u0026ldquo;Cache-Control\u0026rdquo; trong gÃ³i response vá»›i giÃ¡ trá»‹ lÃ  \u0026ldquo;no-store\u0026rdquo;\nVÃ­ dá»¥:\n1 2 3 4 5 6 7 8 9 10 11 12  HTTP/1.1 200 OK Content-Type: application/json;charset=UTF-8 Cache-Control: no-store Pragma: no-cache { \u0026#34;access_token\u0026#34;:\u0026#34;2YotnFZFEjr1zCsicMWpAA\u0026#34;, \u0026#34;token_type\u0026#34;:\u0026#34;example\u0026#34;, \u0026#34;expires_in\u0026#34;:3600, \u0026#34;refresh_token\u0026#34;:\u0026#34;tGzv3JOkF0XG5Qx2TlKWIA\u0026#34;, \u0026#34;example_parameter\u0026#34;:\u0026#34;example_value\u0026#34; }   Client pháº£i bá» qua cÃ¡c tham sá»‘ khÃ¡c khÃ´ng Ä‘Æ°á»£c xÃ¡ch Ä‘á»‹nh á»Ÿ trÃªn.\n5.2 Lá»—i tráº£ vá» Náº¿u quÃ¡ trÃ¬nh xin á»§y quyá»n tháº¥t báº¡i thÃ¬ server sáº½ tráº£ vá» cÃ¡c tham sá»‘ sau trong thÃ´ng qua redirect URI\n error [REQUIRED] má»™t chuá»—i kÃ½ tá»± ASCII chá»©a mÃ£ lá»—i trong nhá»¯ng chuá»—i sau: - invalid_request request thiáº¿u tham sá»‘ hoáº·c cÃ¡c tham sá»‘ khÃ´ng há»£p lá»‡. - invalid_client viá»‡c chá»©ng thá»±c client tháº¥t báº¡i. - invalid_grant phÆ°Æ¡ng phÃ¡p thá»±c hiá»‡n viá»‡c cáº¥p quá»n hoáº·c refresh token khÃ´ng há»£p lá»‡, háº¿t háº¡n, bá»‹ há»§y bá», redirection URI khÃ´ng Ä‘Ãºng. - unauthorized_client client khÃ´ng Ä‘Æ°á»£c á»§y quyá»n Ä‘á»‘i vá»›i phÆ°Æ¡ng phÃ¡p nÃ y. - unsupported_response_typeserver á»§y quyá»n khÃ´ng há»— trá»£ phÆ°Æ¡ng thá»©c á»§y quyá»n nÃ y. - invalid_scope quyá»n háº¡n yÃªu cáº§u khÃ´ng há»£p lá»‡, sai Ä‘á»‹nh Ä‘áº¡ng. error_description [OPTIONAL] mÃ´ táº£ chi tiáº¿t cá»§a lá»—i xáº£y ra. error_uri má»™t URI dáº«n tá»›i má»™i trang web chá»©a thÃ´ng tin chi tiáº¿t vá» lá»—i xáº£y ra.  CÃ¡c tham sá»‘ nÃ y Ä‘Æ°á»£c chá»©a trong body cá»§a response sá»­ dá»¥ng loáº¡i media \u0026quot;application/json\u0026quot;\nVÃ­ dá»¥:\n1 2 3 4 5 6 7 8  HTTP/1.1 400 Bad Request Content-Type: application/json;charset=UTF-8 Cache-Control: no-store Pragma: no-cache { \u0026#34;error\u0026#34;:\u0026#34;invalid_request\u0026#34; }   6 LÃ m má»›i access token Client gá»­i request tá»›i token endpoint vá»›i cÃ¡c tham sá»‘ sau sá»­ dá»¥ng format \u0026quot;application/x-www-form-urlencoded\u0026quot;:\n grant_type [REQUIRED] giÃ¡ trá»‹ pháº£i lÃ  refresh_token. refresh_token [REQUIRED] chuá»—i refresh token. scope [OPTIONAL] pháº¡m vi quyá»n háº¡n truy cáº­p, cÃ¡c quyá»n á»Ÿ Ä‘Ã¢y pháº£i lÃ  nhá»¯ng quyá»n náº±m trong scope lÃºc yÃªu cáº§u cáº¥p access token. Náº¿u khÃ´ng cÃ³ tham sá»‘ scope thÃ¬ máº·c Ä‘á»‹nh pháº¡m vi quyá»n háº¡n sáº½ giá»‘ng nhÆ° lÃºc yÃªu cáº§u cáº¥p phÃ¡t access token.  VÃ­ dá»¥:\n\tPOST /token HTTP/1.1 Host: server.example.com Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW Content-Type: application/x-www-form-urlencoded grant_type=refresh_token\u0026amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA Server á»§y quyá»n sáº½:\n Chá»©ng thá»±c client. Kiá»ƒm tra refresh token cÃ³ Ä‘Ãºng lÃ  Ä‘Æ°á»£c cáº¥p cho client hay khÃ´ng. Kiá»ƒm tra refresh token cÃ³ há»£p lá»‡ hay khÃ´ng.  Náº¿u táº¥t cáº£ cÃ¡c thÃ´ng tin Ä‘á»u há»£p lá»‡ thÃ¬ server á»§y quyá»n sáº½ cáº¥p token má»›i cho client. Server cÃ³ thá»ƒ táº¡o refresh token má»›i, khi Ä‘Ã³ refresh token cÅ© sáº½ khÃ´ng cÃ²n há»£p lá»‡.\n7. Truy cáº­p vÃ o tÃ i nguyÃªn Ä‘Æ°á»£c báº£o vá»‡ Client truy cáº­p vÃ o tÃ i nguyÃªn Ä‘Æ°á»£c báº£o vá»‡ báº±ng cÃ¡ch cung cáº¥p access token cho resource server. Resource serváº» pháº£i kiá»ƒm tra access token Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng nÃ³ cÃ²n hiá»‡u lá»±c vÃ  náº±m trong pháº¡m vi truy cáº­p.\n7.1 CÃ¡c loáº¡i access token Loáº¡i cá»§a access token Ä‘Æ°á»£c tráº£ vá» cÃ¹ng vá»›i access token khi cáº¥p phÃ¡t thÃ nh cÃ´ng. CÃ³ 2 loáº¡i access token:\n bearer mac á»Ÿ Ä‘Ã¢y khÃ´ng nÃ³i chi tiáº¿t vá» 2 loáº¡i token nÃ y. Tham kháº£o RFC6750 vÃ  OAuth-HTTP-MAC  7.2 Tráº£ lá»—i Náº¿u yÃªu cáº§u truy xuáº¥t tÃ i nguyÃªn tháº¥t báº¡i, resource server nÃªn thÃ´ng bÃ¡o client lá»—i Ä‘Ã£ xáº£y ra\n8. Má»Ÿ rá»™ng giao thá»©c: (khÃ´ng dá»‹ch) 9. á»¨ng dá»¥ng native:(khÃ´ng dá»‹ch) 10. CÃ¡c nguy cÆ¡ báº£o máº­t. 10.1 Chá»©ng thá»±c client 10.2 Máº¡o danh client  Má»™t client nguy hiá»ƒm cÃ³ thá»ƒ máº¡o danh má»™t client khÃ¡c vÃ  láº¥y quyá»n truy cáº­p tá»›i tÃ i nguyÃªn Ä‘Æ°á»£c báº£o vá»‡ náº¿u client bá»‹ máº¡o danh tháº¥t báº¡i hoáº·c khÃ´ng thá»ƒ giá»¯ bÃ­ máº­t cÃ¡c thÃ´ng tinh chá»©ng thá»±c cá»§a nÃ³. Server pháº£i chá»©ng thá»±c client báº¥t cá»© khi nÃ o cÃ³ thá»ƒ. YÃªu cáº§u client Ä‘Äƒng kÃ½ redirection URI Ä‘á»ƒ nháº­n káº¿t quáº£ á»§y quyá»n. Server á»§y quyá»n nÃªn cung cáº¥p cho ngÆ°á»i dÃ¹ng thÃ´ng tin vá» client vÃ  quyá»n háº¡n mÃ  client yÃªu cáº§u. Server á»§y quyá»n khÃ´ng nÃªn tá»± Ä‘á»™ng láº·p láº¡i viá»‡c á»§y quyá»n mÃ  khÃ´ng xÃ¡c thá»±c client hoáº·c dá»±a trÃªn cÃ¡c cÃ¡ch khÃ¡c Ä‘á»ƒ Ä‘áº£m báº£o request Ä‘áº¿n tá»« cÃ¹ng client  10.3 Access token  Access token pháº£i Ä‘Æ°á»£c giá»¯ bÃ­ máº­t trong quÃ¡ trÃ¬nh lÆ°u trá»¯ vÃ  truyá»n táº£i. VÃ  chá»‰ chia sáº» giá»¯a server á»§y quyá»n, resource server vÃ  client sá»Ÿ há»¯u nÃ³. Access token chá»‰ Ä‘Æ°á»£c truyá»n táº£i qua giao thá»©c TLS. Khi sá»­ dá»¥ng kiá»ƒu cáº¥p á»§y quyá»n implicit, access token Ä‘Æ°á»£c gáº¯n vÃ o URI nÃªn dá»… dÃ ng bá»‹ Ä‘Ã¡nh cáº¯p bá»Ÿi cÃ¡c bÃªn/á»©ng dá»¥ng khÃ¡c. Server á»§y quyá»n pháº£i Ä‘áº£m báº£o ráº±ng access token khÃ´ng thá»ƒ Ä‘Æ°á»£c táº¡o ra, thay Ä‘á»•i hoáº·c Ä‘oÃ¡n Ä‘Æ°á»£c bá»Ÿi má»™t bÃªn nÃ o khÃ¡c khÃ´ng Ä‘Æ°á»£c chá»©ng thá»±c. Client nÃªn yÃªu cáº§u cáº¥p access token vá»›i pháº¡m vi truy cáº­p tá»‘i thiá»ƒu cáº§n thiáº¿t cho nÃ³.  10.4 Refresh token  Server á»§y quyá»n cÃ³ thá»ƒ cáº¥p refresh token cho á»©ng dá»¥ng web hoáº·c á»©ng dá»¥ng native. Refresh token pháº£i Ä‘Æ°á»£c giá»¯ bÃ­ máº­t trong lÆ°u trá»¯ vÃ  truyá»n táº£i. VÃ  chá»‰ Ä‘Æ°á»£c chia sáº» giá»¯a server á»§y quyá»n vÃ  client Ä‘Æ°á»£c cáº¥p phÃ¡t. refresh token pháº£i Ä‘Æ°á»£c truyá»n táº£i qua giao thá»©c TLS. Server á»§y quyá»n pháº£i kiá»ƒm tra liá»‡u refresh token cÃ³ pháº£i Ä‘Æ°á»£c cáº¥p phÃ¡t cho client hay khÃ´ng. Trong trÆ°á»ng há»£p khÃ´ng thá»ƒ chá»©ng thá»±c client, server nÃªn sá»­ dá»¥ng cÃ¡c cÃ¡ch khÃ¡c Ä‘á»ƒ phÃ¡t hiá»‡n viá»‡c láº¡m dá»¥ng refresh token. Server á»§y quyá»n pháº£i Ä‘áº£m báº£o ráº±ng refresh token khÃ´ng thá»ƒ Ä‘Æ°á»£c táº¡o ra, thay Ä‘á»•i hoáº·c Ä‘oÃ¡n Ä‘Æ°á»£c bá»Ÿi má»™t bÃªn nÃ o khÃ¡c khÃ´ng Ä‘Æ°á»£c chá»©ng thá»±c.  10.5 Authorization code   Viá»‡c truyá»n táº£i authorization code nÃªn Ä‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua má»™t kÃªnh báº£o máº­t. Client nÃªn sá»­ dá»¥ng giao thá»©c TLS cho redirection URI. Authorization code Ä‘Æ°á»£c truyá»n thÃ´ng qua user-agent nÃªn nÃ³ cÃ³ thá»ƒ bá»‹ báº¯t láº¡i á»Ÿ user agent.\n  Authorization code pháº£i cÃ³ thá»i gian sá»‘ng ngáº¯n vÃ  chá»‰ Ä‘Æ°á»£c dÃ¹ng má»™t láº§n. Náº¿u server á»§y quyá»n nháº­n tháº¥y authorization code Ä‘Æ°á»£c sá»­ dá»¥ng láº¡i nhiá»u láº§n, server nÃªn há»§y táº¥t cáº£ cÃ¡c access token Ä‘Ã£ cáº¥p phÃ¡t dá»±a trÃªn authorization code nÃ y.\n  Náº¿u cÃ³ thá»ƒ, server á»§y quyá»n nÃªn chá»©ng thá»±c clien vÃ  kiá»ƒm tra authorization code cÃ³ Ä‘Æ°á»£c cáº¥p phÃ¡t cho Ä‘Ãºng client hay khÃ´ng.\n  10.7 Authorization Code Redirection URI Manipulation  Khi sá»­ dá»¥ng phÆ°Æ¡ng thá»©c cáº¥p quyá»n authorization code, client xÃ¡c Ä‘á»‹nh URI chuyá»ƒn hÆ°á»›ng bÄƒng tham sá»‘ redirect_uri. Náº¿u káº» táº¥n cÃ´ng cÃ³ thá»ƒ thay Ä‘á»•i giÃ¡ trá»‹ cá»§a redirect_uri nÃ³ cÃ³ thá»ƒ lÃ m cho server chuyá»ƒn hÆ°á»›ng káº¿t quáº£ tá»›i URI cá»§a káº» táº¥n cÃ´ng. Káº» táº¥n cÃ´n cÃ³ thá»ƒ táº¡o tÃ i khoáº£n trÃªn má»™t server há»£p lá»‡ vÃ  khá»Ÿi táº¡o luá»“ng cáº¥p á»§y quyá»n. Khi user-agent cá»§a káº» táº¥n cÃ´ng Ä‘ang request tá»›i server á»§y quyá»n Ä‘á»ƒ yÃªu cáº§u cáº¥p quyá»n truy cáº­p, háº¯n thay tháº¿ URI cá»§a client há»£p phÃ¡p vÃ  thay báº±ng URI cá»§a háº¯n. Sau Ä‘Ã³ káº» táº¥n cÃ´ng lá»«a cho náº¡n nhÃ¢n sá»­ dá»¥ng link Ä‘Ã£ Ä‘Æ°á»£c thay Ä‘á»•i Ä‘á»ƒ cáº¥p quyá»n truy cáº­p cho client há»£p lá»‡.  Má»™t khi server á»§y quyá»n hoÃ n thÃ nh viá»‡c cáº¥p á»§y quyá»n, náº¡n nhÃ¢n sau Ä‘Ã³ sáº½ Ä‘Æ°á»£c chuyá»ƒn hÆ°á»›ng tá»›i má»™t trang khÃ¡c cá»§a káº» táº¥n cÃ´ng cÃ¹ng vá»›i authorization code. Sau Ä‘Ã³ attacker gá»­i authorization code tá»›i client. client sá»­ dá»¥ng thÃ´ng tin Ä‘Ã³ Ä‘á»ƒ cáº¥p quyá»n truy cáº­p cho account cá»§a káº» táº¥n cÃ´ng, vÃ  háº¯n cÃ³ thá»ƒ sá»­ dá»¥ng tÃ i khoáº£n cá»§a mÃ¬nh Ä‘á»ƒ truy cáº­p vÃ o tÃ i nguyÃªn Ä‘Æ°á»£c báº£o vá»‡ cá»§a nan nhÃ¢n thÃ´ng qua client.\nÄá»ƒ ngÄƒn cháº·n kiá»ƒu táº¥n cÃ´ng nhÆ° váº­y: - Server á»§y quyá»n pháº£i Ä‘áº£m báº£o ráº±ng redirection URI Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ láº¥y code á»§y quyá»n pháº£i giá»‘ng vá»›i redirection URI khi Ä‘á»•i authorization code láº¥y access token. - Server á»§y quyá»n yÃªu cáº§u public client pháº£i Ä‘Äƒng kÃ½ redirection URI vÃ  confidential client cÅ©ng nÃªn Ä‘Äƒng kÃ½ redirection URI. server sáº½ kiá»ƒm tra URI trong request cÃ³ Ä‘Ãºng vá»›i URI Ä‘Ã£ Ä‘Äƒng kÃ½ hay khÃ´ng.\n10.7 Resource Owner Password Credentials  Kiá»ƒu cáº¥p quyá»n nÃ y cÃ³ nhiá»u nguy cÆ¡ bá»‹ táº¥n cÃ´ng hÆ¡n so vá»›i nhá»¯ng kiá»ƒu khÃ¡c bá»Ÿi vÃ¬ nÃ³ sá»­ dá»¥ng username vÃ  password lÃ  Ä‘iá»u mÃ  giao thá»©c oauth2 muá»‘n trÃ¡nh khá»i.Client cÃ³ thá»ƒ láº¡m dá»¥ng hoáº·c Ä‘á»ƒ lá»™ máº­u kháº©u. ThÃªm vÃ o Ä‘Ã³, resource owner khÃ´ng Ä‘Æ°á»£c tham gia vÃ o quÃ¡ trÃ¬nh cáº¥p quyá»n nÃªn client cÃ³ thá»ƒ yÃªu cáº§u cáº¥p pháº¡m vi quyá»n háº¡n lá»›n hÆ¡n. Server á»§y quyá»n nÃªn xem xÃ©t thá»i gian sá»‘ng vÃ  vÃ  pháº¡m vi(scope) cá»§a access token trong kiá»ƒu cáº¥p quyá»n nÃ y. Server á»§y quyá»n vÃ  client nÃªn háº¡n cháº¿ sá»­ dá»¥ng kiá»ƒu cáº¥p quyá»n nÃ y vÃ  sá»­ dá»¥ng kiá»ƒu á»§y quyá»n khÃ¡c báº¥t cá»© khi nÃ o cÃ³ thá»ƒ.  10.8 Request Confidentiality  access token, refresh token , resource owner password, vÃ  client credential KHÃ”NG ÄÆ¯á»¢C truyá»n táº¡i dÆ°á»›i dáº¡ng text rÃµ rÃ ng (khÃ´ng Ä‘Æ°á»£c hash hay mÃ£ hÃ³a). Authorization code KHÃ”NG NÃŠN truyá»n dÆ°á»›i dáº¡ng text rÃµ rÃ ng. state vÃ  scope khÃ´ng nÃªn chá»©a cÃ¡c thÃ´ng tin nháº¡y cáº£m á»§a client hoáº·c resource owner dÆ°á»›i dáº¡ng text rÃµ rÃ ng bá»Ÿi vÃ¬ chÃºng cÃ³ thá»ƒ Ä‘Æ°á»£c truyá»n táº£i qua má»™t kÃªnh khÃ´ng an toÃ n.  10.9 Ensuring Endpoint Authenticity Äá»ƒ ngÄƒn cháº·n kiá»ƒu táº¥n cÃ´ng man-in-the-middle, server á»§y quyá»n pháº£i yÃªu cáº§u sá»­ dá»¥ng kÃªnh truyá»n TLS.\n10.10 Credentials-Guessing Attacks  Server á»§y quyá»n pháº£i ngÄƒn cháº·n káº» táº¥n cÃ´ng Ä‘oÃ¡n access token, máº­t kháº©u cá»§a resource owner vÃ  thÃ´ng tin Ä‘Äƒng nháº­p cá»§a client. Kháº£ nÄƒng káº» táº¥n cÃ´ng Ä‘oÃ¡n ra access token PHáº¢I nhá» hÆ¡n hoáº·c báº±ng 2^(-128) vÃ  NÃŠN nhá» hÆ¡n hoáº·c báº±ng 2^(-160)  10.11 Phishing Attacks 10.12 Cross-Site Request Forgery   LÃ  kiá»ƒu táº¥n cÃ´ng trong Ä‘Ã³ káº» táº¥n cÃ´ng lÃ m cho user-agent cá»§a ngÆ°á»i dÃ¹ng chuyá»ƒn hÆ°á»›ng theo má»™t URI nguy hiá»ƒ tá»›i server Ä‘ang Ä‘Æ°á»£c tin tÆ°á»Ÿng (thÃ´ng thÆ°á»ng Ä‘Æ°á»£c thiáº¿t láº­p qua má»™t session cookie há»£p lá»‡).\n  Táº¥n cÃ´ng CSRF dá»±a trÃªn redirection URI cho phÃ©p káº» táº¥n cÃ´ng thay tháº¿ báº±ng authorization code hoáº·c access token cá»§a háº¯n. Káº¿t quáº£ lÃ  client sáº½ sá»­ dá»¥ng access token liÃªn káº¿t vá»›i protected resource cá»§a káº» táº¥n cÃ´ng thay vÃ¬ cá»§a náº¡n nhÃ¢n (VÃ­ dá»¥ nhÆ° lÆ°u thÃ´ng tin tÃ­n dá»¥ng cá»§a náº¡n nhÃ¢n vÃ o tÃ i khoáº£n cá»§a káº» táº¥n cÃ´ng).\n  Client pháº£i há»— trá»£ ngÄƒn cháº·n CSRF Ä‘á»‘i vá»›i redirection URI cá»§a nÃ³. Viá»‡c nÃ y cÃ³ thá»ƒ thá»±c hiá»‡n báº±ng viá»‡c yÃªu cáº§u má»i request gá»­i tá»›i redirection URI endpoint pháº£i kÃ¨m theo má»™t giÃ¡ trá»‹ gáº¯n request vá»›i tráº¡ng thÃ¡i chá»©ng thá»±c cá»§a user-agent . Client nÃªn táº¡o tham sá»‘ state trong request gá»­i tá»›i server á»§y quyá»n.\n  SÃ¢u khi cáº¥p quyá»n, server tráº£ vá» cho client káº¿t quáº£ kÃ¨m theo state cá»§a request. ThÃ´ng tin nÃ y cho phÃ©p client kiá»ƒm tra tÃ­nh há»£p lá»‡ cá»§a request.\n  Táº¥n cÃ´ng CSRF trÃªn authorization endpoint cá»§a server á»§y quyá»n cÃ³ thá»ƒ dáº«n tá»›i káº¿t quáº£ lÃ  káº» táº¥n cÃ´ng láº¥y Ä‘Æ°á»£c á»§y quyá»n cá»§a user cho má»™t client nguy hiá»ƒm mÃ  user khÃ´ng há» biáº¿t.\n  Server á»§y quyá»n pháº£i há»— trá»£ viá»‡c ngÄƒn cháº·n CSRF Ä‘á»‘i vá»›i authorization enpoint cá»§a nÃ³ vÃ  Ä‘áº£m báº£o ráº±ng client nguy hiá»ƒm khÃ´ng thá»ƒ nháº­n Ä‘Æ°á»£c á»§y quyá»n mÃ  khÃ´ng cÃ³ sá»± cháº¥p thuáº­n cá»§a resource owner.\n  10.13 Clickjacking  Äá»‘i vá»›i táº¥n cÃ´ng Clickjacking, káº» táº¥n cÃ´ng Ä‘Äƒng kÃ½ má»™t client há»£p lá»‡ vÃ  táº¡o má»™t website nguy hiá»ƒm Ä‘á»ƒ táº£ authorizatin endpoint cá»§a server á»§y quyá»n trong má»™t iframe trong suÃ´t, vÃ  táº¡o cÃ¡c button táº¡i vá»‹ trÃ­ cÃ¡c button trÃªn trang cá»§a server á»§y quyá»n. Khi ngÆ°á»i dÃ¹ng click lÃªn cÃ¡c button do káº» táº¥n cÃ´ng táº¡o ra, há» Ä‘Ã£ vÃ´ tÃ¬nh click lÃªn cac button vÃ´ hÃ¬nh trÃªn trang cáº¥p quyá»n(vÃ­ dá»¥ nhÆ° nÃºt Authorize). Äiá»u nÃ y giÃºp káº» táº¥n cÃ´ng Ä‘Ã¡nh lá»«a ngÆ°á»i dÃ¹ng cáº¥p quyá»n truy cáº­p cho háº¯n mÃ  ngÆ°á»i dÃ¹ng khÃ´ng há» hay biáº¿t. Äá»ƒ ngÄƒn cháº·n kiá»ƒu táº¥n cÃ´ng nÃ y, cÃ¡c á»©ng dá»¥ng native nÃªn sá»­ dá»¥ng cÃ¡c trÃ¬nh duyá»‡n bÃªn ngoÃ i thay vÃ¬ nhÃºng trÃ¬nh duyá»‡t bÃªn trong á»©ng dá»¥ng, viá»‡c cháº·n cÃ¡c iframe cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng viá»‡c server á»§y quyá»n sá»­ dá»¥ng \u0026quot;x-frame-options\u0026quot; header. Header nÃ y cÃ³ nháº­n 1 trong hai giÃ¡ trá»‹ deny hoáº·c \u0026lsquo;sameorigin\u0026rsquo;. Thiáº¿t láº­p nÃ y ngÄƒn viá»‡c sá»­ dá»¥ng iframe hoáº·c cháº·n iframe tá»« cÃ¡c trang khÃ´ng cÃ¹ng domain.  10.14 Code Injection and Input Validation  Táº¥n cÃ´ng code injection xáº£y ra khi cÃ¡c biáº¿n bÃªn ngoÃ i hoáº·c input nháº­n vÃ o vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng mÃ  khÃ´ng Ä‘Æ°á»£c khá»­ Ä‘á»™c (:) sanitize) vÃ  do Ä‘Ã³ lÃ m thay Ä‘á»•i logic cá»§a á»©ng dá»¥ng. Viá»‡c nÃ y cho phÃ©p káº» táº¥n cÃ´ng láº¥y Ä‘Æ°á»£c quyá»n truy cáº­p vÃ o device mÃ  á»©ng dá»¥ng Ä‘ang cháº¡y hoáº·c dá»¯ liá»‡u á»©ng dá»¥ng, gÃ¢y tá»« chá»‘i dá»‹ch vá»¥ hoáº·c lÃ  nhiá»u tÃ¡c Ä‘á»™ng nguy hiá»ƒm khÃ¡c. Server á»§y quyá»n vÃ  client nÃªn sanitize(khá»­ Ä‘á»™c, khá»­ trÃ¹ng, khá»­) cÃ¡c giÃ¡ trá»‹ nháº­n Ä‘Æ°á»£c, Ä‘áº·c biá»‡t lÃ  tham sá»‘ state vÃ  redirect_uri.  10.15 Open Redirectors  Server á»§y quyá»n, authorization endpoint vÃ  client redirection endpoint cÃ³ thá»ƒ Ä‘Æ°á»£c cáº¥u hÃ¬nh khÃ´ng Ä‘Ãºng táº¡o nÃªn open redirector. Open redirection lÃ  má»™t endpoint sá»­ dá»¥ng cÃ¡c tham sá»‘ vÃ  chuyá»ƒn hÆ°á»›ng tá»± Ä‘á»™ng tá»›i cÃ¡c vá»‹ trÃ­ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trong cÃ¡c tham sá»‘ mÃ  khÃ´ng kiá»ƒm tra trÆ°á»›c. Open redirection cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong táº¥n cÃ´ng phishing, hoáº·c bá»Ÿi káº» táº¥n cÃ´ng Ä‘á»ƒ khiáº¿n ngÆ°á»i dÃ¹ng truy cáº­p vÃ o cÃ¡c trang web nguy hiá»ƒm báº±ng cÃ¡ch sá»­ dá»¥ng redirection URI. NgoÃ i ra náº¿u server á»§y quyá»n cho phÃ©p client Ä‘Äƒng kÃ½ 1 pháº§n cá»§a redirection URI, káº» táº¥n cÃ´ng cÃ³ thá»ƒ sá»­ dá»¥ng open redirector Ä‘á»ƒ táº¡o ra cÃ¡c URI qua máº·t Ä‘Æ°á»£c viá»‡c kiá»ƒm tra cá»§a server á»§y quyá»n vÃ  server sáº½ gá»­i authorization code hoáº·c access token tá»›i redirection URI do káº» táº¥n cÃ´ng quáº£n lÃ½.  10.16 isuse of Access Token to Impersonate Resource Owner in Implicit Flow  Äá»‘i vá»›i implicit thÃ¬ khÃ´ng thá»ƒ biáº¿t Ä‘Æ°á»£c access token Ä‘ang Ä‘Æ°á»£c cáº¥p phÃ¡t cho client nÃ o. resource owner cÃ³ thá»ƒ cáº¥p quyá»n cho client cá»§a káº» táº¥n cÃ´ng. Káº» táº¥n cÃ´ng cÅ©ng cÃ³ thá»ƒ láº¥y trá»™m token thÃ´ng qua má»™t sá»‘ cÆ¡ cháº¿ khÃ¡c. Sau Ä‘Ã³ káº» táº¥n cÃ´ng cÃ³ thá»ƒ giáº£ máº¡o resource owner báº±ng cÃ¡ch cung cáº¥p access token cho client há»£p lá»‡. Káº» táº¥n cÃ´ng cÅ©ng cÃ³ thá»ƒ thay tháº¿ access token mÃ  server á»§y quyá»n tráº£ vá» báº±ng access token Ä‘Æ°á»£c cáº¥p cho háº¯n trÆ°á»›c Ä‘Ã³.  \u0026mdash;- CÃC PHáº¦N CÃ’N Láº I KHÃ”NG Dá»ŠCH\u0026mdash;-\n","date":"21","image":null,"permalink":"http://bluzky.github.io/blog/2018-01-21-tim-hieu-oauth/","tags":["others","protocol","oauth2"],"title":"TÃ¬m hiá»ƒu vá» Oauth / Oauth hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o?"},{"categories":null,"contents":"1. What is Rabbit MQ?  Rabbit MQ is an server application, it is a message broker which implement AMQP (Advanced Message Queue Protocol). It works like a post service, which take the message from sender and dispatch that message to the receiver.\n Some terminologies:\n Producer: send message to queue Queue: hold all message added by producer and dispatch those message to a consumer Consumer: receive message from  2. What is Rabbit MQ used for? RabbitMQ is a message broker server that receive and dispatch/distribute messages to back end services that handle/process heavy tasks. It helps to build a big system can handle large amount of request\n3. Features list Reliability\nRabbitMQ offers a variety of features to let you trade off performance with reliability, including persistence, delivery acknowledgements, publisher confirms, and high availability.\nFlexible Routing\nMessages are routed through exchanges before arriving at queues. RabbitMQ features several built-in exchange types for typical routing logic. For more complex routing you can bind exchanges together or even write your own exchange type as a plugin.\nClustering\nSeveral RabbitMQ servers on a local network can be clustered together, forming a single logical broker.\nFederation\nFor servers that need to be more loosely and unreliably connected than clustering allows, RabbitMQ offers a federation model.\nHighly Available Queues\nQueues can be mirrored across several machines in a cluster, ensuring that even in the event of hardware failure your messages are safe.\nMulti-protocol\nRabbitMQ supports messaging over a variety of messaging protocols.\nMany Clients\nThere are RabbitMQ clients for almost any language you can think of.\nManagement UI\nRabbitMQ ships with an easy-to use management UI that allows you to monitor and control every aspect of your message broker.\nTracing\nIf your messaging system is misbehaving, RabbitMQ offers tracing support to let you find out what\u0026rsquo;s going on.\n3.Bis. Implement models 1. Supported Model   Default exchange\nMessage from Producer will be pushed directly to message queue and Consumber will receive message on the same queue. Producer and Consumer must know the name of the queue\n  Fanout exchange\nEvery message is pushed to Fanout exchange,it will be pushed to all all queues which subscribe this Exchange\n  Direct exachange\nIf a Consumer only want to filter received message, it will bind to one or many routing_key. When Exchange have new message, it will append that message to all queue which subscribe same routing_key with message. If message\u0026rsquo;s routing key does not match any subscriber, it will be discarded\n  Topic exchange\nThis type of exchange allow more complicated filter, it use pattern to filter topic. Topic string format contains many words and separate by dot [.] # to replace 0 or many words * to replace exactly one word Example:\npublish topic: kern.logs.error, security.log.warning pattern: *.*.error, kern.#\n  Headers exchange\n  2. Direct message:  Producer send message directy to message queue To send message direct to queue, set exchange name to empty string Many consumer can subcribe same queue. Message will be dispatched using FIFO rule\n Producer\n1 2 3  channel.basic_publish(exchange=\u0026#39;\u0026#39;, routing_key=\u0026#39;routing_name\u0026#39;, body=\u0026#39;message_content\u0026#39;)   Consumer\n1 2 3  channel.basic_consume(callback, # callback function to handle message queue=\u0026#39;queue_name\u0026#39; no_ack=True)   mermaid.initialize({ theme: 'forest' })  graph LR; A((Producer))--Q[queue]; Q -- C((Consumer 1)); Q -- C2((Consumer 2)); Q -- C3(( ......));  3. Publish message via Exchange(publish/subcribe) Exchange: acts like an agent, it receives messages from Producer and pushes them to appropriate queue. The idea of exchange is to separate Producer from queues. Producers do not need to know about queues, it simply sends message to exchange, and Exchanges will know how/ which queue to append message to or discard them.\n Routing key comes with publish and subscribe. Instead of knowing name of queue, producer now only need know routing key, it sends messages to Exchange with routing key. Each time Exchange receives a message, it will check message\u0026rsquo;s routing key and push that message to all Consumer which subscribe that routing key.\n mermaid.initialize({ theme: 'forest' })  graph LR; P1((P1))--E(Exchange); P2((P2))--E; E--|Black|Q1[Queue1]; E--|Green|Q2[Queue2]; E--|Blue|Q2[Queue2]; Q1--C1((C1)); Q2--C2((C2));  Producer\n1 2 3 4 5 6 7 8 9  # firs we need to declare an exchange # four types of exchange: fanout, headers, topic, direct channel.exchange_declare(exchange=\u0026#39;exchange_name\u0026#39;, type=\u0026#39;exchange_type\u0026#39;) .... channel.basic_publish(exchange=\u0026#39;exchange_name\u0026#39;, routing_key=\u0026#39;channel_name\u0026#39;, body=\u0026#39;message_content\u0026#39;) ....   Consumer\n1 2 3 4 5 6 7 8 9 10  channel.exchange_declare(exchange=\u0026#39;exchange_name\u0026#39;, type=\u0026#39;exchange_type\u0026#39;) .... # need to bind queue to a specific exchange channel.queue_bind(exchange=\u0026#39;exchange_name\u0026#39;, queue=\u0026#39;queue_name\u0026#39;) .... channel.basic_consume(callback, queue=\u0026#39;queue_name\u0026#39;, no_ack=True)    RPC\n Client send request to Server, Method is defined at server and Client should know exactly which function server has. Client push request to a queue and server subscribe this queue Server push result to another queue and clien subscribe this queue\n mermaid.initialize({ theme: 'forest' })  graph LR C((Client))--Q1[request queue] Q1-- S((Server)) Q2[result queue] --C S-- Q2 style C fill:orange style S fill:pink    ##4. Use case\n Sound cloud  ##5. References\n Install instruction Tutorial page ==AMQP concept== ##6. Conclusion  ","date":"21","image":null,"permalink":"http://bluzky.github.io/blog/2018-01-21-what-is-rabbit-mq/","tags":["others","tech"],"title":"What is Rabbit MQ?"}]